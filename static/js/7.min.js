// hashchange
(function($,e,b){var c="hashchange",h=document,f,g=$.event.special,i=h.documentMode,d="on"+c in e&&(i===b||i>7);function a(j){j=j||location.href;return"#"+j.replace(/^[^#]*#?(.*)$/,"$1")}$.fn[c]=function(j){return j?this.bind(c,j):this.trigger(c)};$.fn[c].delay=50;g[c]=$.extend(g[c],{setup:function(){if(d){return false}$(f.start)},teardown:function(){if(d){return false}$(f.stop)}});f=(function(){var j={},p,m=a(),k=function(q){return q},l=k,o=k;j.start=function(){p||n()};j.stop=function(){p&&clearTimeout(p);p=b};function n(){var r=a(),q=o(m);if(r!==m){l(m=r,q);$(e).trigger(c)}else{if(q!==m){location.href=location.href.replace(/#.*/,"")+q}}p=setTimeout(n,$.fn[c].delay)}$.browser.msie&&!d&&(function(){var q,r;j.start=function(){if(!q){r=$.fn[c].src;r=r&&r+a();q=$('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){r||l(a());n()}).attr("src",r||"javascript:0").insertAfter("body")[0].contentWindow;h.onpropertychange=function(){try{if(event.propertyName==="title"){q.document.title=h.title}}catch(s){}}}};j.stop=k;o=function(){return a(q.location.href)};l=function(v,s){var u=q.document,t=$.fn[c].domain;if(v!==s){u.title=h.title;u.open();t&&u.write('<script>document.domain="'+t+'"<\/script>');u.close();q.location.hash=v}}})();return j})()})(jQuery,this);

// highcharts
(function(){function ma(a,b){a||(a={});for(var c in b)a[c]=b[c];return a}function oa(a,b){return parseInt(a,b||10)}function Ib(a){return typeof a=="string"}function Jb(a){return typeof a=="object"}function bc(a){return typeof a=="number"}function mc(a,b){for(var c=a.length;c--;)if(a[c]==b){a.splice(c,1);break}}function L(a){return a!==Qa&&a!==null}function wa(a,b,c){var d,e;if(Ib(b))if(L(c))a.setAttribute(b,c);else{if(a&&a.getAttribute)e=a.getAttribute(b)}else if(L(b)&&Jb(b))for(d in b)a.setAttribute(d, b[d]);return e}function nc(a){if(!a||a.constructor!=Array)a=[a];return a}function y(){var a=arguments,b,c,d=a.length;for(b=0;b<d;b++){c=a[b];if(typeof c!=="undefined"&&c!==null)return c}}function Vd(a){var b="",c;for(c in a)b+=Ad(c)+":"+a[c]+";";return b}function La(a,b){if(Ac)if(b&&b.opacity!==Qa)b.filter="alpha(opacity="+b.opacity*100+")";ma(a.style,b)}function eb(a,b,c,d,e){a=ya.createElement(a);b&&ma(a,b);e&&La(a,{padding:0,border:mb,margin:0});c&&La(a,c);d&&d.appendChild(a);return a}function Kb(a, b){Bc=y(a,b.animation)}function Bd(){var a=Ra.global.useUTC;Cc=a?Date.UTC:function(b,c,d,e,f,g){return(new Date(b,c,y(d,1),y(e,0),y(f,0),y(g,0))).getTime()};$c=a?"getUTCMinutes":"getMinutes";ad=a?"getUTCHours":"getHours";bd=a?"getUTCDay":"getDay";oc=a?"getUTCDate":"getDate";Dc=a?"getUTCMonth":"getMonth";Ec=a?"getUTCFullYear":"getFullYear";Cd=a?"setUTCMinutes":"setMinutes";Dd=a?"setUTCHours":"setHours";cd=a?"setUTCDate":"setDate";Ed=a?"setUTCMonth":"setMonth";Fd=a?"setUTCFullYear":"setFullYear"}function Fc(a){Gc|| (Gc=eb(Lb));a&&Gc.appendChild(a);Gc.innerHTML=""}function wb(a,b){var c=function(){};c.prototype=new a;ma(c.prototype,b);return c}function Gd(a,b,c,d){var e=Ra.lang,f=isNaN(b=ab(b))?2:b;b=c===undefined?e.decimalPoint:c;d=d===undefined?e.thousandsSep:d;e=a<0?"-":"";c=oa(a=ab(+a||0).toFixed(f))+"";var g=(g=c.length)>3?g%3:0;return e+(g?c.substr(0,g)+d:"")+c.substr(g).replace(/(\d{3})(?=\d)/g,"$1"+d)+(f?b+ab(a-c).toFixed(f).slice(2):"")}function Hc(){}function Hd(a,b){function c(m,h){function x(l,p){this.pos= l;this.minor=p;this.isNew=true;p||this.addLabel()}function w(l){if(l){this.options=l;this.id=l.id}return this}function P(){var l=[],p=[],r;Sa=v=null;Y=[];u(za,function(o){r=false;u(["xAxis","yAxis"],function(ja){if(o.isCartesian&&(ja=="xAxis"&&ka||ja=="yAxis"&&!ka)&&(o.options[ja]==h.index||o.options[ja]===Qa&&h.index===0)){o[ja]=s;Y.push(o);r=true}});if(!o.visible&&t.ignoreHiddenSeries)r=false;if(r){var U,X,H,C,fa;if(!ka){U=o.options.stacking;Ic=U=="percent";if(U){C=o.type+y(o.options.stack,""); fa="-"+C;o.stackKey=C;X=l[C]||[];l[C]=X;H=p[fa]||[];p[fa]=H}if(Ic){Sa=0;v=99}}if(o.isCartesian){u(o.data,function(ja){var D=ja.x,la=ja.y,R=la<0,Z=R?H:X;R=R?fa:C;if(Sa===null)Sa=v=ja[I];if(ka)if(D>v)v=D;else{if(D<Sa)Sa=D}else if(L(la)){if(U)Z[D]=L(Z[D])?Z[D]+la:la;la=Z?Z[D]:la;ja=y(ja.low,la);if(!Ic)if(la>v)v=la;else if(ja<Sa)Sa=ja;if(U){ca[R]||(ca[R]={});ca[R][D]={total:la,cum:la}}}});if(/(area|column|bar)/.test(o.type)&&!ka)if(Sa>=0){Sa=0;Id=true}else if(v<0){v=0;Jd=true}}}})}function ga(l,p){var r; Db=p?1:Ta.pow(10,Mb(Ta.log(l)/Ta.LN10));r=l/Db;if(!p){p=[1,2,2.5,5,10];if(h.allowDecimals===false)if(Db==1)p=[1,2,5,10];else if(Db<=0.1)p=[1/Db]}for(var o=0;o<p.length;o++){l=p[o];if(r<=(p[o]+(p[o+1]||p[o]))/2)break}l*=Db;return l}function M(l){var p;p=l;if(L(Db)){p=(Db<1?V(1/Db):1)*10;p=V(l*p)/p}return p}function da(){var l,p,r,o,U=h.tickInterval,X=h.tickPixelInterval;l=h.maxZoom||(ka?nb(m.smallestInterval*5,v-Sa):null);B=N?Ba:qa;if(Nb){r=m[ka?"xAxis":"yAxis"][h.linkedTo];o=r.getExtremes();J=y(o.min, o.dataMin);Q=y(o.max,o.dataMax)}else{J=y(na,h.min,Sa);Q=y(Ma,h.max,v)}if(Q-J<l){o=(l-Q+J)/2;J=Ga(J-o,y(h.min,J-o),Sa);Q=nb(J+l,y(h.max,J+l),v)}if(!bb&&!Ic&&!Nb&&L(J)&&L(Q)){l=Q-J||1;if(!L(h.min)&&!L(na)&&Wb&&(Sa<0||!Id))J-=l*Wb;if(!L(h.max)&&!L(Ma)&&Kd&&(v>0||!Jd))Q+=l*Kd}Ua=J==Q?1:Nb&&!U&&X==r.options.tickPixelInterval?r.tickInterval:y(U,bb?1:(Q-J)*X/B);if(!O&&!L(h.tickInterval))Ua=ga(Ua);s.tickInterval=Ua;Jc=h.minorTickInterval==="auto"&&Ua?Ua/5:h.minorTickInterval;if(O){pa=[];U=Ra.global.useUTC; var H=1E3/ob,C=6E4/ob,fa=36E5/ob;X=864E5/ob;l=6048E5/ob;o=2592E6/ob;var ja=31556952E3/ob,D=[["second",H,[1,2,5,10,15,30]],["minute",C,[1,2,5,10,15,30]],["hour",fa,[1,2,3,4,6,8,12]],["day",X,[1,2]],["week",l,[1,2]],["month",o,[1,2,3,4,6]],["year",ja,null]],la=D[6],R=la[1],Z=la[2];for(r=0;r<D.length;r++){la=D[r];R=la[1];Z=la[2];if(D[r+1])if(Ua<=(R*Z[Z.length-1]+D[r+1][1])/2)break}if(R==ja&&Ua<5*R)Z=[1,2,5];D=ga(Ua/R,Z);Z=new Date(J*ob);Z.setMilliseconds(0);if(R>=H)Z.setSeconds(R>=C?0:D*Mb(Z.getSeconds()/ D));if(R>=C)Z[Cd](R>=fa?0:D*Mb(Z[$c]()/D));if(R>=fa)Z[Dd](R>=X?0:D*Mb(Z[ad]()/D));if(R>=X)Z[cd](R>=o?1:D*Mb(Z[oc]()/D));if(R>=o){Z[Ed](R>=ja?0:D*Mb(Z[Dc]()/D));p=Z[Ec]()}if(R>=ja){p-=p%D;Z[Fd](p)}R==l&&Z[cd](Z[oc]()-Z[bd]()+h.startOfWeek);r=1;p=Z[Ec]();H=Z.getTime()/ob;C=Z[Dc]();for(fa=Z[oc]();H<Q&&r<Ba;){pa.push(H);if(R==ja)H=Cc(p+r*D,0)/ob;else if(R==o)H=Cc(p,C+r*D)/ob;else if(!U&&(R==X||R==l))H=Cc(p,C,fa+r*D*(R==X?1:7));else H+=R*D;r++}pa.push(H);Kc=h.dateTimeLabelFormats[la[0]]}else{r=Mb(J/Ua)* Ua;p=dd(Q/Ua)*Ua;pa=[];for(r=M(r);r<=p;){pa.push(r);r=M(r+Ua)}}if(!Nb){if(bb||ka&&m.hasColumn){p=(bb?1:Ua)*0.5;if(bb||!L(y(h.min,na)))J-=p;if(bb||!L(y(h.max,Ma)))Q+=p}p=pa[0];r=pa[pa.length-1];if(h.startOnTick)J=p;else J>p&&pa.shift();if(h.endOnTick)Q=r;else Q<r&&pa.pop();Eb||(Eb={x:0,y:0});if(!O&&pa.length>Eb[I])Eb[I]=pa.length}}function Da(){var l,p;fb=J;cc=Q;P();da();ha=F;F=B/(Q-J||1);if(!ka)for(l in ca)for(p in ca[l])ca[l][p].cum=ca[l][p].total;if(!s.isDirty)s.isDirty=J!=fb||Q!=cc}function ra(l){l= (new w(l)).render();Ob.push(l);return l}function Ya(){var l=h.title,p=h.alternateGridColor,r=h.lineWidth,o,U,X=m.hasRendered,H=X&&L(fb)&&!isNaN(fb);o=Y.length&&L(J)&&L(Q);B=N?Ba:qa;F=B/(Q-J||1);ua=N?W:pb;if(o||Nb){if(Jc&&!bb)for(o=J+(pa[0]-J)%Jc;o<=Q;o+=Jc){Xb[o]||(Xb[o]=new x(o,true));H&&Xb[o].isNew&&Xb[o].render(null,true);Xb[o].isActive=true;Xb[o].render()}u(pa,function(C,fa){if(!Nb||C>=J&&C<=Q){H&&qb[C].isNew&&qb[C].render(fa,true);qb[C].isActive=true;qb[C].render(fa)}});p&&u(pa,function(C,fa){if(fa% 2===0&&C<Q){dc[C]||(dc[C]=new w);dc[C].options={from:C,to:pa[fa+1]!==Qa?pa[fa+1]:Q,color:p};dc[C].render();dc[C].isActive=true}});X||u((h.plotLines||[]).concat(h.plotBands||[]),function(C){Ob.push((new w(C)).render())})}u([qb,Xb,dc],function(C){for(var fa in C)if(C[fa].isActive)C[fa].isActive=false;else{C[fa].destroy();delete C[fa]}});if(r){o=W+(Na?Ba:0)+S;U=Oa-pb-(Na?qa:0)+S;o=$.crispLine([Wa,N?W:o,N?U:aa,Aa,N?Va-zb:o,N?U:Oa-pb],r);if(Ea)Ea.animate({d:o});else Ea=$.path(o).attr({stroke:h.lineColor, "stroke-width":r,zIndex:7}).add()}if(s.axisTitle){o=N?W:aa;r=oa(l.style.fontSize||12);o={low:o+(N?0:B),middle:o+B/2,high:o+(N?B:0)}[l.align];r=(N?aa+qa:W)+(N?1:-1)*(Na?-1:1)*ed+(G==2?r:0);s.axisTitle[X?"animate":"attr"]({x:N?o:r+(Na?Ba:0)+S+(l.x||0),y:N?r-(Na?qa:0)+S:o+(l.y||0)})}s.isDirty=false}function Ha(l){for(var p=0;p<Ob.length;p++)Ob[p].id==l&&Ob[p].destroy()}var ka=h.isX,Na=h.opposite,N=Fa?!ka:ka,G=N?Na?0:2:Na?1:3,ca={};h=va(ka?Lc:fd,[Wd,Xd,Ld,Yd][G],h);var s=this,O=h.type=="datetime",S=h.offset|| 0,I=ka?"x":"y",B,F,ha,ua=N?W:pb,sa,Ia,rb,Fb,Ea,Sa,v,Y,na,Ma,Q=null,J=null,fb,cc,Wb=h.minPadding,Kd=h.maxPadding,Nb=L(h.linkedTo),Id,Jd,Ic,Md=h.events,gd,Ob=[],Ua,Jc,Db,pa,qb={},Xb={},dc={},ec,fc,ed,Kc,bb=h.categories,Zd=h.labels.formatter||function(){var l=this.value;return Kc?Mc(Kc,l):Ua%1E6===0?l/1E6+"M":Ua%1E3===0?l/1E3+"k":!bb&&l>=1E3?Gd(l,0):l},Nc=N&&h.labels.staggerLines,Yb=h.reversed,Zb=bb&&h.tickmarkPlacement=="between"?0.5:0;x.prototype={addLabel:function(){var l=this.pos,p=h.labels,r=!(l== J&&!y(h.showFirstLabel,1)||l==Q&&!y(h.showLastLabel,0)),o,U=this.label;l=Zd.call({isFirst:l==pa[0],isLast:l==pa[pa.length-1],dateTimeLabelFormat:Kc,value:bb&&bb[l]?bb[l]:l});o=o&&{width:o-2*(p.padding||10)+Za};if(U===Qa)this.label=L(l)&&r&&p.enabled?$.text(l,0,0).attr({align:p.align,rotation:p.rotation}).css(ma(o,p.style)).add(rb):null;else U&&U.attr({text:l}).css(o)},getLabelSize:function(){var l=this.label;return l?(this.labelBBox=l.getBBox())[N?"height":"width"]:0},render:function(l,p){var r=!this.minor, o=this.label,U=this.pos,X=h.labels,H=this.gridLine,C=r?h.gridLineWidth:h.minorGridLineWidth,fa=r?h.gridLineColor:h.minorGridLineColor,ja=r?h.gridLineDashStyle:h.minorGridLineDashStyle,D=this.mark,la=r?h.tickLength:h.minorTickLength,R=r?h.tickWidth:h.minorTickWidth||0,Z=r?h.tickColor:h.minorTickColor,pc=r?h.tickPosition:h.minorTickPosition;r=X.step;var gb=p&&Oc||Oa,Pb;Pb=N?sa(U+Zb,null,null,p)+ua:W+S+(Na?(p&&hd||Va)-zb-W:0);gb=N?gb-pb+S-(Na?qa:0):gb-sa(U+Zb,null,null,p)-ua;if(C){U=Ia(U+Zb,C,p);if(H=== Qa){H={stroke:fa,"stroke-width":C};if(ja)H.dashstyle=ja;this.gridLine=H=C?$.path(U).attr(H).add(Fb):null}H&&U&&H.animate({d:U})}if(R){if(pc=="inside")la=-la;if(Na)la=-la;C=$.crispLine([Wa,Pb,gb,Aa,Pb+(N?0:-la),gb+(N?la:0)],R);if(D)D.animate({d:C});else this.mark=$.path(C).attr({stroke:Z,"stroke-width":R}).add(rb)}if(o){Pb=Pb+X.x-(Zb&&N?Zb*F*(Yb?-1:1):0);gb=gb+X.y-(Zb&&!N?Zb*F*(Yb?1:-1):0);L(X.y)||(gb+=parseInt(o.styles.lineHeight)*0.9-o.getBBox().height/2);if(Nc)gb+=l%Nc*16;if(r)o[l%r?"hide":"show"](); o[this.isNew?"attr":"animate"]({x:Pb,y:gb})}this.isNew=false},destroy:function(){for(var l in this)this[l]&&this[l].destroy&&this[l].destroy()}};w.prototype={render:function(){var l=this,p=l.options,r=p.label,o=l.label,U=p.width,X=p.to,H,C=p.from,fa=p.dashStyle,ja=l.svgElem,D=[],la,R,Z=p.color;R=p.zIndex;var pc=p.events;if(U){D=Ia(p.value,U);p={stroke:Z,"stroke-width":U};if(fa)p.dashstyle=fa}else if(L(C)&&L(X)){C=Ga(C,J);X=nb(X,Q);H=Ia(X);if((D=Ia(C))&&H)D.push(H[4],H[5],H[1],H[2]);else D=null;p= {fill:Z}}else return;if(L(R))p.zIndex=R;if(ja)if(D)ja.animate({d:D},null,ja.onGetPath);else{ja.hide();ja.onGetPath=function(){ja.show()}}else if(D&&D.length){l.svgElem=ja=$.path(D).attr(p).add();if(pc){fa=function(gb){ja.on(gb,function(Pb){pc[gb].apply(l,[Pb])})};for(la in pc)fa(la)}}if(r&&L(r.text)&&D&&D.length&&Ba>0&&qa>0){r=va({align:N&&H&&"center",x:N?!H&&4:10,verticalAlign:!N&&H&&"middle",y:N?H?16:10:H?6:-4,rotation:N&&!H&&90},r);if(!o)l.label=o=$.text(r.text,0,0).attr({align:r.textAlign||r.align, rotation:r.rotation,zIndex:R}).css(r.style).add();H=[D[1],D[4],D[6]||D[1]];D=[D[2],D[5],D[7]||D[2]];la=nb.apply(Ta,H);R=nb.apply(Ta,D);o.align(r,false,{x:la,y:R,width:Ga.apply(Ta,H)-la,height:Ga.apply(Ta,D)-R});o.show()}else o&&o.hide();return l},destroy:function(){for(var l in this){this[l]&&this[l].destroy&&this[l].destroy();delete this[l]}mc(Ob,this)}};sa=function(l,p,r,o){var U=1,X=0,H=o?ha:F;o=o?fb:J;H||(H=F);if(r){U*=-1;X=B}if(Yb){U*=-1;X-=U*B}if(p){if(Yb)l=B-l;l=l/H+o}else l=U*(l-o)*H+X;return l}; Ia=function(l,p,r){var o,U,X;l=sa(l,null,null,r);var H=r&&Oc||Oa,C=r&&hd||Va,fa;r=U=V(l+ua);o=X=V(H-l-ua);if(isNaN(l))fa=true;else if(N){o=aa;X=H-pb;if(r<W||r>W+Ba)fa=true}else{r=W;U=C-zb;if(o<aa||o>aa+qa)fa=true}return fa?null:$.crispLine([Wa,r,o,Aa,U,X],p||0)};if(Fa&&ka&&Yb===Qa)Yb=true;ma(s,{addPlotBand:ra,addPlotLine:ra,adjustTickAmount:function(){if(Eb&&!O&&!bb&&!Nb){var l=ec,p=pa.length;ec=Eb[I];if(p<ec){for(;pa.length<ec;)pa.push(M(pa[pa.length-1]+Ua));F*=(p-1)/(ec-1);Q=pa[pa.length-1]}if(L(l)&& ec!=l)s.isDirty=true}},categories:bb,getExtremes:function(){return{min:J,max:Q,dataMin:Sa,dataMax:v}},getPlotLinePath:Ia,getThreshold:function(l){if(J>l)l=J;else if(Q<l)l=Q;return sa(l,0,1)},isXAxis:ka,options:h,plotLinesAndBands:Ob,getOffset:function(){var l=Y.length&&L(J)&&L(Q),p=0,r=0,o=h.title,U=h.labels,X=[-1,1,1,-1][G];if(!rb){rb=$.g("axis").attr({zIndex:7}).add();Fb=$.g("grid").attr({zIndex:1}).add()}fc=0;if(l||Nb){u(pa,function(C){if(qb[C])qb[C].addLabel();else qb[C]=new x(C);if(G===0||G== 2||{1:"left",3:"right"}[G]==U.align)fc=Ga(qb[C].getLabelSize(),fc)});if(Nc)fc+=(Nc-1)*16}else for(var H in qb){qb[H].destroy();delete qb[H]}if(o&&o.text){if(!s.axisTitle)s.axisTitle=$.text(o.text,0,0).attr({zIndex:7,rotation:o.rotation||0,align:o.textAlign||{low:"left",middle:"center",high:"right"}[o.align]}).css(o.style).add();p=s.axisTitle.getBBox()[N?"height":"width"];r=y(o.margin,N?5:10)}S=X*(h.offset||Qb[G]);ed=fc+(G!=2&&fc&&X*h.labels[N?"y":"x"])+r;Qb[G]=Ga(Qb[G],ed+p+X*S)},render:Ya,setCategories:function(l, p){s.categories=bb=l;u(Y,function(r){r.translate();r.setTooltipPoints(true)});s.isDirty=true;y(p,true)&&m.redraw()},setExtremes:function(l,p,r,o){Kb(o,m);r=y(r,true);Ja(s,"setExtremes",{min:l,max:p},function(){na=l;Ma=p;r&&m.redraw()})},setScale:Da,setTickPositions:da,translate:sa,redraw:function(){gc.resetTracker&&gc.resetTracker();Ya();u(Ob,function(l){l.render()});u(Y,function(l){l.isDirty=true})},removePlotBand:Ha,removePlotLine:Ha,reversed:Yb,stacks:ca});for(gd in Md)Pa(s,gd,Md[gd]);Da()}function d(){var m= {};return{add:function(h,x,w,P){if(!m[h]){x=$.text(x,0,0).css(a.toolbar.itemStyle).align({align:"right",x:-zb-20,y:aa+30}).on("click",P).attr({align:"right",zIndex:20}).add();m[h]=x}},remove:function(h){Fc(m[h].element);m[h]=null}}}function e(m){function h(){var I=this.points||nc(this),B=I[0].series.xAxis,F=this.x;B=B&&B.options.type=="datetime";var ha=Ib(F)||B,ua;ua=ha?['<span style="font-size: 10px">',B?Mc("%A, %b %e, %Y",F):F,"</span><br/>"]:[];u(I,function(sa){ua.push(sa.point.tooltipFormatter(ha))}); return ua.join("")}function x(I,B){G=ka?I:(2*G+I)/3;ca=ka?B:(ca+B)/2;s.translate(G,ca);id=ab(I-G)>1||ab(B-ca)>1?function(){x(I,B)}:null}function w(){if(!ka){var I=q.hoverPoints;s.hide();u(da,function(B){B&&B.hide()});I&&u(I,function(B){B.setState()});q.hoverPoints=null;ka=true}}var P,ga=m.borderWidth,M=m.crosshairs,da=[],Da=m.style,ra=m.shared,Ya=oa(Da.padding),Ha=ga+Ya,ka=true,Na,N,G=0,ca=0;Da.padding=0;var s=$.g("tooltip").attr({zIndex:8}).add(),O=$.rect(Ha,Ha,0,0,m.borderRadius,ga).attr({fill:m.backgroundColor, "stroke-width":ga}).add(s).shadow(m.shadow),S=$.text("",Ya+Ha,oa(Da.fontSize)+Ya+Ha).attr({zIndex:1}).css(Da).add(s);s.hide();return{shared:ra,refresh:function(I){var B,F,ha,ua=0,sa={},Ia=[];ha=I.tooltipPos;B=m.formatter||h;sa=q.hoverPoints;var rb=function(Ea){return{series:Ea.series,point:Ea,x:Ea.category,y:Ea.y,percentage:Ea.percentage,total:Ea.total||Ea.stackTotal}};if(ra){sa&&u(sa,function(Ea){Ea.setState()});q.hoverPoints=I;u(I,function(Ea){Ea.setState(xb);ua+=Ea.plotY;Ia.push(rb(Ea))});F=I[0].plotX; ua=V(ua)/I.length;sa={x:I[0].category};sa.points=Ia;I=I[0]}else sa=rb(I);sa=B.call(sa);P=I.series;F=ra?F:I.plotX;ua=ra?ua:I.plotY;B=V(ha?ha[0]:Fa?Ba-ua:F);F=V(ha?ha[1]:Fa?qa-F:ua);ha=ra||!I.series.isCartesian||hc(B,F);if(sa===false||!ha)w();else{if(ka){s.show();ka=false}S.attr({text:sa});ha=S.getBBox();Na=ha.width;N=ha.height;O.attr({width:Na+2*Ya,height:N+2*Ya,stroke:m.borderColor||I.color||P.color||"#606060"});B=B-Na+W-25;F=F-N+aa+10;if(B<7){B=7;F-=30}if(F<5)F=5;else if(F+N>Oa)F=Oa-N-5;x(V(B-Ha), V(F-Ha))}if(M){M=nc(M);F=M.length;for(var Fb;F--;)if(M[F]&&(Fb=I.series[F?"yAxis":"xAxis"])){B=Fb.getPlotLinePath(I[F?"y":"x"],1);if(da[F])da[F].attr({d:B,visibility:Ab});else{ha={"stroke-width":M[F].width||1,stroke:M[F].color||"#C0C0C0",zIndex:2};if(M[F].dashStyle)ha.dashstyle=M[F].dashStyle;da[F]=$.path(B).attr(ha).add()}}}},hide:w}}function f(m,h){function x(G){var ca;G=G||hb.event;if(!G.target)G.target=G.srcElement;ca=G.touches?G.touches.item(0):G;if(G.type!="mousemove"||hb.opera){for(var s=ta, O={left:s.offsetLeft,top:s.offsetTop};s=s.offsetParent;){O.left+=s.offsetLeft;O.top+=s.offsetTop;if(s!=ya.body&&s!=ya.documentElement){O.left-=s.scrollLeft;O.top-=s.scrollTop}}qc=O}if(Ac){G.chartX=G.x;G.chartY=G.y}else if(ca.layerX===Qa){G.chartX=ca.pageX-qc.left;G.chartY=ca.pageY-qc.top}else{G.chartX=G.layerX;G.chartY=G.layerY}return G}function w(G){var ca={xAxis:[],yAxis:[]};u(Xa,function(s){var O=s.translate,S=s.isXAxis;ca[S?"xAxis":"yAxis"].push({axis:s,value:O((Fa?!S:S)?G.chartX-W:qa-G.chartY+ aa,true)})});return ca}function P(){var G=m.hoverSeries,ca=m.hoverPoint;ca&&ca.onMouseOut();G&&G.onMouseOut();rc&&rc.hide();jd=null}function ga(){if(ra){var G={xAxis:[],yAxis:[]},ca=ra.getBBox(),s=ca.x-W,O=ca.y-aa;if(Da){u(Xa,function(S){var I=S.translate,B=S.isXAxis,F=Fa?!B:B,ha=I(F?s:qa-O-ca.height,true);I=I(F?s+ca.width:qa-O,true);G[B?"xAxis":"yAxis"].push({axis:S,min:nb(ha,I),max:Ga(ha,I)})});Ja(m,"selection",G,kd)}ra=ra.destroy()}m.mouseIsDown=ld=Da=false;Bb(ya,Gb?"touchend":"mouseup",ga)}var M, da,Da,ra,Ya=t.zoomType,Ha=/x/.test(Ya),ka=/y/.test(Ya),Na=Ha&&!Fa||ka&&Fa,N=ka&&!Fa||Ha&&Fa;Pc=function(){if(Qc){Qc.translate(W,aa);Fa&&Qc.attr({width:m.plotWidth,height:m.plotHeight}).invert()}else m.trackerGroup=Qc=$.g("tracker").attr({zIndex:9}).add()};Pc();if(h.enabled)m.tooltip=rc=e(h);(function(){var G=true;ta.onmousedown=function(s){s=x(s);m.mouseIsDown=ld=true;M=s.chartX;da=s.chartY;Pa(ya,Gb?"touchend":"mouseup",ga)};var ca=function(s){if(!(s&&s.touches&&s.touches.length>1)){s=x(s);if(!Gb)s.returnValue= false;var O=s.chartX,S=s.chartY,I=!hc(O-W,S-aa);if(Gb&&s.type=="touchstart")if(wa(s.target,"isTracker"))m.runTrackerClick||s.preventDefault();else!$d&&!I&&s.preventDefault();if(I){G||P();if(O<W)O=W;else if(O>W+Ba)O=W+Ba;if(S<aa)S=aa;else if(S>aa+qa)S=aa+qa}if(ld&&s.type!="touchstart"){if(Da=Math.sqrt(Math.pow(M-O,2)+Math.pow(da-S,2))>10){if(ic&&(Ha||ka)&&hc(M-W,da-aa))ra||(ra=$.rect(W,aa,Na?1:Ba,N?1:qa,0).attr({fill:"rgba(69,114,167,0.25)",zIndex:7}).add());if(ra&&Na){O-=M;ra.attr({width:ab(O),x:(O> 0?0:O)+M})}if(ra&&N){S-=da;ra.attr({height:ab(S),y:(S>0?0:S)+da})}}}else if(!I){var B;S=m.hoverPoint;O=m.hoverSeries;var F,ha,ua=Va,sa=Fa?s.chartY:s.chartX-W;if(rc&&h.shared){B=[];F=za.length;for(ha=0;ha<F;ha++)if(za[ha].visible&&za[ha].tooltipPoints.length){s=za[ha].tooltipPoints[sa];s._dist=ab(sa-s.plotX);ua=nb(ua,s._dist);B.push(s)}for(F=B.length;F--;)B[F]._dist>ua&&B.splice(F,1);if(B.length&&B[0].plotX!=jd){rc.refresh(B);jd=B[0].plotX}}if(O&&O.tracker)(s=O.tooltipPoints[sa])&&s!=S&&s.onMouseOver()}return(G= I)||!ic}};ta.onmousemove=ca;Pa(ta,"mouseleave",P);ta.ontouchstart=function(s){if(Ha||ka)ta.onmousedown(s);ca(s)};ta.ontouchmove=ca;ta.ontouchend=function(){Da&&P()};ta.onclick=function(s){var O=m.hoverPoint;s=x(s);s.cancelBubble=true;if(!Da)if(O&&wa(s.target,"isTracker")){var S=O.plotX,I=O.plotY;ma(O,{pageX:qc.left+W+(Fa?Ba-I:S),pageY:qc.top+aa+(Fa?qa-S:I)});Ja(O.series,"click",ma(s,{point:O}));O.firePointEvent("click",s)}else{ma(s,w(s));hc(s.chartX-W,s.chartY-aa)&&Ja(m,"click",s)}Da=false}})();Nd= setInterval(function(){id&&id()},32);ma(this,{zoomX:Ha,zoomY:ka,resetTracker:P})}function g(m){var h=m.type||t.type||t.defaultSeriesType,x=sb[h],w=q.hasRendered;if(w)if(Fa&&h=="column")x=sb.bar;else if(!Fa&&h=="bar")x=sb.column;h=new x;h.init(q,m);if(!w&&h.inverted)Fa=true;if(h.isCartesian)ic=h.isCartesian;za.push(h);return h}function i(){t.alignTicks!==false&&u(Xa,function(m){m.adjustTickAmount()});Eb=null}function j(m){var h=q.isDirtyLegend,x,w=q.isDirtyBox,P=za.length,ga=P,M=q.clipRect;for(Kb(m, q);ga--;){m=za[ga];if(m.isDirty&&m.options.stacking){x=true;break}}if(x)for(ga=P;ga--;){m=za[ga];if(m.options.stacking)m.isDirty=true}u(za,function(da){if(da.isDirty){da.cleanData();da.getSegments();if(da.options.legendType=="point")h=true}});if(h&&md.renderLegend){md.renderLegend();q.isDirtyLegend=false}if(ic){if(!Rc){Eb=null;u(Xa,function(da){da.setScale()})}i();sc();u(Xa,function(da){if(da.isDirty||w){da.redraw();w=true}})}if(w){nd();Pc();if(M){Sc(M);M.animate({width:q.plotSizeX,height:q.plotSizeY})}}u(za, function(da){if(da.isDirty&&da.visible&&(!da.isCartesian||da.xAxis))da.redraw()});gc&&gc.resetTracker&&gc.resetTracker();Ja(q,"redraw")}function k(){var m=a.xAxis||{},h=a.yAxis||{},x;m=nc(m);u(m,function(w,P){w.index=P;w.isX=true});h=nc(h);u(h,function(w,P){w.index=P});Xa=m.concat(h);q.xAxis=[];q.yAxis=[];Xa=jc(Xa,function(w){x=new c(q,w);q[x.isXAxis?"xAxis":"yAxis"].push(x);return x});i()}function n(m,h){kc=va(a.title,m);tc=va(a.subtitle,h);u([["title",m,kc],["subtitle",h,tc]],function(x){var w= x[0],P=q[w],ga=x[1];x=x[2];if(P&&ga){P.destroy();P=null}if(x&&x.text&&!P)q[w]=$.text(x.text,0,0).attr({align:x.align,"class":"highcharts-"+w,zIndex:1}).css(x.style).add().align(x,false,uc)})}function z(){ib=t.renderTo;Od=$b+od++;if(Ib(ib))ib=ya.getElementById(ib);ib.innerHTML="";if(!ib.offsetWidth){Rb=ib.cloneNode(0);La(Rb,{position:lc,top:"-9999px",display:""});ya.body.appendChild(Rb)}Tc=(Rb||ib).offsetWidth;vc=(Rb||ib).offsetHeight;q.chartWidth=Va=t.width||Tc||600;q.chartHeight=Oa=t.height||(vc> 19?vc:400);q.container=ta=eb(Lb,{className:"highcharts-container"+(t.className?" "+t.className:""),id:Od},ma({position:Pd,overflow:tb,width:Va+Za,height:Oa+Za,textAlign:"left"},t.style),Rb||ib);q.renderer=$=t.renderer=="SVG"?new Uc(ta,Va,Oa):new Qd(ta,Va,Oa);var m,h;if(/Firefox/.test(wc)&&ta.getBoundingClientRect){m=function(){La(ta,{left:0,top:0});h=ta.getBoundingClientRect();La(ta,{left:-h.left%1+Za,top:-h.top%1+Za})};m();Pa(hb,"resize",m);Pa(q,"destroy",function(){Bb(hb,"resize",m)})}}function E(){function m(){var x= t.width||ib.offsetWidth,w=t.height||ib.offsetHeight;if(x&&w){if(x!=Tc||w!=vc){clearTimeout(h);h=setTimeout(function(){pd(x,w,false)},100)}Tc=x;vc=w}}var h;Pa(window,"resize",m);Pa(q,"destroy",function(){Bb(window,"resize",m)})}function ia(){var m=a.labels,h=a.credits,x;n();md=q.legend=new ae(q);sc();u(Xa,function(w){w.setTickPositions(true)});i();sc();nd();ic&&u(Xa,function(w){w.render()});if(!q.seriesGroup)q.seriesGroup=$.g("series-group").attr({zIndex:3}).add();u(za,function(w){w.translate();w.setTooltipPoints(); w.render()});m.items&&u(m.items,function(){var w=ma(m.style,this.style),P=oa(w.left)+W,ga=oa(w.top)+aa+12;delete w.left;delete w.top;$.text(this.html,P,ga).attr({zIndex:2}).css(w).add()});if(!q.toolbar)q.toolbar=d(q);if(h.enabled&&!q.credits){x=h.href;$.text(h.text,0,0).on("click",function(){if(x)location.href=x}).attr({align:h.position.align,zIndex:8}).css(h.style).add().align(h.position)}Pc();q.hasRendered=true;if(Rb){ib.appendChild(ta);Fc(Rb)}}function T(){var m=za.length,h=ta&&ta.parentNode;Ja(q, "destroy");Bb(hb,"unload",T);Bb(q);for(u(Xa,function(x){Bb(x)});m--;)za[m].destroy();ta.innerHTML="";Bb(ta);h&&h.removeChild(ta);ta=null;$.alignedObjects=null;clearInterval(Nd);for(m in q)delete q[m]}function K(){if(!xc&&!hb.parent&&ya.readyState!="complete")ya.attachEvent("onreadystatechange",function(){ya.detachEvent("onreadystatechange",K);K()});else{z();qd();rd();u(a.series||[],function(m){g(m)});q.inverted=Fa=y(Fa,a.chart.inverted);k();q.render=ia;q.tracker=gc=new f(q,a.tooltip);ia();Ja(q,"load"); b&&b.apply(q,[q]);u(q.callbacks,function(m){m.apply(q,[q])})}}Lc=va(Lc,Ra.xAxis);fd=va(fd,Ra.yAxis);Ra.xAxis=Ra.yAxis=null;a=va(Ra,a);var t=a.chart,A=t.margin;A=Jb(A)?A:[A,A,A,A];var ba=y(t.marginTop,A[0]),ea=y(t.marginRight,A[1]),Ca=y(t.marginBottom,A[2]),xa=y(t.marginLeft,A[3]),$a=t.spacingTop,jb=t.spacingRight,sd=t.spacingBottom,Vc=t.spacingLeft,uc,kc,tc,aa,zb,pb,W,Qb,ib,Rb,ta,Od,Tc,vc,Va,Oa,hd,Oc,td,ud,vd,wd,q=this,$d=(A=t.events)&&!!A.click,xd,hc,rc,ld,ac,Rd,yd,qa,Ba,gc,Qc,Pc,md,Sb,Tb,qc,ic= t.showAxes,Rc=0,Xa=[],Eb,za=[],Fa,$,id,Nd,jd,nd,sc,qd,rd,pd,kd,Sd,ae=function(m){function h(v,Y){var na=v.legendItem,Ma=v.legendLine,Q=v.legendSymbol,J=N.color,fb=Y?M.itemStyle.color:J;J=Y?v.color:J;na&&na.css({fill:fb});Ma&&Ma.attr({stroke:J});Q&&Q.attr({stroke:J,fill:J})}function x(v,Y,na){var Ma=v.legendItem,Q=v.legendLine,J=v.legendSymbol;v=v.checkbox;Ma&&Ma.attr({x:Y,y:na});Q&&Q.translate(Y,na-4);J&&J.attr({x:Y+J.xOff,y:na+J.yOff});if(v){v.x=Y;v.y=na}}function w(){u(Ya,function(v){var Y=v.checkbox; Y&&La(Y,{left:Ia.attr("translateX")+v.legendItemWidth+Y.x-40+Za,top:Ia.attr("translateY")+Y.y-11+Za})})}function P(v){var Y,na,Ma,Q,J,fb=v.legendItem;Q=v.series||v;if(!fb){J=/^(bar|pie|area|column)$/.test(Q.type);v.legendItem=fb=$.text(M.labelFormatter.call(v),0,0).css(v.visible?ka:N).on("mouseover",function(){v.setState(xb);fb.css(Na)}).on("mouseout",function(){fb.css(v.visible?ka:N);v.setState()}).on("click",function(){var Wb=function(){v.setVisible()};v.firePointEvent?v.firePointEvent("legendItemClick", null,Wb):Ja(v,"legendItemClick",null,Wb)}).attr({zIndex:2}).add(Ia);if(!J&&v.options&&v.options.lineWidth){var cc=v.options;Q={"stroke-width":cc.lineWidth,zIndex:2};if(cc.dashStyle)Q.dashstyle=cc.dashStyle;v.legendLine=$.path([Wa,-Da-ra,0,Aa,-ra,0]).attr(Q).add(Ia)}if(J)Y=$.rect(na=-Da-ra,Ma=-11,Da,12,2).attr({"stroke-width":0,zIndex:3}).add(Ia);else if(v.options&&v.options.marker&&v.options.marker.enabled)Y=$.symbol(v.symbol,na=-Da/2-ra,Ma=-4,v.options.marker.radius).attr(v.pointAttr[cb]).attr({zIndex:3}).add(Ia); if(Y){Y.xOff=na;Y.yOff=Ma}v.legendSymbol=Y;h(v,v.visible);if(v.options&&v.options.showCheckbox){v.checkbox=eb("input",{type:"checkbox",checked:v.selected,defaultChecked:v.selected},M.itemCheckboxStyle,ta);Pa(v.checkbox,"click",function(Wb){Ja(v,"checkboxClick",{checked:Wb.target.checked},function(){v.select()})})}}Y=fb.getBBox();na=v.legendItemWidth=M.itemWidth||Da+ra+Y.width+ca;F=Y.height;if(da&&S-O+na>(Fb||Va-2*G-O)){S=O;I+=F}B=I;x(v,S,I);if(da)S+=na;else I+=F;rb=Fb||Ga(da?S-O:na,rb);Ya.push(v)} function ga(){S=O;I=s;B=rb=0;Ya=[];Ia||(Ia=$.g("legend").attr({zIndex:7}).add());Sa&&Ea.reverse();u(Ea,function(Ma){if(Ma.options.showInLegend)u(Ma.options.legendType=="point"?Ma.data:[Ma],P)});Sa&&Ea.reverse();Sb=Fb||rb;Tb=B-s+F;if(ua||sa){Sb+=2*G;Tb+=2*G;if(ha)Sb>0&&Tb>0&&ha.animate({width:Sb,height:Tb});else ha=$.rect(0,0,Sb,Tb,M.borderRadius,ua||0).attr({stroke:M.borderColor,"stroke-width":ua||0,fill:sa||mb}).add(Ia).shadow(M.shadow);ha[Ya.length?"show":"hide"]()}for(var v=["left","right","top", "bottom"],Y,na=4;na--;){Y=v[na];if(Ha[Y]&&Ha[Y]!="auto"){M[na<2?"align":"verticalAlign"]=Y;M[na<2?"x":"y"]=oa(Ha[Y])*(na%2?-1:1)}}Ia.align(ma(M,{width:Sb,height:Tb}),true,uc);Rc||w()}var M=m.options.legend;if(M.enabled){var da=M.layout=="horizontal",Da=M.symbolWidth,ra=M.symbolPadding,Ya,Ha=M.style,ka=M.itemStyle,Na=M.itemHoverStyle,N=M.itemHiddenStyle,G=oa(Ha.padding),ca=20,s=18,O=4+G+Da+ra,S,I,B,F=0,ha,ua=M.borderWidth,sa=M.backgroundColor,Ia,rb,Fb=M.width,Ea=m.series,Sa=M.reversed;ga();Pa(m,"endResize", w);return{colorizeItem:h,destroyItem:function(v){var Y=v.checkbox;u(["legendItem","legendLine","legendSymbol"],function(na){v[na]&&v[na].destroy()});Y&&Fc(v.checkbox)},renderLegend:ga}}};hc=function(m,h){return m>=0&&m<=Ba&&h>=0&&h<=qa};Sd=function(){Ja(q,"selection",{resetSelection:true},kd);q.toolbar.remove("zoom")};kd=function(m){var h=Ra.lang,x=q.pointCount<100;q.toolbar.add("zoom",h.resetZoom,h.resetZoomTitle,Sd);!m||m.resetSelection?u(Xa,function(w){w.setExtremes(null,null,false,x)}):u(m.xAxis.concat(m.yAxis), function(w){var P=w.axis;if(q.tracker[P.isXAxis?"zoomX":"zoomY"])P.setExtremes(w.min,w.max,false,x)});j()};sc=function(){var m=a.legend,h=y(m.margin,10),x=m.x,w=m.y,P=m.align,ga=m.verticalAlign,M;qd();if((q.title||q.subtitle)&&!L(ba))if(M=Ga(q.title&&!kc.floating&&!kc.verticalAlign&&kc.y||0,q.subtitle&&!tc.floating&&!tc.verticalAlign&&tc.y||0))aa=Ga(aa,M+y(kc.margin,15)+$a);if(m.enabled&&!m.floating)if(P=="right")L(ea)||(zb=Ga(zb,Sb-x+h+jb));else if(P=="left")L(xa)||(W=Ga(W,Sb+x+h+Vc));else if(ga== "top")L(ba)||(aa=Ga(aa,Tb+w+h+$a));else if(ga=="bottom")L(Ca)||(pb=Ga(pb,Tb-w+h+sd));ic&&u(Xa,function(da){da.getOffset()});L(xa)||(W+=Qb[3]);L(ba)||(aa+=Qb[0]);L(Ca)||(pb+=Qb[2]);L(ea)||(zb+=Qb[1]);rd()};pd=function(m,h,x){var w=q.title,P=q.subtitle;Rc+=1;Kb(x,q);Oc=Oa;hd=Va;Va=V(m);Oa=V(h);La(ta,{width:Va+Za,height:Oa+Za});$.setSize(Va,Oa,x);Ba=Va-W-zb;qa=Oa-aa-pb;Eb=null;u(Xa,function(ga){ga.isDirty=true;ga.setScale()});u(za,function(ga){ga.isDirty=true});q.isDirtyLegend=true;q.isDirtyBox=true; sc();w&&w.align(null,null,uc);P&&P.align(null,null,uc);j(x);Oc=null;Ja(q,"resize");setTimeout(function(){Ja(q,"endResize",null,function(){Rc-=1})},Bc&&Bc.duration||500)};rd=function(){q.plotLeft=W=V(W);q.plotTop=aa=V(aa);q.plotWidth=Ba=V(Va-W-zb);q.plotHeight=qa=V(Oa-aa-pb);q.plotSizeX=Fa?qa:Ba;q.plotSizeY=Fa?Ba:qa;uc={x:Vc,y:$a,width:Va-Vc-jb,height:Oa-$a-sd}};qd=function(){aa=y(ba,$a);zb=y(ea,jb);pb=y(Ca,sd);W=y(xa,Vc);Qb=[0,0,0,0]};nd=function(){var m=t.borderWidth||0,h=t.backgroundColor,x=t.plotBackgroundColor, w=t.plotBackgroundImage,P,ga={x:W,y:aa,width:Ba,height:qa};P=m+(t.shadow?8:0);if(m||h)if(td)td.animate({width:Va-P,height:Oa-P});else td=$.rect(P/2,P/2,Va-P,Oa-P,t.borderRadius,m).attr({stroke:t.borderColor,"stroke-width":m,fill:h||mb}).add().shadow(t.shadow);if(x)if(ud)ud.animate(ga);else ud=$.rect(W,aa,Ba,qa,0).attr({fill:x}).add().shadow(t.plotShadow);if(w)if(vd)vd.animate(ga);else vd=$.image(w,W,aa,Ba,qa).add();if(t.plotBorderWidth)if(wd)wd.animate(ga);else wd=$.rect(W,aa,Ba,qa,0,t.plotBorderWidth).attr({stroke:t.plotBorderColor, "stroke-width":t.plotBorderWidth,zIndex:4}).add();q.isDirtyBox=false};Wc=Hb=0;Pa(hb,"unload",T);t.reflow!==false&&Pa(q,"load",E);if(A)for(xd in A)Pa(q,xd,A[xd]);q.options=a;q.series=za;q.addSeries=function(m,h,x){var w;if(m){Kb(x,q);h=y(h,true);Ja(q,"addSeries",{options:m},function(){w=g(m);w.isDirty=true;q.isDirtyLegend=true;h&&q.redraw()})}return w};q.animation=y(t.animation,true);q.destroy=T;q.get=function(m){var h,x,w;for(h=0;h<Xa.length;h++)if(Xa[h].options.id==m)return Xa[h];for(h=0;h<za.length;h++)if(za[h].options.id== m)return za[h];for(h=0;h<za.length;h++){w=za[h].data;for(x=0;x<w.length;x++)if(w[x].id==m)return w[x]}return null};q.getSelectedPoints=function(){var m=[];u(za,function(h){m=m.concat(zd(h.data,function(x){return x.selected}))});return m};q.getSelectedSeries=function(){return zd(za,function(m){return m.selected})};q.hideLoading=function(){Xc(ac,{opacity:0},{duration:a.loading.hideDuration,complete:function(){La(ac,{display:mb})}});yd=false};q.isInsidePlot=hc;q.redraw=j;q.setSize=pd;q.setTitle=n;q.showLoading= function(m){var h=a.loading;if(!ac){ac=eb(Lb,{className:"highcharts-loading"},ma(h.style,{left:W+Za,top:aa+Za,width:Ba+Za,height:qa+Za,zIndex:10,display:mb}),ta);Rd=eb("span",null,h.labelStyle,ac)}Rd.innerHTML=m||a.lang.loading;if(!yd){La(ac,{opacity:0,display:""});Xc(ac,{opacity:h.style.opacity},{duration:h.showDuration});yd=true}};q.pointCount=0;K()}var ya=document,hb=window,Ta=Math,V=Ta.round,Mb=Ta.floor,dd=Ta.ceil,Ga=Ta.max,nb=Ta.min,ab=Ta.abs,ub=Ta.cos,yb=Ta.sin,Ub=Ta.PI,Td=Ub*2/360,wc=navigator.userAgent, Ac=/msie/i.test(wc)&&!hb.opera,yc=ya.documentMode==8,be=/AppleWebKit/.test(wc),xc=hb.SVGAngle||ya.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1"),Gb="ontouchstart"in ya.documentElement,Hb,Wc,ce={},od=0,ob=1,Gc,Ra,Mc,Bc,Yc,Qa,Lb="div",lc="absolute",Pd="relative",tb="hidden",$b="highcharts-",Ab="visible",Za="px",mb="none",Wa="M",Aa="L",Ud="rgba(192,192,192,"+(xc?1.0E-6:0.002)+")",cb="",xb="hover",Cc,$c,ad,bd,oc,Dc,Ec,Cd,Dd,cd,Ed,Fd,db=hb.HighchartsAdapter,Cb=db|| {},u=Cb.each,zd=Cb.grep,jc=Cb.map,va=Cb.merge,Ad=Cb.hyphenate,Pa=Cb.addEvent,Bb=Cb.removeEvent,Ja=Cb.fireEvent,Xc=Cb.animate,Sc=Cb.stop,sb={};db&&db.init&&db.init();if(!db&&hb.jQuery){var kb=jQuery;u=function(a,b){for(var c=0,d=a.length;c<d;c++)if(b.call(a[c],a[c],c,a)===false)return c};zd=kb.grep;jc=function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)c[d]=b.call(a[d],a[d],d,a);return c};va=function(){var a=arguments;return kb.extend(true,null,a[0],a[1],a[2],a[3])};Ad=function(a){return a.replace(/([A-Z])/g, function(b,c){return"-"+c.toLowerCase()})};Pa=function(a,b,c){kb(a).bind(b,c)};Bb=function(a,b,c){var d=ya.removeEventListener?"removeEventListener":"detachEvent";if(ya[d]&&!a[d])a[d]=function(){};kb(a).unbind(b,c)};Ja=function(a,b,c,d){var e=kb.Event(b),f="detached"+b;ma(e,c);if(a[b]){a[f]=a[b];a[b]=null}kb(a).trigger(e);if(a[f]){a[b]=a[f];a[f]=null}d&&!e.isDefaultPrevented()&&d(e)};Xc=function(a,b,c){var d=kb(a);if(b.d){a.toD=b.d;b.d=1}d.stop();d.animate(b,c)};Sc=function(a){kb(a).stop()};kb.extend(kb.easing, {easeOutQuad:function(a,b,c,d,e){return-d*(b/=e)*(b-2)+c}});var de=jQuery.fx.step._default,ee=jQuery.fx.prototype.cur;kb.fx.step._default=function(a){var b=a.elem;b.attr?b.attr(a.prop,a.now):de.apply(this,arguments)};kb.fx.step.d=function(a){var b=a.elem;if(!a.started){var c=Yc.init(b,b.d,b.toD);a.start=c[0];a.end=c[1];a.started=true}b.attr("d",Yc.step(a.start,a.end,a.pos,b.toD))};kb.fx.prototype.cur=function(){var a=this.elem;return a.attr?a.attr(this.prop):ee.apply(this,arguments)}}Yc={init:function(a, b,c){b=b||"";var d=a.shift,e=b.indexOf("C")>-1,f=e?7:3,g;b=b.split(" ");c=[].concat(c);var i,j,k=function(n){for(g=n.length;g--;)n[g]==Wa&&n.splice(g+1,0,n[g+1],n[g+2],n[g+1],n[g+2])};if(e){k(b);k(c)}if(a.isArea){i=b.splice(b.length-6,6);j=c.splice(c.length-6,6)}if(d){c=[].concat(c).splice(0,f).concat(c);a.shift=false}if(b.length)for(a=c.length;b.length<a;){d=[].concat(b).splice(b.length-f,f);if(e){d[f-6]=d[f-2];d[f-5]=d[f-1]}b=b.concat(d)}if(i){b=b.concat(i);c=c.concat(j)}return[b,c]},step:function(a, b,c,d){var e=[],f=a.length;if(c==1)e=d;else if(f==b.length&&c<1)for(;f--;){d=parseFloat(a[f]);e[f]=isNaN(d)?a[f]:c*parseFloat(b[f]-d)+d}else e=b;return e}};db={enabled:true,align:"center",x:0,y:15,style:{color:"#666",fontSize:"11px",lineHeight:"14px"}};Ra={colors:["#4572A7","#AA4643","#89A54E","#80699B","#3D96AE","#DB843D","#92A8CD","#A47D7C","#B5CA92"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June", "July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:true},chart:{borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:true,spacingTop:10,spacingRight:10,spacingBottom:15,spacingLeft:10,style:{fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif', fontSize:"12px"},backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0"},title:{text:"Chart title",align:"center",y:15,style:{color:"#3E576F",fontSize:"16px"}},subtitle:{text:"",align:"center",y:30,style:{color:"#6D869F"}},plotOptions:{line:{allowPointSelect:false,showCheckbox:false,animation:{duration:1E3},events:{},lineWidth:2,shadow:true,marker:{enabled:true,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:va(db, {enabled:false,y:-6,formatter:function(){return this.y}}),showInLegend:true,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:true}},labels:{style:{position:lc,color:"#3E576F"}},legend:{enabled:true,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,shadow:false,style:{padding:"5px"},itemStyle:{cursor:"pointer",color:"#3E576F"},itemHoverStyle:{cursor:"pointer",color:"#000000"},itemHiddenStyle:{color:"#C0C0C0"}, itemCheckboxStyle:{position:lc,width:"13px",height:"13px"},symbolWidth:16,symbolPadding:5,verticalAlign:"bottom",x:0,y:0},loading:{hideDuration:100,labelStyle:{fontWeight:"bold",position:Pd,top:"1em"},showDuration:100,style:{position:lc,backgroundColor:"white",opacity:0.5,textAlign:"center"}},tooltip:{enabled:true,backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:2,borderRadius:5,shadow:true,snap:Gb?25:10,style:{color:"#333333",fontSize:"12px",padding:"5px",whiteSpace:"nowrap"}},toolbar:{itemStyle:{color:"#4572A7", cursor:"pointer"}},credits:{enabled:true,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"10px"}}};var Lc={dateTimeLabelFormats:{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:false,gridLineColor:"#C0C0C0",labels:db,lineColor:"#C0D0E0",lineWidth:1,max:null,min:null,minPadding:0.01,maxPadding:0.01,minorGridLineColor:"#E0E0E0", minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:false,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#6D869F",fontWeight:"bold"}},type:"linear"},fd=va(Lc,{endOnTick:true,gridLineWidth:1,tickPixelInterval:72,showLastLabel:true,labels:{align:"right",x:-8,y:3},lineWidth:0,maxPadding:0.05,minPadding:0.05,startOnTick:true,tickWidth:0, title:{rotation:270,text:"Y-values"}}),Yd={labels:{align:"right",x:-8,y:null},title:{rotation:270}},Xd={labels:{align:"left",x:8,y:null},title:{rotation:90}},Ld={labels:{align:"center",x:0,y:14},title:{rotation:0}},Wd=va(Ld,{labels:{y:-5}}),vb=Ra.plotOptions;db=vb.line;vb.spline=va(db);vb.scatter=va(db,{lineWidth:0,states:{hover:{lineWidth:0}}});vb.area=va(db,{});vb.areaspline=va(vb.area);vb.column=va(db,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:0.2,marker:null,pointPadding:0.1, minPointLength:0,states:{hover:{brightness:0.1,shadow:false},select:{color:"#C0C0C0",borderColor:"#000000",shadow:false}}});vb.bar=va(vb.column,{dataLabels:{align:"left",x:5,y:0}});vb.pie=va(db,{borderColor:"#FFFFFF",borderWidth:1,center:["50%","50%"],colorByPoint:true,dataLabels:{distance:30,enabled:true,formatter:function(){return this.point.name},y:5},legendType:"point",marker:null,size:"75%",showInLegend:false,slicedOffset:10,states:{hover:{brightness:0.1,shadow:false}}});Bd();var Vb=function(a){var b= [],c;(function(d){if(c=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/.exec(d))b=[oa(c[1]),oa(c[2]),oa(c[3]),parseFloat(c[4],10)];else if(c=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(d))b=[oa(c[1],16),oa(c[2],16),oa(c[3],16),1]})(a);return{get:function(d){return b&&!isNaN(b[0])?d=="rgb"?"rgb("+b[0]+","+b[1]+","+b[2]+")":d=="a"?b[3]:"rgba("+b.join(",")+")":a},brighten:function(d){if(bc(d)&&d!==0){var e;for(e=0;e<3;e++){b[e]+=oa(d*255);if(b[e]< 0)b[e]=0;if(b[e]>255)b[e]=255}}return this},setOpacity:function(d){b[3]=d;return this}}};Mc=function(a,b,c){function d(E){return E.toString().replace(/^([0-9])$/,"0$1")}if(!L(b)||isNaN(b))return"Invalid date";a=y(a,"%Y-%m-%d %H:%M:%S");b=new Date(b*ob);var e=b[ad](),f=b[bd](),g=b[oc](),i=b[Dc](),j=b[Ec](),k=Ra.lang,n=k.weekdays;k=k.months;b={a:n[f].substr(0,3),A:n[f],d:d(g),e:g,b:k[i].substr(0,3),B:k[i],m:d(i+1),y:j.toString().substr(2,2),Y:j,H:d(e),I:d(e%12||12),l:e%12||12,M:d(b[$c]()),p:e<12?"AM": "PM",P:e<12?"am":"pm",S:d(b.getSeconds())};for(var z in b)a=a.replace("%"+z,b[z]);return c?a.substr(0,1).toUpperCase()+a.substr(1):a};Hc.prototype={init:function(a,b){this.element=ya.createElementNS("http://www.w3.org/2000/svg",b);this.renderer=a},animate:function(a,b,c){if(b=y(b,Bc,true)){b=va(b);if(c)b.complete=c;Xc(this,a,b)}else{this.attr(a);c&&c()}},attr:function(a,b){var c,d,e,f,g=this.element,i=g.nodeName,j=this.renderer,k,n=this.shadows,z,E=this;if(Ib(a)&&L(b)){c=a;a={};a[c]=b}if(Ib(a)){c= a;if(i=="circle")c={x:"cx",y:"cy"}[c]||c;else if(c=="strokeWidth")c="stroke-width";E=wa(g,c)||this[c]||0;if(c!="d"&&c!="visibility")E=parseFloat(E)}else for(c in a){k=false;d=a[c];if(c=="d"){if(d&&d.join)d=d.join(" ");if(/(NaN| {2}|^$)/.test(d))d="M 0 0";this.d=d}else if(c=="x"&&i=="text"){for(e=0;e<g.childNodes.length;e++){f=g.childNodes[e];wa(f,"x")==wa(g,"x")&&wa(f,"x",d)}if(this.rotation)wa(g,"transform","rotate("+this.rotation+" "+d+" "+oa(a.y||wa(g,"y"))+")")}else if(c=="fill")d=j.color(d,g, c);else if(i=="circle"&&(c=="x"||c=="y"))c={x:"cx",y:"cy"}[c]||c;else if(c=="translateX"||c=="translateY"||c=="rotation"||c=="verticalAlign"){this[c]=d;this.updateTransform();k=true}else if(c=="stroke")d=j.color(d,g,c);else if(c=="dashstyle"){c="stroke-dasharray";if(d){d=d.toLowerCase().replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/, "").split(",");for(e=d.length;e--;)d[e]=oa(d[e])*a["stroke-width"];d=d.join(",")}}else if(c=="isTracker")this[c]=d;else if(c=="width")d=oa(d);else if(c=="align"){c="text-anchor";d={left:"start",center:"middle",right:"end"}[d]}if(c=="strokeWidth")c="stroke-width";if(be&&c=="stroke-width"&&d===0)d=1.0E-6;if(this.symbolName&&/^(x|y|r|start|end|innerR)/.test(c)){if(!z){this.symbolAttr(a);z=true}k=true}if(n&&/^(width|height|visibility|x|y|d)$/.test(c))for(e=n.length;e--;)wa(n[e],c,d);if(c=="text"){this.textStr= d;j.buildText(this)}else k||wa(g,c,d)}return E},symbolAttr:function(a){this.x=y(a.x,this.x);this.y=y(a.y,this.y);this.r=y(a.r,this.r);this.start=y(a.start,this.start);this.end=y(a.end,this.end);this.width=y(a.width,this.width);this.height=y(a.height,this.height);this.innerR=y(a.innerR,this.innerR);this.attr({d:this.renderer.symbols[this.symbolName](this.x,this.y,this.r,{start:this.start,end:this.end,width:this.width,height:this.height,innerR:this.innerR})})},clip:function(a){return this.attr("clip-path", "url("+this.renderer.url+"#"+a.id+")")},css:function(a){var b=this.element;if(a&&a.color)a.fill=a.color;a=ma(this.styles,a);Ac&&!xc?La(this.element,a):this.attr({style:Vd(a)});this.styles=a;a.width&&b.nodeName=="text"&&this.added&&this.renderer.buildText(this);return this},on:function(a,b){var c=b;if(Gb&&a=="click"){a="touchstart";c=function(d){d.preventDefault();b()}}this.element["on"+a]=c;return this},translate:function(a,b){return this.attr({translateX:a,translateY:b})},invert:function(){this.inverted= true;this.updateTransform();return this},updateTransform:function(){var a=this.translateX||0,b=this.translateY||0,c=this.inverted,d=this.rotation,e=[];if(c){a+=this.attr("width");b+=this.attr("height")}if(a||b)e.push("translate("+a+","+b+")");if(c)e.push("rotate(90) scale(-1,1)");else d&&e.push("rotate("+d+" "+this.x+" "+this.y+")");e.length&&wa(this.element,"transform",e.join(" "))},toFront:function(){var a=this.element;a.parentNode.appendChild(a);return this},align:function(a,b,c){if(a){this.alignOptions= a;this.alignByTranslate=b;c||this.renderer.alignedObjects.push(this)}else{a=this.alignOptions;b=this.alignByTranslate}c=y(c,this.renderer);var d=a.align,e=a.verticalAlign,f=(c.x||0)+(a.x||0),g=(c.y||0)+(a.y||0),i={};if(/^(right|center)$/.test(d))f+=(c.width-(a.width||0))/{right:1,center:2}[d];i[b?"translateX":"x"]=f;if(/^(bottom|middle)$/.test(e))g+=(c.height-(a.height||0))/({bottom:1,middle:2}[e]||1);i[b?"translateY":"y"]=g;this[this.placed?"animate":"attr"](i);this.placed=true;return this},getBBox:function(){var a, b,c,d=this.rotation,e=d*Td;try{a=ma({},this.element.getBBox())}catch(f){a={width:0,height:0}}b=a.width;c=a.height;if(d){a.width=ab(c*yb(e))+ab(b*ub(e));a.height=ab(c*ub(e))+ab(b*yb(e))}return a},show:function(){return this.attr({visibility:Ab})},hide:function(){return this.attr({visibility:tb})},add:function(a){var b=this.renderer,c=a||b,d=c.element||b.box,e=d.childNodes,f=this.element,g=wa(f,"zIndex"),i=this.textStr,j;this.parentInverted=a&&a.inverted;if(g){c.handleZ=true;g=oa(g)}if(c.handleZ)for(j= 0;j<e.length;j++){a=e[j];c=wa(a,"zIndex");if(a!=f&&(oa(c)>g||!L(g)&&L(c))){d.insertBefore(f,a);return this}}if(i!==undefined){b.buildText(this);this.added=true}d.appendChild(f);return this},destroy:function(){var a=this.element||{},b=this.shadows,c=a.parentNode,d;a.onclick=a.onmouseout=a.onmouseover=a.onmousemove=null;Sc(this);c&&c.removeChild(a);b&&u(b,function(e){(c=e.parentNode)&&c.removeChild(e)});mc(this.renderer.alignedObjects,this);for(d in this)delete this[d];return null},empty:function(){for(var a= this.element,b=a.childNodes,c=b.length;c--;)a.removeChild(b[c])},shadow:function(a){var b=[],c,d=this.element,e=this.parentInverted?"(-1,-1)":"(1,1)";if(a){for(a=1;a<=3;a++){c=d.cloneNode(0);wa(c,{isShadow:"true",stroke:"rgb(0, 0, 0)","stroke-opacity":0.05*a,"stroke-width":7-2*a,transform:"translate"+e,fill:mb});d.parentNode.insertBefore(c,d);b.push(c)}this.shadows=b}return this}};var Uc=function(){this.init.apply(this,arguments)};Uc.prototype={init:function(a,b,c){var d=location,e;this.Element=Hc; e=this.createElement("svg").attr({xmlns:"http://www.w3.org/2000/svg",version:"1.1"});a.appendChild(e.element);this.box=e.element;this.boxWrapper=e;this.alignedObjects=[];this.url=Ac?"":d.href.replace(/#.*?$/,"");this.defs=this.createElement("defs").add();this.setSize(b,c,false)},createElement:function(a){var b=new this.Element;b.init(this,a);return b},buildText:function(a){var b=a.element,c=y(a.textStr,"").toString().replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g, "<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br[^>]?>/g),d=b.childNodes,e=/style="([^"]+)"/,f=/href="([^"]+)"/,g=wa(b,"x"),i=(a=a.styles)&&oa(a.width),j=a&&a.lineHeight,k;for(a=d.length;a--;)b.removeChild(d[a]);i&&this.box.appendChild(b);u(c,function(n,z){var E,ia=0,T;n=n.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||");E=n.split("|||");u(E,function(K){if(K!==""||E.length==1){var t={},A=ya.createElementNS("http://www.w3.org/2000/svg","tspan");e.test(K)&&wa(A,"style", K.match(e)[1].replace(/(;| |^)color([ :])/,"$1fill$2"));if(f.test(K)){wa(A,"onclick",'location.href="'+K.match(f)[1]+'"');La(A,{cursor:"pointer"})}K=K.replace(/<(.|\n)*?>/g,"")||" ";A.appendChild(ya.createTextNode(K));if(ia)t.dx=3;else t.x=g;if(!ia){if(z){T=oa(window.getComputedStyle(k,null).getPropertyValue("line-height"));if(isNaN(T))T=j||k.offsetHeight||18;wa(A,"dy",T)}k=A}wa(A,t);b.appendChild(A);ia++;if(i){K=K.replace(/-/g,"- ").split(" ");for(var ba,ea=[];K.length||ea.length;){ba=b.getBBox().width; t=ba>i;if(!t||K.length==1){K=ea;ea=[];A=ya.createElementNS("http://www.w3.org/2000/svg","tspan");wa(A,{x:g,dy:j||16});b.appendChild(A);if(ba>i)i=ba}else{A.removeChild(A.firstChild);ea.unshift(K.pop())}A.appendChild(ya.createTextNode(K.join(" ").replace(/- /g,"-")))}}}})})},crispLine:function(a,b){if(a[1]==a[4])a[1]=a[4]=V(a[1])+b%2/2;if(a[2]==a[5])a[2]=a[5]=V(a[2])+b%2/2;return a},path:function(a){return this.createElement("path").attr({d:a,fill:mb})},circle:function(a,b,c){a=Jb(a)?a:{x:a,y:b,r:c}; return this.createElement("circle").attr(a)},arc:function(a,b,c,d,e,f){if(Jb(a)){b=a.y;c=a.r;d=a.innerR;e=a.start;f=a.end;a=a.x}return this.symbol("arc",a||0,b||0,c||0,{innerR:d||0,start:e||0,end:f||0})},rect:function(a,b,c,d,e,f){if(arguments.length>1){var g=(f||0)%2/2;a=V(a||0)+g;b=V(b||0)+g;c=V((c||0)-2*g);d=V((d||0)-2*g)}g=Jb(a)?a:{x:a,y:b,width:Ga(c,0),height:Ga(d,0)};return this.createElement("rect").attr(ma(g,{rx:e||g.r,ry:e||g.r,fill:mb}))},setSize:function(a,b,c){var d=this.alignedObjects, e=d.length;this.width=a;this.height=b;for(this.boxWrapper[y(c,true)?"animate":"attr"]({width:a,height:b});e--;)d[e].align()},g:function(a){return this.createElement("g").attr(L(a)&&{"class":$b+a})},image:function(a,b,c,d,e){var f={preserveAspectRatio:mb};arguments.length>1&&ma(f,{x:b,y:c,width:d,height:e});f=this.createElement("image").attr(f);f.element.setAttributeNS("http://www.w3.org/1999/xlink","href",a);return f},symbol:function(a,b,c,d,e){var f,g=this.symbols[a];g=g&&g(b,c,d,e);var i=/^url\((.*?)\)$/; if(g){f=this.path(g);ma(f,{symbolName:a,x:b,y:c,r:d});e&&ma(f,e)}else if(i.test(a)){a=a.match(i)[1];f=this.image(a).attr({x:b,y:c});eb("img",{onload:function(){var j=ce[this.src]||[this.width,this.height];f.attr({width:j[0],height:j[1]}).translate(-V(j[0]/2),-V(j[1]/2))},src:a})}else f=this.circle(b,c,d);return f},symbols:{square:function(a,b,c){c=0.707*c;return[Wa,a-c,b-c,Aa,a+c,b-c,a+c,b+c,a-c,b+c,"Z"]},triangle:function(a,b,c){return[Wa,a,b-1.33*c,Aa,a+c,b+0.67*c,a-c,b+0.67*c,"Z"]},"triangle-down":function(a, b,c){return[Wa,a,b+1.33*c,Aa,a-c,b-0.67*c,a+c,b-0.67*c,"Z"]},diamond:function(a,b,c){return[Wa,a,b-c,Aa,a+c,b,a,b+c,a-c,b,"Z"]},arc:function(a,b,c,d){var e=d.start,f=d.end-1.0E-6,g=d.innerR,i=ub(e),j=yb(e),k=ub(f);f=yb(f);d=d.end-e<Ub?0:1;return[Wa,a+c*i,b+c*j,"A",c,c,0,d,1,a+c*k,b+c*f,Aa,a+g*k,b+g*f,"A",g,g,0,d,0,a+g*i,b+g*j,"Z"]}},clipRect:function(a,b,c,d){var e=$b+od++,f=this.createElement("clipPath").attr({id:e}).add(this.defs);a=this.rect(a,b,c,d,0).add(f);a.id=e;return a},color:function(a, b,c){var d,e=/^rgba/;if(a&&a.linearGradient){var f=this;b=a.linearGradient;c=$b+od++;var g,i,j;g=f.createElement("linearGradient").attr({id:c,gradientUnits:"userSpaceOnUse",x1:b[0],y1:b[1],x2:b[2],y2:b[3]}).add(f.defs);u(a.stops,function(k){if(e.test(k[1])){d=Vb(k[1]);i=d.get("rgb");j=d.get("a")}else{i=k[1];j=1}f.createElement("stop").attr({offset:k[0],"stop-color":i,"stop-opacity":j}).add(g)});return"url("+this.url+"#"+c+")"}else if(e.test(a)){d=Vb(a);wa(b,c+"-opacity",d.get("a"));return d.get("rgb")}else return a}, text:function(a,b,c){var d=Ra.chart.style;b=V(y(b,0));c=V(y(c,0));a=this.createElement("text").attr({x:b,y:c,text:a}).css({"font-family":d.fontFamily,"font-size":d.fontSize});a.x=b;a.y=c;return a}};var Ka;if(!xc){var fe=wb(Hc,{init:function(a,b){var c=["<",b,' filled="f" stroked="f"'],d=["position: ",lc,";"];if(b=="shape"||b==Lb)d.push("left:0;top:0;width:10px;height:10px;");if(yc)d.push("visibility: ",b==Lb?tb:Ab);c.push(' style="',d.join(""),'"/>');if(b){c=b==Lb||b=="span"||b=="img"?c.join(""): a.prepVML(c);this.element=eb(c)}this.renderer=a},add:function(a){var b=this.renderer,c=this.element,d=b.box;d=a?a.element||a:d;a&&a.inverted&&b.invertChild(c,d);yc&&d.gVis==tb&&La(c,{visibility:tb});d.appendChild(c);this.added=true;this.alignOnAdd&&this.updateTransform();return this},attr:function(a,b){var c,d,e,f=this.element||{},g=f.style,i=f.nodeName,j=this.renderer,k=this.symbolName,n,z,E=this.shadows,ia=this;if(Ib(a)&&L(b)){c=a;a={};a[c]=b}if(Ib(a)){c=a;ia=c=="strokeWidth"||c=="stroke-width"? this.strokeweight:this[c]}else for(c in a){d=a[c];n=false;if(k&&/^(x|y|r|start|end|width|height|innerR)/.test(c)){if(!z){this.symbolAttr(a);z=true}n=true}else if(c=="d"){d=d||[];this.d=d.join(" ");e=d.length;for(n=[];e--;)n[e]=bc(d[e])?V(d[e]*10)-5:d[e]=="Z"?"x":d[e];d=n.join(" ")||"x";f.path=d;if(E)for(e=E.length;e--;)E[e].path=d;n=true}else if(c=="zIndex"||c=="visibility"){if(yc&&c=="visibility"&&i=="DIV"){f.gVis=d;n=f.childNodes;for(e=n.length;e--;)La(n[e],{visibility:d});if(d==Ab)d=null}if(d)g[c]= d;n=true}else if(/^(width|height)$/.test(c)){if(this.updateClipping){this[c]=d;this.updateClipping()}else g[c]=d;n=true}else if(/^(x|y)$/.test(c)){this[c]=d;if(f.tagName=="SPAN")this.updateTransform();else g[{x:"left",y:"top"}[c]]=d}else if(c=="class")f.className=d;else if(c=="stroke"){d=j.color(d,f,c);c="strokecolor"}else if(c=="stroke-width"||c=="strokeWidth"){f.stroked=d?true:false;c="strokeweight";this[c]=d;if(bc(d))d+=Za}else if(c=="dashstyle"){(f.getElementsByTagName("stroke")[0]||eb(j.prepVML(["<stroke/>"]), null,null,f))[c]=d||"solid";this.dashstyle=d;n=true}else if(c=="fill")if(i=="SPAN")g.color=d;else{f.filled=d!=mb?true:false;d=j.color(d,f,c);c="fillcolor"}else if(c=="translateX"||c=="translateY"||c=="rotation"||c=="align"){if(c=="align")c="textAlign";this[c]=d;this.updateTransform();n=true}else if(c=="text"){f.innerHTML=d;n=true}if(E&&c=="visibility")for(e=E.length;e--;)E[e].style[c]=d;if(!n)if(yc)f[c]=d;else wa(f,c,d)}return ia},clip:function(a){var b=this,c=a.members;c.push(b);b.destroyClip=function(){mc(c, b)};return b.css(a.getCSS(b.inverted))},css:function(a){var b=this.element;(b=a&&a.width&&b.tagName=="SPAN")&&ma(a,{display:"block",whiteSpace:"normal"});this.styles=ma(this.styles,a);La(this.element,a);b&&this.updateTransform();return this},destroy:function(){this.destroyClip&&this.destroyClip();Hc.prototype.destroy.apply(this)},empty:function(){for(var a=this.element.childNodes,b=a.length,c;b--;){c=a[b];c.parentNode.removeChild(c)}},getBBox:function(){var a=this.element;if(a.nodeName=="text")a.style.position= lc;return{x:a.offsetLeft,y:a.offsetTop,width:a.offsetWidth,height:a.offsetHeight}},on:function(a,b){this.element["on"+a]=function(){var c=hb.event;c.target=c.srcElement;b(c)};return this},updateTransform:function(){if(this.added){var a=this,b=a.element,c=a.translateX||0,d=a.translateY||0,e=a.x||0,f=a.y||0,g=a.textAlign||"left",i={left:0,center:0.5,right:1}[g],j=g&&g!="left";if(c||d)a.css({marginLeft:c,marginTop:d});a.inverted&&u(b.childNodes,function(A){a.renderer.invertChild(A,b)});if(b.tagName== "SPAN"){var k,n;c=a.rotation;var z;k=0;d=1;var E=0,ia,T=a.xCorr||0,K=a.yCorr||0,t=[c,g,b.innerHTML,b.style.width].join(",");if(t!=a.cTT){if(L(c)){k=c*Td;d=ub(k);E=yb(k);La(b,{filter:c?["progid:DXImageTransform.Microsoft.Matrix(M11=",d,", M12=",-E,", M21=",E,", M22=",d,", sizingMethod='auto expand')"].join(""):mb})}k=b.offsetWidth;n=b.offsetHeight;z=V(oa(b.style.fontSize||12)*1.2);T=d<0&&-k;K=E<0&&-n;ia=d*E<0;T+=E*z*(ia?1-i:i);K-=d*z*(c?ia?i:1-i:1);if(j){T-=k*i*(d<0?-1:1);if(c)K-=n*i*(E<0?-1:1);La(b, {textAlign:g})}a.xCorr=T;a.yCorr=K}La(b,{left:e+T,top:f+K});a.cTT=t}}else this.alignOnAdd=true},shadow:function(a){var b=[],c=this.element,d=this.renderer,e,f=c.style,g,i=c.path;if(""+c.path==="")i="x";if(a){for(a=1;a<=3;a++){g=['<shape isShadow="true" strokeweight="',7-2*a,'" filled="false" path="',i,'" coordsize="100,100" style="',c.style.cssText,'" />'];e=eb(d.prepVML(g),null,{left:oa(f.left)+1,top:oa(f.top)+1});g=['<stroke color="black" opacity="',0.05*a,'"/>'];eb(d.prepVML(g),null,null,e);c.parentNode.insertBefore(e, c);b.push(e)}this.shadows=b}return this}});Ka=function(){this.init.apply(this,arguments)};Ka.prototype=va(Uc.prototype,{isIE8:wc.indexOf("MSIE 8.0")>-1,init:function(a,b,c){var d;this.Element=fe;this.alignedObjects=[];d=this.createElement(Lb);a.appendChild(d.element);this.box=d.element;this.boxWrapper=d;this.setSize(b,c,false);if(!ya.namespaces.hcv){ya.namespaces.add("hcv","urn:schemas-microsoft-com:vml");ya.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } "}}, clipRect:function(a,b,c,d){var e=this.createElement();return ma(e,{members:[],left:a,top:b,width:c,height:d,getCSS:function(f){var g=this.top,i=this.left,j=i+this.width,k=g+this.height;g={clip:"rect("+V(f?i:g)+"px,"+V(f?k:j)+"px,"+V(f?j:k)+"px,"+V(f?g:i)+"px)"};!f&&yc&&ma(g,{width:j+Za,height:k+Za});return g},updateClipping:function(){u(e.members,function(f){f.css(e.getCSS(f.inverted))})}})},color:function(a,b,c){var d,e=/^rgba/;if(a&&a.linearGradient){var f,g,i=a.linearGradient,j,k,n,z;u(a.stops, function(E,ia){if(e.test(E[1])){d=Vb(E[1]);f=d.get("rgb");g=d.get("a")}else{f=E[1];g=1}if(ia){n=f;z=g}else{j=f;k=g}});a=90-Ta.atan((i[3]-i[1])/(i[2]-i[0]))*180/Ub;c=["<",c,' colors="0% ',j,",100% ",n,'" angle="',a,'" opacity="',z,'" o:opacity2="',k,'" type="gradient" focus="100%" />'];eb(this.prepVML(c),null,null,b)}else if(e.test(a)&&b.tagName!="IMG"){d=Vb(a);c=["<",c,' opacity="',d.get("a"),'"/>'];eb(this.prepVML(c),null,null,b);return d.get("rgb")}else return a},prepVML:function(a){var b=this.isIE8; a=a.join("");if(b){a=a.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />');a=a.indexOf('style="')==-1?a.replace("/>",' style="display:inline-block;behavior:url(#default#VML);" />'):a.replace('style="','style="display:inline-block;behavior:url(#default#VML);')}else a=a.replace("<","<hcv:");return a},text:function(a,b,c){var d=Ra.chart.style;return this.createElement("span").attr({text:a,x:V(b),y:V(c)}).css({whiteSpace:"nowrap",fontFamily:d.fontFamily,fontSize:d.fontSize})},path:function(a){return this.createElement("shape").attr({coordsize:"100 100", d:a})},circle:function(a,b,c){return this.path(this.symbols.circle(a,b,c))},g:function(a){var b;if(a)b={className:$b+a,"class":$b+a};return this.createElement(Lb).attr(b)},image:function(a,b,c,d,e){var f=this.createElement("img").attr({src:a});arguments.length>1&&f.css({left:b,top:c,width:d,height:e});return f},rect:function(a,b,c,d,e,f){if(arguments.length>1){var g=(f||0)%2/2;a=V(a||0)+g;b=V(b||0)+g;c=V((c||0)-2*g);d=V((d||0)-2*g)}if(Jb(a)){b=a.y;c=a.width;d=a.height;e=a.r;a=a.x}return this.symbol("rect", a||0,b||0,e||0,{width:c||0,height:d||0})},invertChild:function(a,b){var c=b.style;La(a,{flip:"x",left:oa(c.width)-10,top:oa(c.height)-10,rotation:-90})},symbols:{arc:function(a,b,c,d){var e=d.start,f=d.end,g=ub(e),i=yb(e),j=ub(f),k=yb(f);d=d.innerR;if(f-e===0)return["x"];else if(f-e==2*Ub)j=-0.07/c;return["wa",a-c,b-c,a+c,b+c,a+c*g,b+c*i,a+c*j,b+c*k,"at",a-d,b-d,a+d,b+d,a+d*j,b+d*k,a+d*g,b+d*i,"x","e"]},circle:function(a,b,c){return["wa",a-c,b-c,a+c,b+c,a+c,b,a+c,b,"e"]},rect:function(a,b,c,d){var e= d.width;d=d.height;var f=a+e,g=b+d;c=nb(c,e,d);return[Wa,a+c,b,Aa,f-c,b,"wa",f-2*c,b,f,b+2*c,f-c,b,f,b+c,Aa,f,g-c,"wa",f-2*c,g-2*c,f,g,f,g-c,f-c,g,Aa,a+c,g,"wa",a,g-2*c,a+2*c,g,a+c,g,a,g-c,Aa,a,b+c,"wa",a,b,a+2*c,b+2*c,a,b+c,a+c,b,"x","e"]}}})}var Qd=xc?Uc:Ka;Hd.prototype.callbacks=[];var zc=function(){};zc.prototype={init:function(a,b){var c;this.series=a;this.applyOptions(b);this.pointAttr={};if(a.options.colorByPoint){c=a.chart.options.colors;if(!this.options)this.options={};this.color=this.options.color= this.color||c[Hb++];if(Hb>=c.length)Hb=0}a.chart.pointCount++;return this},applyOptions:function(a){var b=this.series;this.config=a;if(bc(a)||a===null)this.y=a;else if(Jb(a)&&!bc(a.length)){ma(this,a);this.options=a}else if(Ib(a[0])){this.name=a[0];this.y=a[1]}else if(bc(a[0])){this.x=a[0];this.y=a[1]}if(this.x===Qa)this.x=b.autoIncrement()},destroy:function(){var a=this,b=a.series,c;b.chart.pointCount--;a==b.chart.hoverPoint&&a.onMouseOut();b.chart.hoverPoints=null;Bb(a);u(["graphic","tracker","group", "dataLabel","connector"],function(d){a[d]&&a[d].destroy()});a.legendItem&&a.series.chart.legend.destroyItem(a);for(c in a)a[c]=null},select:function(a,b){var c=this,d=c.series.chart;c.selected=a=y(a,!c.selected);c.firePointEvent(a?"select":"unselect");c.setState(a&&"select");b||u(d.getSelectedPoints(),function(e){if(e.selected&&e!=c){e.selected=false;e.setState(cb);e.firePointEvent("unselect")}})},onMouseOver:function(){var a=this.series.chart,b=a.tooltip,c=a.hoverPoint;c&&c!=this&&c.onMouseOut(); this.firePointEvent("mouseOver");b&&!b.shared&&b.refresh(this);this.setState(xb);a.hoverPoint=this},onMouseOut:function(){this.firePointEvent("mouseOut");this.setState();this.series.chart.hoverPoint=null},tooltipFormatter:function(a){var b=this.series;return['<span style="color:'+b.color+'">',this.name||b.name,"</span>: ",!a?"<b>x = "+(this.name||this.x)+",</b> ":"","<b>",!a?"y = ":"",this.y,"</b><br/>"].join("")},update:function(a,b,c){var d=this,e=d.series,f=e.chart;Kb(c,f);b=y(b,true);d.firePointEvent("update", {options:a},function(){d.applyOptions(a);e.isDirty=true;b&&f.redraw()})},remove:function(a,b){var c=this,d=c.series,e=d.chart,f=d.data;Kb(b,e);a=y(a,true);c.firePointEvent("remove",null,function(){mc(f,c);c.destroy();d.isDirty=true;a&&e.redraw()})},firePointEvent:function(a,b,c){var d=this,e=this.series.options;if(e.point.events[a]||d.options&&d.options.events&&d.options.events[a])this.importEvents();if(a=="click"&&e.allowPointSelect)c=function(f){d.select(null,f.ctrlKey||f.metaKey||f.shiftKey)}; Ja(this,a,b,c)},importEvents:function(){if(!this.hasImportedEvents){var a=va(this.series.options.point,this.options).events,b;this.events=a;for(b in a)Pa(this,b,a[b]);this.hasImportedEvents=true}},setState:function(a){var b=this.series,c=b.options.states,d=vb[b.type].marker&&b.options.marker,e=d&&!d.enabled,f=(d=d&&d.states[a])&&d.enabled===false,g=b.stateMarkerGraphic,i=b.chart,j=this.pointAttr;a||(a=cb);if(!(a==this.state||this.selected&&a!="select"||c[a]&&c[a].enabled===false||a&&(f||e&&!d.enabled))){if(this.graphic)this.graphic.attr(j[a]); else{if(a){if(!g)b.stateMarkerGraphic=g=i.renderer.circle(0,0,j[a].r).attr(j[a]).add(b.group);g.translate(this.plotX,this.plotY)}if(g)g[a?"show":"hide"]()}this.state=a}}};var lb=function(){};lb.prototype={isCartesian:true,type:"line",pointClass:zc,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},init:function(a,b){var c,d;d=a.series.length;this.chart=a;b=this.setOptions(b);ma(this,{index:d,options:b,name:b.name||"Series "+(d+1),state:cb,pointAttr:{},visible:b.visible!== false,selected:b.selected===true});d=b.events;for(c in d)Pa(this,c,d[c]);if(d&&d.click||b.point&&b.point.events&&b.point.events.click||b.allowPointSelect)a.runTrackerClick=true;this.getColor();this.getSymbol();this.setData(b.data,false)},autoIncrement:function(){var a=this.options,b=this.xIncrement;b=y(b,a.pointStart,0);this.pointInterval=y(this.pointInterval,a.pointInterval,1);this.xIncrement=b+this.pointInterval;return b},cleanData:function(){var a=this.chart,b=this.data,c,d,e=a.smallestInterval, f,g;b.sort(function(i,j){return i.x-j.x});for(g=b.length-1;g>=0;g--)b[g-1]&&b[g-1].x==b[g].x&&b.splice(g-1,1);for(g=b.length-1;g>=0;g--)if(b[g-1]){f=b[g].x-b[g-1].x;if(d===Qa||f<d){d=f;c=g}}if(e===Qa||d<e)a.smallestInterval=d;this.closestPoints=c},getSegments:function(){var a=-1,b=[],c=this.data;u(c,function(d,e){if(d.y===null){e>a+1&&b.push(c.slice(a+1,e));a=e}else e==c.length-1&&b.push(c.slice(a+1,e+1))});this.segments=b},setOptions:function(a){var b=this.chart.options.plotOptions;return va(b[this.type], b.series,a)},getColor:function(){var a=this.chart.options.colors;this.color=this.options.color||a[Hb++]||"#0000ff";if(Hb>=a.length)Hb=0},getSymbol:function(){var a=this.chart.options.symbols;this.symbol=this.options.marker.symbol||a[Wc++];if(Wc>=a.length)Wc=0},addPoint:function(a,b,c,d){var e=this.data,f=this.graph,g=this.area,i=this.chart;a=(new this.pointClass).init(this,a);Kb(d,i);if(f&&c)f.shift=c;if(g){g.shift=c;g.isArea=true}b=y(b,true);e.push(a);c&&e[0].remove(false);this.isDirty=true;b&&i.redraw()}, setData:function(a,b){var c=this,d=c.data,e=c.initialColor,f=c.chart,g=d&&d.length||0;c.xIncrement=null;if(L(e))Hb=e;for(a=jc(nc(a||[]),function(i){return(new c.pointClass).init(c,i)});g--;)d[g].destroy();c.data=a;c.cleanData();c.getSegments();c.isDirty=true;f.isDirtyBox=true;y(b,true)&&f.redraw(false)},remove:function(a,b){var c=this,d=c.chart;a=y(a,true);if(!c.isRemoving){c.isRemoving=true;Ja(c,"remove",null,function(){c.destroy();d.isDirtyLegend=d.isDirtyBox=true;a&&d.redraw(b)})}c.isRemoving= false},translate:function(){for(var a=this.chart,b=this.options.stacking,c=this.xAxis.categories,d=this.yAxis,e=this.data,f=e.length;f--;){var g=e[f],i=g.x,j=g.y,k=g.low,n=d.stacks[(j<0?"-":"")+this.stackKey];g.plotX=this.xAxis.translate(i);if(b&&this.visible&&n[i]){k=n[i];i=k.total;k.cum=k=k.cum-j;j=k+j;if(b=="percent"){k=i?k*100/i:0;j=i?j*100/i:0}g.percentage=i?g.y*100/i:0;g.stackTotal=i}if(L(k))g.yBottom=d.translate(k,0,1);if(j!==null)g.plotY=d.translate(j,0,1);g.clientX=a.inverted?a.plotHeight- g.plotX:g.plotX;g.category=c&&c[g.x]!==Qa?c[g.x]:g.x}},setTooltipPoints:function(a){var b=this.chart,c=b.inverted,d=[],e=V((c?b.plotTop:b.plotLeft)+b.plotSizeX),f,g,i=[];if(a)this.tooltipPoints=null;u(this.segments,function(j){d=d.concat(j)});if(this.xAxis&&this.xAxis.reversed)d=d.reverse();u(d,function(j,k){f=d[k-1]?d[k-1].high+1:0;for(g=j.high=d[k+1]?Mb((j.plotX+(d[k+1]?d[k+1].plotX:e))/2):e;f<=g;)i[c?e-f++:f++]=j});this.tooltipPoints=i},onMouseOver:function(){var a=this.chart,b=a.hoverSeries;if(!(!Gb&& a.mouseIsDown)){b&&b!=this&&b.onMouseOut();this.options.events.mouseOver&&Ja(this,"mouseOver");this.tracker&&this.tracker.toFront();this.setState(xb);a.hoverSeries=this}},onMouseOut:function(){var a=this.options,b=this.chart,c=b.tooltip,d=b.hoverPoint;d&&d.onMouseOut();this&&a.events.mouseOut&&Ja(this,"mouseOut");c&&!a.stickyTracking&&c.hide();this.setState();b.hoverSeries=null},animate:function(a){var b=this.chart,c=this.clipRect,d=this.options.animation;if(d&&!Jb(d))d={};if(a){if(!c.isAnimating){c.attr("width", 0);c.isAnimating=true}}else{c.animate({width:b.plotSizeX},d);this.animate=null}},drawPoints:function(){var a,b=this.data,c=this.chart,d,e,f,g,i,j;if(this.options.marker.enabled)for(f=b.length;f--;){g=b[f];d=g.plotX;e=g.plotY;j=g.graphic;if(e!==Qa&&!isNaN(e)){a=g.pointAttr[g.selected?"select":cb];i=a.r;if(j)j.animate({x:d,y:e,r:i});else g.graphic=c.renderer.symbol(y(g.marker&&g.marker.symbol,this.symbol),d,e,i).attr(a).add(this.group)}}},convertAttribs:function(a,b,c,d){var e=this.pointAttrToOptions, f,g,i={};a=a||{};b=b||{};c=c||{};d=d||{};for(f in e){g=e[f];i[f]=y(a[g],b[f],c[f],d[f])}return i},getAttribs:function(){var a=this,b=vb[a.type].marker?a.options.marker:a.options,c=b.states,d=c[xb],e,f=a.color,g={stroke:f,fill:f},i=a.data,j=[],k,n=a.pointAttrToOptions;if(a.options.marker){d.radius=d.radius||b.radius+2;d.lineWidth=d.lineWidth||b.lineWidth+1}else d.color=d.color||Vb(d.color||f).brighten(d.brightness).get();j[cb]=a.convertAttribs(b,g);u([xb,"select"],function(E){j[E]=a.convertAttribs(c[E], j[cb])});a.pointAttr=j;for(f=i.length;f--;){g=i[f];if((b=g.options&&g.options.marker||g.options)&&b.enabled===false)b.radius=0;e=false;if(g.options)for(var z in n)if(L(b[n[z]]))e=true;if(e){k=[];c=b.states||{};e=c[xb]=c[xb]||{};if(!a.options.marker)e.color=Vb(e.color||g.options.color).brighten(e.brightness||d.brightness).get();k[cb]=a.convertAttribs(b,j[cb]);k[xb]=a.convertAttribs(c[xb],j[xb],k[cb]);k.select=a.convertAttribs(c.select,j.select,k[cb])}else k=j;g.pointAttr=k}},destroy:function(){var a= this,b=a.chart,c=/\/5[0-9\.]+ Safari\//.test(wc),d,e;Bb(a);a.legendItem&&a.chart.legend.destroyItem(a);u(a.data,function(f){f.destroy()});u(["area","graph","dataLabelsGroup","group","tracker"],function(f){if(a[f]){d=c&&f=="group"?"hide":"destroy";a[f][d]()}});if(b.hoverSeries==a)b.hoverSeries=null;mc(b.series,a);for(e in a)delete a[e]},drawDataLabels:function(){if(this.options.dataLabels.enabled){var a=this,b,c,d=a.data,e=a.options.dataLabels,f,g=a.dataLabelsGroup,i=a.chart,j=i.inverted,k=a.type, n;if(!g)g=a.dataLabelsGroup=i.renderer.g($b+"data-labels").attr({visibility:a.visible?Ab:tb,zIndex:5}).translate(i.plotLeft,i.plotTop).add();n=e.color;if(n=="auto")n=null;e.style.color=y(n,a.color);u(d,function(z){var E=z.barX;E=E&&E+z.barW/2||z.plotX||-999;var ia=y(z.plotY,-999),T=z.dataLabel,K=e.align;f=e.formatter.call({x:z.x,y:z.y,series:a,point:z,percentage:z.percentage,total:z.total||z.stackTotal});b=(j?i.plotWidth-ia:E)+e.x;c=(j?i.plotHeight-E:ia)+e.y;if(k=="column")b+={left:-1,right:1}[K]* z.barW/2||0;if(T)T.animate({x:b,y:c});else if(f)T=z.dataLabel=i.renderer.text(f,b,c).attr({align:K,rotation:e.rotation,zIndex:1}).css(e.style).add(g);j&&!e.y&&T.attr({y:c+parseInt(T.styles.lineHeight)*0.9-T.getBBox().height/2})})}},drawGraph:function(){var a=this,b=a.options,c=a.graph,d=[],e,f=a.area,g=a.group,i=b.lineColor||a.color,j=b.lineWidth,k=b.dashStyle,n,z=a.chart.renderer,E=a.yAxis.getThreshold(b.threshold||0),ia=/^area/.test(a.type),T=[],K=[];u(a.segments,function(t){n=[];u(t,function(Ca, xa){if(a.getPointSpline)n.push.apply(n,a.getPointSpline(t,Ca,xa));else{n.push(xa?Aa:Wa);xa&&b.step&&n.push(Ca.plotX,t[xa-1].plotY);n.push(Ca.plotX,Ca.plotY)}});if(t.length>1)d=d.concat(n);else T.push(t[0]);if(ia){var A=[],ba,ea=n.length;for(ba=0;ba<ea;ba++)A.push(n[ba]);ea==3&&A.push(Aa,n[1],n[2]);if(b.stacking&&a.type!="areaspline")for(ba=t.length-1;ba>=0;ba--)A.push(t[ba].plotX,t[ba].yBottom);else A.push(Aa,t[t.length-1].plotX,E,Aa,t[0].plotX,E);K=K.concat(A)}});a.graphPath=d;a.singlePoints=T;if(ia){e= y(b.fillColor,Vb(a.color).setOpacity(b.fillOpacity||0.75).get());if(f)f.animate({d:K});else a.area=a.chart.renderer.path(K).attr({fill:e}).add(g)}if(c)c.animate({d:d});else if(j){c={stroke:i,"stroke-width":j};if(k)c.dashstyle=k;a.graph=z.path(d).attr(c).add(g).shadow(b.shadow)}},render:function(){var a=this,b=a.chart,c,d,e=a.options,f=e.animation,g=f&&a.animate;f=g?f&&f.duration||500:0;var i=a.clipRect;d=b.renderer;if(!i){i=a.clipRect=!b.hasRendered&&b.clipRect?b.clipRect:d.clipRect(0,0,b.plotSizeX, b.plotSizeY);if(!b.clipRect)b.clipRect=i}if(!a.group){c=a.group=d.g("series");if(b.inverted){d=function(){c.attr({width:b.plotWidth,height:b.plotHeight}).invert()};d();Pa(b,"resize",d)}c.clip(a.clipRect).attr({visibility:a.visible?Ab:tb,zIndex:e.zIndex}).translate(b.plotLeft,b.plotTop).add(b.seriesGroup)}a.drawDataLabels();g&&a.animate(true);a.getAttribs();a.drawGraph&&a.drawGraph();a.drawPoints();a.options.enableMouseTracking!==false&&a.drawTracker();g&&a.animate();setTimeout(function(){i.isAnimating= false;if((c=a.group)&&i!=b.clipRect&&i.renderer){c.clip(a.clipRect=b.clipRect);i.destroy()}},f);a.isDirty=false},redraw:function(){var a=this.chart,b=this.group;if(b){a.inverted&&b.attr({width:a.plotWidth,height:a.plotHeight});b.animate({translateX:a.plotLeft,translateY:a.plotTop})}this.translate();this.setTooltipPoints(true);this.render()},setState:function(a){var b=this.options,c=this.graph,d=b.states;b=b.lineWidth;a=a||cb;if(this.state!=a){this.state=a;if(!(d[a]&&d[a].enabled===false)){if(a)b= d[a].lineWidth||b+1;if(c&&!c.dashstyle)c.attr({"stroke-width":b},a?0:500)}}},setVisible:function(a,b){var c=this.chart,d=this.legendItem,e=this.group,f=this.tracker,g=this.dataLabelsGroup,i,j=this.data,k=c.options.chart.ignoreHiddenSeries;i=this.visible;i=(this.visible=a=a===Qa?!i:a)?"show":"hide";e&&e[i]();if(f)f[i]();else for(e=j.length;e--;){f=j[e];f.tracker&&f.tracker[i]()}g&&g[i]();d&&c.legend.colorizeItem(this,a);this.isDirty=true;this.options.stacking&&u(c.series,function(n){if(n.options.stacking&& n.visible)n.isDirty=true});if(k)c.isDirtyBox=true;b!==false&&c.redraw();Ja(this,i)},show:function(){this.setVisible(true)},hide:function(){this.setVisible(false)},select:function(a){this.selected=a=a===Qa?!this.selected:a;if(this.checkbox)this.checkbox.checked=a;Ja(this,a?"select":"unselect")},drawTracker:function(){var a=this,b=a.options,c=[].concat(a.graphPath),d=c.length,e=a.chart,f=e.options.tooltip.snap,g=a.tracker,i=b.cursor;i=i&&{cursor:i};var j=a.singlePoints,k;if(d)for(k=d+1;k--;){c[k]== Wa&&c.splice(k+1,0,c[k+1]-f,c[k+2],Aa);if(k&&c[k]==Wa||k==d)c.splice(k,0,Aa,c[k-2]+f,c[k-1])}for(k=0;k<j.length;k++){d=j[k];c.push(Wa,d.plotX-f,d.plotY,Aa,d.plotX+f,d.plotY)}if(g)g.attr({d:c});else a.tracker=e.renderer.path(c).attr({isTracker:true,stroke:Ud,fill:mb,"stroke-width":b.lineWidth+2*f,visibility:a.visible?Ab:tb,zIndex:1}).on(Gb?"touchstart":"mouseover",function(){e.hoverSeries!=a&&a.onMouseOver()}).on("mouseout",function(){b.stickyTracking||a.onMouseOut()}).css(i).add(e.trackerGroup)}}; Ka=wb(lb);sb.line=Ka;Ka=wb(lb,{type:"area"});sb.area=Ka;Ka=wb(lb,{type:"spline",getPointSpline:function(a,b,c){var d=b.plotX,e=b.plotY,f=a[c-1],g=a[c+1],i,j,k,n;if(c&&c<a.length-1){a=f.plotY;k=g.plotX;g=g.plotY;var z;i=(1.5*d+f.plotX)/2.5;j=(1.5*e+a)/2.5;k=(1.5*d+k)/2.5;n=(1.5*e+g)/2.5;z=(n-j)*(k-d)/(k-i)+e-n;j+=z;n+=z;if(j>a&&j>e){j=Ga(a,e);n=2*e-j}else if(j<a&&j<e){j=nb(a,e);n=2*e-j}if(n>g&&n>e){n=Ga(g,e);j=2*e-n}else if(n<g&&n<e){n=nb(g,e);j=2*e-n}b.rightContX=k;b.rightContY=n}if(c){b=["C",f.rightContX|| f.plotX,f.rightContY||f.plotY,i||d,j||e,d,e];f.rightContX=f.rightContY=null}else b=[Wa,d,e];return b}});sb.spline=Ka;Ka=wb(Ka,{type:"areaspline"});sb.areaspline=Ka;var Zc=wb(lb,{type:"column",pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},init:function(){lb.prototype.init.apply(this,arguments);var a=this,b=a.chart;b.hasColumn=true;b.hasRendered&&u(b.series,function(c){if(c.type==a.type)c.isDirty=true})},translate:function(){var a=this,b=a.chart, c=0,d=a.xAxis.reversed,e=a.xAxis.categories,f={},g,i;lb.prototype.translate.apply(a);u(b.series,function(A){if(A.type==a.type){if(A.options.stacking){g=A.stackKey;if(f[g]===Qa)f[g]=c++;i=f[g]}else i=c++;A.columnIndex=i}});var j=a.options,k=a.data,n=a.closestPoints;b=ab(k[1]?k[n].plotX-k[n-1].plotX:b.plotSizeX/(e?e.length:1));e=b*j.groupPadding;n=(b-2*e)/c;var z=j.pointWidth,E=L(z)?(n-z)/2:n*j.pointPadding,ia=y(z,n-2*E),T=E+(e+((d?c-a.columnIndex:a.columnIndex)||0)*n-b/2)*(d?-1:1),K=a.yAxis.getThreshold(j.threshold|| 0),t=y(j.minPointLength,5);u(k,function(A){var ba=A.plotY,ea=A.yBottom||K,Ca=A.plotX+T,xa=dd(nb(ba,ea)),$a=dd(Ga(ba,ea)-xa),jb;if(ab($a)<t){if(t){$a=t;xa=ab(xa-K)>t?ea-t:K-(ba<=K?t:0)}jb=xa-3}ma(A,{barX:Ca,barY:xa,barW:ia,barH:$a});A.shapeType="rect";A.shapeArgs={x:Ca,y:xa,width:ia,height:$a,r:j.borderRadius};A.trackerArgs=L(jb)&&va(A.shapeArgs,{height:Ga(6,$a+3),y:jb})})},getSymbol:function(){},drawGraph:function(){},drawPoints:function(){var a=this,b=a.options,c=a.chart.renderer,d,e;u(a.data,function(f){var g= f.plotY;if(g!==Qa&&!isNaN(g)){d=f.graphic;e=f.shapeArgs;if(d){Sc(d);d.animate(e)}else f.graphic=c[f.shapeType](e).attr(f.pointAttr[f.selected?"select":cb]).add(a.group).shadow(b.shadow)}})},drawTracker:function(){var a=this,b=a.chart,c=b.renderer,d,e,f=+new Date,g=a.options.cursor,i=g&&{cursor:g},j;u(a.data,function(k){e=k.tracker;d=k.trackerArgs||k.shapeArgs;if(k.y!==null)if(e)e.attr(d);else k.tracker=c[k.shapeType](d).attr({isTracker:f,fill:Ud,visibility:a.visible?Ab:tb,zIndex:1}).on(Gb?"touchstart": "mouseover",function(n){j=n.relatedTarget||n.fromElement;b.hoverSeries!=a&&wa(j,"isTracker")!=f&&a.onMouseOver();k.onMouseOver()}).on("mouseout",function(n){if(!a.options.stickyTracking){j=n.relatedTarget||n.toElement;wa(j,"isTracker")!=f&&a.onMouseOut()}}).css(i).add(b.trackerGroup)})},animate:function(a){var b=this,c=b.data;if(!a){u(c,function(d){var e=d.graphic;if(e){e.attr({height:0,y:b.yAxis.translate(0,0,1)});e.animate({height:d.barH,y:d.barY},b.options.animation)}});b.animate=null}},remove:function(){var a= this,b=a.chart;b.hasRendered&&u(b.series,function(c){if(c.type==a.type)c.isDirty=true});lb.prototype.remove.apply(a,arguments)}});sb.column=Zc;Ka=wb(Zc,{type:"bar",init:function(a){a.inverted=this.inverted=true;Zc.prototype.init.apply(this,arguments)}});sb.bar=Ka;Ka=wb(lb,{type:"scatter",translate:function(){var a=this;lb.prototype.translate.apply(a);u(a.data,function(b){b.shapeType="circle";b.shapeArgs={x:b.plotX,y:b.plotY,r:a.chart.options.tooltip.snap}})},drawTracker:function(){var a=this,b=a.options.cursor, c=b&&{cursor:b},d;u(a.data,function(e){(d=e.graphic)&&d.attr({isTracker:true}).on("mouseover",function(){a.onMouseOver();e.onMouseOver()}).on("mouseout",function(){a.options.stickyTracking||a.onMouseOut()}).css(c)})},cleanData:function(){}});sb.scatter=Ka;Ka=wb(zc,{init:function(){zc.prototype.init.apply(this,arguments);var a=this,b;ma(a,{visible:a.visible!==false,name:y(a.name,"Slice")});b=function(){a.slice()};Pa(a,"select",b);Pa(a,"unselect",b);return a},setVisible:function(a){var b=this.series.chart, c=this.tracker,d=this.dataLabel,e=this.connector,f;f=(this.visible=a=a===Qa?!this.visible:a)?"show":"hide";this.group[f]();c&&c[f]();d&&d[f]();e&&e[f]();this.legendItem&&b.legend.colorizeItem(this,a)},slice:function(a,b,c){var d=this.series.chart,e=this.slicedTranslation;Kb(c,d);y(b,true);a=this.sliced=L(a)?a:!this.sliced;this.group.animate({translateX:a?e[0]:d.plotLeft,translateY:a?e[1]:d.plotTop})}});Ka=wb(lb,{type:"pie",isCartesian:false,pointClass:Ka,pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth", fill:"color"},getColor:function(){this.initialColor=Hb},animate:function(){var a=this;u(a.data,function(b){var c=b.graphic;b=b.shapeArgs;var d=-Ub/2;if(c){c.attr({r:0,start:d,end:d});c.animate({r:b.r,start:b.start,end:b.end},a.options.animation)}});a.animate=null},translate:function(){var a=0,b=-0.25,c=this.options,d=c.slicedOffset,e=d+c.borderWidth,f=c.center,g=this.chart,i=g.plotWidth,j=g.plotHeight,k,n,z,E=this.data,ia=2*Ub,T,K=nb(i,j),t,A,ba=c.dataLabels.distance;f.push(c.size,c.innerSize||0); f=jc(f,function(ea,Ca){return/%$/.test(ea)?[i,j,K,K][Ca]*oa(ea)/100:ea});this.getX=function(ea,Ca){z=Ta.asin((ea-f[1])/(f[2]/2+ba));return f[0]+(Ca?-1:1)*ub(z)*(f[2]/2+ba)};this.center=f;u(E,function(ea){a+=ea.y});u(E,function(ea){T=a?ea.y/a:0;k=V(b*ia*1E3)/1E3;b+=T;n=V(b*ia*1E3)/1E3;ea.shapeType="arc";ea.shapeArgs={x:f[0],y:f[1],r:f[2]/2,innerR:f[3]/2,start:k,end:n};z=(n+k)/2;ea.slicedTranslation=jc([ub(z)*d+g.plotLeft,yb(z)*d+g.plotTop],V);t=ub(z)*f[2]/2;A=yb(z)*f[2]/2;ea.tooltipPos=[f[0]+t*0.7, f[1]+A*0.7];ea.labelPos=[f[0]+t+ub(z)*ba,f[1]+A+yb(z)*ba,f[0]+t+ub(z)*e,f[1]+A+yb(z)*e,f[0]+t,f[1]+A,ba<0?"center":z<ia/4?"left":"right",z];ea.percentage=T*100;ea.total=a});this.setTooltipPoints()},render:function(){this.getAttribs();this.drawPoints();this.options.enableMouseTracking!==false&&this.drawTracker();this.drawDataLabels();this.options.animation&&this.animate&&this.animate();this.isDirty=false},drawPoints:function(){var a=this.chart,b=a.renderer,c,d,e,f;u(this.data,function(g){d=g.graphic; f=g.shapeArgs;e=g.group;if(!e)e=g.group=b.g("point").attr({zIndex:5}).add();c=g.sliced?g.slicedTranslation:[a.plotLeft,a.plotTop];e.translate(c[0],c[1]);if(d)d.animate(f);else g.graphic=b.arc(f).attr(ma(g.pointAttr[cb],{"stroke-linejoin":"round"})).add(g.group);g.visible===false&&g.setVisible(false)})},drawDataLabels:function(){var a=this.data,b,c=this.chart,d=this.options.dataLabels,e=y(d.connectorPadding,10),f=y(d.connectorWidth,1),g,i,j=d.distance>0,k,n,z=this.center[1],E=[[],[],[],[]],ia,T,K, t,A,ba,ea,Ca=4,xa;lb.prototype.drawDataLabels.apply(this);u(a,function($a){var jb=$a.labelPos[7];E[jb<0?0:jb<Ub/2?1:jb<Ub?2:3].push($a)});E[1].reverse();E[3].reverse();for(ea=function($a,jb){return $a.y>jb.y};Ca--;){a=0;b=[].concat(E[Ca]);b.sort(ea);for(xa=b.length;xa--;)b[xa].rank=xa;for(t=0;t<2;t++){n=(ba=Ca%3)?9999:-9999;A=ba?-1:1;for(xa=0;xa<E[Ca].length;xa++){b=E[Ca][xa];if(g=b.dataLabel){i=b.labelPos;K=Ab;ia=i[0];T=i[1];k||(k=g&&g.getBBox().height);if(j)if(t&&b.rank<a)K=tb;else if(!ba&&T<n+ k||ba&&T>n-k){T=n+A*k;ia=this.getX(T,Ca>1);if(!ba&&T+k>z||ba&&T-k<z)if(t)K=tb;else a++}if(b.visible===false)K=tb;if(K==Ab)n=T;if(t){g.attr({visibility:K,align:i[6]})[g.moved?"animate":"attr"]({x:ia+d.x+({left:e,right:-e}[i[6]]||0),y:T+d.y});g.moved=true;if(j&&f){g=b.connector;i=[Wa,ia+(i[6]=="left"?5:-5),T,Aa,ia,T,Aa,i[2],i[3],Aa,i[4],i[5]];if(g){g.animate({d:i});g.attr("visibility",K)}else b.connector=g=this.chart.renderer.path(i).attr({"stroke-width":f,stroke:d.connectorColor||"#606060",visibility:K, zIndex:3}).translate(c.plotLeft,c.plotTop).add()}}}}}}},drawTracker:Zc.prototype.drawTracker,getSymbol:function(){}});sb.pie=Ka;hb.Highcharts={Chart:Hd,dateFormat:Mc,pathAnim:Yc,getOptions:function(){return Ra},numberFormat:Gd,Point:zc,Color:Vb,Renderer:Qd,seriesTypes:sb,setOptions:function(a){Ra=va(Ra,a);Bd();return Ra},Series:lb,addEvent:Pa,createElement:eb,discardElement:Fc,css:La,each:u,extend:ma,map:jc,merge:va,pick:y,extendClass:wb,version:"2.1.2"}})();

// treeio.js
var treeio={put_mce:function(a){(a?$("textarea",a):$("textarea")).each(function(){$(this).hasClass("no-editor")||($(this).attr("id",a.attr("id")+"-"+$(this).attr("id")),$(this).hasClass("full-editor")?$(this).tinymce({script_url:"/static/js/tinymce/jscripts/tiny_mce/tiny_mce.js",theme:"advanced",skin:"cirkuit",relative_urls:false,plugins:"safari,table,advhr,inlinepopups,insertdatetime,preview,searchreplace,contextmenu,paste,fullscreen,nonbreaking,visualchars,xhtmlxtras",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,formatselect,fontselect,fontsizeselect,|,cut,copy,paste,pastetext,pasteword,|,search,replace", theme_advanced_buttons2:"bullist,numlist,|,outdent,indent,blockquote,|,undo,redo,|,link,unlink,image,cleanup,code,|,insertdate,inserttime,preview,|,forecolor,backcolor,|,cite,abbr,acronym,del,ins",theme_advanced_buttons3:"tablecontrols,|,hr,removeformat,|,sub,sup,|,visualchars,nonbreaking,charmap,advhr,|,fullscreen",theme_advanced_disable:"help,styleselect,anchor,newdocument",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:true, theme_advanced_resize_horizontal:true,theme_advanced_resizing_use_cookie:true,theme_advanced_path:false,width:"70%"}):$(this).tinymce({script_url:"/static/js/tinymce/jscripts/tiny_mce/tiny_mce.js",theme:"advanced",skin:"cirkuit",relative_urls:false,plugins:"safari,table,advhr,inlinepopups,insertdatetime,preview,searchreplace,contextmenu,paste,fullscreen,nonbreaking,visualchars,xhtmlxtras",theme_advanced_statusbar_location:"bottom",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left", theme_advanced_path:false,theme_advanced_resizing:true,theme_advanced_resize_horizontal:true,theme_advanced_resizing_use_cookie:true,theme_advanced_disable:"justifyleft,justifycenter,justifyright,justifyfull,outdent,indent,image,help,hr,removeformat,formatselect,fontselect,fontsizeselect,styleselect,sub,sup,forecolor,backcolor,forecolorpicker,backcolorpicker,charmap,visualaid,anchor,newdocument,blockquote",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,undo,redo,|,cut,copy,paste,link,unlink,cleanup,|,bullist,numlist,|,code", theme_advanced_buttons2:"",theme_advanced_buttons3:"",width:"70%"}))})},remove_mce:function(a){(a?$("textarea",a):$("textarea")).each(function(){tinyMCE.execCommand("mceRemoveControl",false,$(this).attr("id"))})},do_ajax:function(){var a=window.location.hash.replace(/#/gi,"");if(!a)a=window.location.pathname;var c=$('.menu-item a[href="#'+a+'"]');if(c.length&&!c.hasClass("active")&&(block=$("#module-"+c.attr("id").substring(5)),block.length))$(".module-block").each(function(){$(this).attr("id")!= block.attr("id")?($(this).css("display","none"),$(this).data("active",false)):(block.css("display","block"),block.data("active",true))}),document.title=block.data("title"),$(".menu-item a").each(function(){$(this).removeClass("active")}),c.addClass("active"),a="";a&&(a=treeio.prepare_url(a),$("#loading-status").css("display","block"),$("#loading-status-text").html("Loading..."),$.ajax({url:a,dataType:"json",success:treeio.process_ajax,complete:treeio.process_html,error:treeio.show_error}))}, show_error:function(){$("#loading-status-text").html("Something went wrong...")},process_userblock:function(a){a.response.messages&&$("#userblock-messages").each(function(){$(this).html(a.response.messages)})},process_ajax:function(a){if(a)if(a.popup)treeio.process_popup_data(a);else if(a.redirect)window.location.hash=="#"+a.redirect?treeio.do_ajax():window.location.hash=a.redirect;else if(a.redirect_out)window.location=a.redirect_out;else{if(a.response.url){var c=a.response.url.replace(".ajax", ""),b=window.location.hash.replace("#","");if(c!=b&&c.indexOf(b)==-1&&b.indexOf(c)==-1){$("#loading-status").css("display","none");return}}document.title=a.response.content.title;var c=a.response.content.module_content,b=a.response.modules.active,d="none";if($("#module-"+b).length==0)$("#content").append('<div class="module-block" id="module-'+b+'"></div>');else{var e=$("td.module-sidebar-right",$("#module-"+b));e&&(d=e.css("display"))}var f=$("#module-"+b);$(".module-block").each(function(){$(this).attr("id")!= f.attr("id")?($(this).css("display","none"),$(this).data("active",false)):(f.css("display","block"),f.data("active",true))});treeio.remove_mce($("#module-"+b+" form"));$("#module-"+b).html(c);$("#module-"+b+" form").length&&(treeio.prepare_forms(f),treeio.prepare_comments(f),$("#module-"+b+" textarea").length&&treeio.put_mce(f));treeio.prepare_tags(f);treeio.prepare_list_actions(f);treeio.prepare_attachments(f);treeio.prepare_invites(f);treeio.prepare_popups(f);treeio.convert_links(f); treeio.prepare_ajax_links(f);treeio.prepare_slider_sidebar(f,d);treeio.showhidejs(f);treeio.prepare_module_stuff(b);treeio.process_notifications(a.response.notifications);$(".menu-item a").each(function(){$(this).removeClass("active")});treeio.process_userblock(a);$("#menu-"+b).addClass("active");$(f).data("title",a.response.content.title);$("#loading-splash").css("display")!="none"&&$("#loading-splash").fadeOut();$("#loading-status").css("display","none")}},process_notifications:function(a){for(var c in a){var b= {title:" ",text:a[c].message,image:"/static/notifications/"+a[c].tags+".png"};if(a[c].title)b.title=a[c].title;if(a[c].image)b.image=a[c].image;$.gritter.add(b)}},process_html:function(a,c){c=="parsererror"&&window.document.write(a.responseText)},prepare_module_stuff:function(a){try{treeio.modules[a].init()}catch(c){}},prepare_url:function(a){if(a.indexOf("!")!=-1||a.indexOf("?")!=-1)a=a.replace("!","?"),a.indexOf(".ajax")==-1&&(a=a.replace("?",".ajax?"));a.indexOf(".ajax")==-1&&(a+=".ajax?");return a}, showhidejs:function(a){if(a)var c=$("div.showjs",a),a=$("div.hidejs",a);else c=$("div.showjs"),a=$("div.hidejs");c.each(function(){$(this).css("display","block")});a.each(function(){$(this).css("display","none")})},convert_links:function(a){(a?$("a",a):$("a")).each(function(){if($(this).attr("href")&&!$(this).hasClass("ajax-link-out")&&!$(this).hasClass("ajax-link")&&!$(this).attr("target")&&$(this).attr("href").substring(0,3)!="www"&&$(this).attr("href").substring(0,5)!="http:"&&$(this).attr("href").substring(0, 6)!="https:"&&$(this).attr("href").substring(0,4)!="ftp:"&&$(this).attr("href").substring(0,7)!="mailto:"&&$(this).attr("href").indexOf("#")==-1&&($(this).attr("href","#"+$(this).attr("href").replace("?","!")),$.browser.msie&&$.browser.version.substr(0,1)<7)){var a=window.location.href.replace(window.location.hash,"");$(this).attr("href",$(this).attr("href").replace(a,""))}})},add_data:function(a){var c=$(a.target);a.inner?c.html(a.content):a.append?c.append(a.content):(a=$(a.content),c.replaceWith(a), c=a);$("form",c).length&&(treeio.prepare_forms(c),treeio.prepare_comments(c),$("textarea",c).length&&treeio.put_mce(c));treeio.prepare_tags(c);treeio.prepare_list_actions(c);treeio.prepare_attachments(c);treeio.prepare_invites(c);treeio.prepare_popups(c);treeio.convert_links(c);treeio.prepare_ajax_links(c);treeio.showhidejs(c);$("#loading-status").css("display","none")},prepare_ajax_links:function(a){(a?$(".ajax-link",a):$(".ajax-link")).each(function(){$(this).click(function(){var a= $(this).parents($(this).attr("target")),b=treeio.utils.generate_id();a.attr("id",b);$(this).attr("target","#"+b);var a=eval($(this).attr("callback")),d=eval("("+$(this).attr("args")+")"),b=d?$.extend({target:"#"+b},d):{target:"#"+b};$("#loading-status").css("display","block");$("#loading-status-text").html("Loading...");a(Dajax.process,b);return false})})},prepare_slider_sidebar:function(a,c){a||(a=$(".module-block"));var b=$("<div></div>").addClass("sidebar-slider");$("td.module-content-inner", a).prepend(b);b.data("sidebar",$("td.module-sidebar-right",a));b.click(function(){var a=$(this).data("sidebar");a&&(a.css("display")=="none"?a.fadeIn():a.fadeOut())});var d=$("td.module-sidebar-right",a);($("a.projects-action",d).length!=0||$("a.services-action",d).length!=0)&&b.append('<img src="/static/icons/sidebar/status.gif"/><br />');$("form.content-filter-form",d).length!=0&&b.append('<img src="/static/icons/sidebar/filter.gif"/><br />');$("div.permission-links",d).length!=0&&b.append('<img src="/static/icons/sidebar/permission.gif"/><br />'); $("div.object-links",d).length!=0&&b.append('<img src="/static/icons/sidebar/link.gif"/><br />');$("div.subscription-users",d).length!=0&&b.append('<img src="/static/icons/sidebar/subscribe.gif"/><br />');$("a.pdf-block-link",d).length!=0&&b.append('<img src="/static/icons/sidebar/export.gif"/><br />');c?d.css("display",c):(d.css("display","none"),b.css({visibility:"hidden"}))},prepare_list_actions:function(a){$(".content-list-item",a).each(function(){$("span.content-list-item-actions",$(this)).css("visibility", "hidden");$(this).mouseover(function(){$("span.content-list-item-actions",$(this)).css("visibility","visible")}).mouseout(function(){$("span.content-list-item-actions",$(this)).css("visibility","hidden")});$("span.content-list-item-actions a",$(this)).addClass("popup-link")})},put_datepicker:function(a){$("input.datepicker",a).each(function(){var a={},b=$(this).attr("initial");if(b)b=parseInt(b)*1E3,a.defaultDate=new Date(b);$(this).datepicker(a)});$("input.datetimepicker",a).each(function(){var a= {stepMinute:5,hour:12,minute:0,firstDay:1},b=$(this).attr("initial");if(b)b=parseInt(b)*1E3,b=new Date(b),a.defaultDate=b,a.hour=b.getHours(),a.minute=b.getMinutes(),a.second=b.getSeconds();$(this).datetimepicker(a)})},prepare_mass_form:function(a){$("input[type=checkbox].group-control",a).each(function(){$(this).data("form",$("ul.mass-form",a));$(this).click(function(){$("input[type=checkbox].group-"+$(this).attr("name")).attr("checked",$(this).attr("checked"));$(this).data("form").fadeTo("fast", 1)})});$("ul.mass-form input[type=submit]",a).remove();$("ul.mass-form",a).each(function(){$(this).css("opacity",0.6)});$(".content-list-item input[type=checkbox], #sales_table, #reports_table",a).each(function(){$(this).data("form",$("ul.mass-form",a));$(this).click(function(){$(this).data("form").fadeTo("fast",1)})});$(".mass-form select",a).each(function(){$(this).css("opacity",0);$(this).change(function(){var a=$("span.wrap-value",$(this).parent()),b=$(this).children("option:selected");!b.val()== ""&&(a.text(b.text()),b.val()=="delete"||b.val()=="delete_all"?confirm("Really delete?\n\n(This cannot be undone)")&&$(this).parent().submit():$(this).parent().submit())})});$(".mass-form label",a).each(function(){$(this).next("select").andSelf().wrapAll('<div class="wrap-class" />');$(this).replaceWith('<span class="wrap-label">'+$(this).text()+'&nbsp;<span class="wrap-value"></span></span>')})},prepare_filter_form:function(a){$("form.content-filter-form input",a).live("change",function(){$(this).parents("form.content-filter-form").submit()}); $("form.content-filter-form select",a).live("change",function(){$(this).parents("form.content-filter-form").submit()});$("form.content-filter-form :submit").hide()},prepare_popup_content:function(a){var c=a.popup_id;if($("#"+c).length){var b=$("#"+c);$("a",b).each(function(){if($(this).attr("href")&&!$(this).hasClass("popup-link")&&!$(this).hasClass("ajax-link-out")&&!$(this).attr("target")&&$(this).attr("href").substring(0,3)!="www"&&$(this).attr("href").substring(0,5)!="http:"&&$(this).attr("href").substring(0, 6)!="https:"&&$(this).attr("href").substring(0,4)!="ftp:"&&$(this).attr("href").substring(0,7)!="mailto:"){$(this).attr("href").indexOf(c)==-1?$(this).data("href","/user/popup/"+c+"/url="+$(this).attr("href")):$(this).data("href",$(this).attr("href"));if($.browser.msie&&$.browser.version.substr(0,1)<7){var a=window.location.href.replace(window.location.hash,"");$(this).data("href",$(this).data("href").replace(a,"/"))}$(this).click(function(){$("#loading-status").css("display","block");url=$(this).data("href"); $.ajax({url:url,dataType:"json",success:treeio.process_popup_data});return false})}});treeio.prepare_popups(b);$("form",b).each(function(){(url=$(this).attr("action"))?url.indexOf("/user/popup/")==-1&&(url="/user/popup/"+a.popup_id+"/url="+url):url=a.url;$(this).attr("action",url);var b={beforeSubmit:function(){$("#loading-status").css("display","block")},url:url,dataType:"json",success:treeio.process_ajax};$(this).ajaxForm(b)});treeio.showhidejs(b);treeio.prepare_ajax_links(b);treeio.prepare_comments(b); treeio.prepare_attachments(b);treeio.prepare_invites(b);treeio.prepare_tags(b);treeio.prepare_autocomplete(b);treeio.prepare_search_duplicates(b);treeio.put_datepicker(b);treeio.prepare_mass_form(b);treeio.put_mce(b)}},process_popup_data:function(a){if(a.popup){var c=$("#"+a.popup.popup_id);if(a.popup.object){if(c.data("field")){var b=$("#"+c.data("module")),d=$("#"+c.data("field"),b);d.hasClass("autocomplete")?(d.val(a.popup.object.name),b=$("#"+d.attr("id").replace("autocomplete_", ""),b),b.each(function(){$(this).val(a.popup.object.id)})):d.hasClass("duplicates")?(d.val(a.popup.object.name),b=$("#"+d.attr("id").replace("duplicates_",""),b),b.each(function(){$(this).val(a.popup.object.id)})):d.append('<option value="'+a.popup.object.id+'" selected="selected">'+a.popup.object.name+"</option>")}else{var e=location.hash.substring(1),e=treeio.prepare_url(e),b=c.parents("div.popup-block-inner");$("#loading-status").css("display","block");b.length>0&&$(b).first().each(function(){e= "/user/popup/"+$(this).attr("id")+"/url="+$(this).parent().data("link").replace("#","")});$.ajax({url:e,dataType:"json",success:treeio.process_ajax,complete:treeio.process_html})}c.parent().remove()}else a.popup.redirect?(e=location.hash.substring(1),e=treeio.prepare_url(e),b=c.parents("div.popup-block-inner"),$("#loading-status").css("display","block"),b.length>0&&$(b).first().each(function(){e="/user/popup/"+$(this).attr("id")+"/url="+$(this).parent().data("link").replace("#","")}),$.ajax({url:e, dataType:"json",success:treeio.process_ajax,complete:treeio.process_html}),c.parent().remove()):(b=c.parent().children("div.popup-title-block"),b.children("span.popup-title").html(a.popup.title),b.children("span.popup-subtitle").html(a.popup.subtitle),c.html(a.popup.content),treeio.prepare_popup_content(a.popup),c.parent().fadeIn(300),$("input:text:visible:first",c).focus())}$("#loading-status").css("display","none")},prepare_popups:function(a){$("a.popup-link",a).each(function(){$(this).hasClass("popup-link-out")|| $(this).click(function(){var c=a.attr("id")+"-popup-"+$(this).attr("id")+"-"+Date.now();if($("#"+c).length)return false;$("#loading-status").css("display","block");var b=$("<div></div>").addClass("popup-block").css("display","none").css("visibility","visible");b.data("link",$(this).attr("href"));var d=$("<div></div>").addClass("popup-title-block");d.append($("<span></span>").addClass("popup-title"));d.append($("<span></span>").addClass("popup-subtitle"));var e=$("<div></div>").addClass("popup-link-open"); e.click(function(){var a=$(this).parent().data("link");if(a)a=a.replace("#",""),window.location.hash=a,$(this).parent().remove()});var f=$("<div></div>").addClass("popup-close");f.click(function(){$("#"+c).length&&$("#"+c).parent().remove()});var g=$("<div></div>").addClass("popup-block-inner");g.attr("id",c);$(this).attr("field")&&(g.data("field",$(this).attr("field")),g.data("module",a.attr("id")));b.append(f);b.append(e);b.append(d);b.append(g);a.append(b);d=b.parents("div.popup-block-inner"); d.length>0?(d=d.first().offset(),b.position({my:"center top",at:"center top",of:$(this),collision:"flip",offset:"-"+d.left+" -"+d.top+""})):b.position({my:"left top",at:"left top",of:$(this),collision:"fit",offset:"-30 -5"});b.draggable({handle:"div.popup-title-block",opacity:0.5,addClasses:false});url="/user/popup/"+c+"/url="+$(this).attr("href").replace("#","");$.browser.msie&&$.browser.version.substr(0,1)<7&&(url="/user/popup/"+c+"/url=/"+$(this).attr("href").replace("#",""),b=window.location.href.replace(window.location.hash, ""),url=url.replace(b,""));url=url.replace("//","/");$.ajax({url:url,dataType:"json",success:treeio.process_popup_data});return false})})},prepare_autocomplete:function(a){$("input.autocomplete",a).each(function(){$(this).data("hidden_field",$("#id_"+$(this).attr("name").replace("autocomplete_",""),a));$(this).autocomplete({source:$(this).attr("callback")+".json",focus:function(a,b){$(this).val(b.item.label);$(this).data("hidden_field").val(b.item.value);return false},select:function(a,b){$(this).val(b.item.label); $(this).data("hidden_field").val(b.item.value);return false}});$(this).change(function(){$(this).val()==""&&$(this).data("hidden_field").val("")})});$("input.multicomplete",a).each(function(){$(this).data("hidden_fields",$("#"+$(this).attr("name").replace("multicomplete_","multi_"),a));$(this).bind("keydown",function(a){a.keyCode===$.ui.keyCode.TAB&&$(this).data("autocomplete").menu.active&&a.preventDefault()});$(this).bind("keyup",function(a){if(a.keyCode===$.ui.keyCode.BACKSPACE||a.keyCode===$.ui.keyCode.DELETE)for(var a= treeio.utils.split(this.value),c=$("input",$(this).data("hidden_fields")),e=0;e<c.length;e++){var f=$(c[e]).attr("label");$.inArray(f,a)==-1&&$(c[e]).remove()}});var c=$(this).attr("callback")+".json";$(this).autocomplete({source:function(a,d){$.getJSON(c,{term:treeio.utils.extractLast(a.term)},d)},search:function(){if(treeio.utils.extractLast(this.value).length<2)return false},focus:function(){return false},select:function(a,c){var e=treeio.utils.split(this.value);e.pop();e.push(c.item.label); e.push("");var f=$(this).data("hidden_fields"),g=$("<input>");g.attr("type","hidden").attr("name",$(this).attr("name").replace("multicomplete_","")).attr("id","id_"+g.attr("name")).attr("value",c.item.value).attr("label",c.item.label);this.value=e.join(", ");f.append(g);e=treeio.utils.split(this.value);f=$("input",$(this).data("hidden_fields"));for(g=0;g<f.length;g++){var h=$(f[g]).attr("label");$.inArray(h,e)==-1&&$(f[g]).remove()}return false}})})},prepare_search_duplicates:function(a){$("input.duplicates", a).each(function(){$(this).data("hidden_field",$("#id_"+$(this).attr("name").replace("duplicates_",""),a));$(this).autocomplete({source:$(this).attr("callback")+".json",focus:function(a,b){$(this).val(b.item.label);return false},select:function(a,b){$(this).val(b.item.label);return false}})})},prepare_attachments:function(a){$(".delete-attachment",a).each(function(){$(this).click(function(){Dajaxice.treeio.account.attachment_delete(Dajax.process,{attachment_id:$(this).attr("attachment")});return false})}); $(".attachment-uploader",a).each(function(){new qq.FileUploader({action:$(this).attr("action"),element:this,multiple:false,onComplete:function(a,b,d){Dajaxice.treeio.account.attachment(Dajax.process,{object_id:d.object_id,update_id:d.update_id})},onAllComplete:function(){},params:{csrf_token:$(this).attr("csrf"),csrf_name:"csrfmiddlewaretoken",csrf_xname:"X-CSRFToken"},text:treeio_attachment_text})});$(".attachment-record-uploader",a).each(function(){new qq.FileUploader({action:$(this).attr("action"), element:this,multiple:false,onComplete:function(a,b,d){Dajaxice.treeio.account.attachment(Dajax.process,{object_id:d.object_id,update_id:d.update_id})},onAllComplete:function(){},params:{csrf_token:$(this).attr("csrf"),csrf_name:"csrfmiddlewaretoken",csrf_xname:"X-CSRFToken"},text:treeio_attachment_record_text})})},prepare_invites:function(a){$(".easy-invite",a).each(function(){$(this).click(function(){Dajaxice.treeio.account.easy_invite(Dajax.process,{emails:$(this).attr("emails")});return false})})}, prepare_comments:function(a){$("a.like-button",a).each(function(){$(this).click(function(){$(this).parent().submit();return false})});$("a.comment-button",a).each(function(){$(this).click(function(){var a=$("div.comments-likes-box-"+$(this).attr("object"));a.toggle();a.css("display")!="none"&&$("textarea:visible:first",a).focus();return false})});$("span.comments-likes-toggle",a).each(function(){$(this).click(function(){var a=$("div.comments-likes-box-"+$(this).attr("object"));a.toggle();a.css("display")!= "none"&&$("textarea:visible:first",a).focus();return false})});$("form.like-form",a).each(function(){var a="comments-likes-box-"+$(this).attr("object");$("#"+a);$(this).attr("target",a);$(this).submit(function(){var a=$(this).attr("target"),c=$(this).parents("#"+a),a=treeio.utils.generate_id(a);c.attr("id",a);a={target:"#"+a,form:$(this).serializeObject(),expand:true};Dajaxice.treeio.account.comments_likes(Dajax.process,a);return false})})},prepare_tags:function(a){$("input#id_multicomplete_tags", a).each(function(){$(this).focus();$(this).focusout(function(){$(this).parent("form").submit()});$(this).parent("form").submit(function(){var a=$(this).attr("target"),b=$(this).parents(a),a=treeio.utils.generate_id();b.attr("id",a);a={target:"#"+a,object_id:$(this).attr("object"),edit:true,formdata:$(this).serializeObject()};Dajaxice.treeio.account.tags(Dajax.process,a);return false})});$("span.tags-box").each(function(){$("span.tags-box-link",$(this)).css("visibility","hidden");$(this).hover(function(){$("span.tags-box-link", $(this)).css("visibility","visible")},function(){$("span.tags-box-link",$(this)).css("visibility","hidden")})})},prepare_forms:function(a){$("form",a).each(function(){if(!$(this).hasClass("like-form")&&!$(this).hasClass("tags-form")){(url=$(this).attr("action"))||(url=location.hash.substring(1));if($(this).attr("method")=="get"){$(this).attr("action",url);var a={beforeSubmit:function(a,c){var e=c.attr("action");e.indexOf("!")!=-1&&(e=e.substring(0,e.indexOf("!")));e+="!"+c.formSerialize();window.location.hash= "#"+e;return false}}}else url=treeio.prepare_url(url),a={beforeSubmit:function(){$("#loading-status").css("display","block")},url:url,dataType:"json",success:treeio.process_ajax};$(this).ajaxForm(a)}});treeio.prepare_mass_form(a);treeio.prepare_filter_form(a);treeio.prepare_autocomplete(a);treeio.prepare_search_duplicates(a);treeio.put_datepicker(a)},prepare_dropdown_menus:function(){$("a.menu-dropdown-link").each(function(){$(this).click(function(){var a=$("#"+$(this).attr("dropdown")); $(this).addClass("menu-dropdown-link-active");a.slideDown("fast").show()});$(this).hover(function(){var a=$("#"+$(this).attr("dropdown"));$(this).addClass("menu-dropdown-link-active");a.slideDown("fast").show()});$(this).parent().hover(function(){},function(){var a=$(this).children("a.menu-dropdown-link");$(this).children("#"+a.attr("dropdown")).slideUp("fast");a.removeClass("menu-dropdown-link-active")})})},prepare_toolbar:function(){$("span.hide_toolbar").click(function(){$("#toolbar").slideToggle("fast", function(){$("#toolbar_action").fadeIn("slow")})});$("span.show_toolbar").click(function(){$("#toolbar_action").fadeOut("fast",function(){$("#toolbar").slideToggle("fast")})})}};treeio.utils={split:function(a){return a.split(/,\s*/)},extractLast:function(a){return treeio.utils.split(a).pop()},generate_id:function(a){a||(a="ajax");for(var a=a+"-"+Date.now(),c=0;$("#"+a).length>0;)a=a+"-"+c,c++;return a}}; treeio.modules={"treeio-home":{init:function(){var a={opacity:0.6,handle:"div.widget-title",connectWith:"#widget-panel-right",items:"div.widget-block",cursor:"move",update:function(){var a=$(this).attr("callback")+"?"+$(this).sortable("serialize");$.ajax({url:a})},start:function(a,b){$("#widget-panel-left").addClass("widget-panel-active");$("#widget-panel-right").addClass("widget-panel-active");b.item.addClass("widget-block-moving")},beforeStop:function(a,b){b.item.removeClass("widget-block-moving")}, stop:function(){$("#widget-panel-left").removeClass("widget-panel-active");$("#widget-panel-right").removeClass("widget-panel-active")}};$("#widget-panel-left").sortable(a);a.connectWith="#widget-panel-left";$("#widget-panel-right").sortable(a)}},"treeio-core":{init:function(){$("div.setup-module-box").length>0&&$("div.setup-module-box").each(function(){$(this).click(function(){$(this).toggleClass("setup-module-box-active");$("input",$(this)).each(function(){$(this).attr("checked",!$(this).attr("checked"))})})})}}, "treeio-projects":{timer:function(){var a=$(".projects-timeslot");a&&(a.each(function(){var a=$(this).data("start"),b=Date.now();a==null&&(a=parseInt($(this).attr("diff")),a=b-a*1E3,$(this).data("start",a));var d=(b-a)/1E3,a=Math.floor(d/3600),b=Math.floor((d/3600-a)*60),d=Math.round(((d/3600-a)*60-b)*60);a+=":";a+=b>=10?b+":":"0"+b+":";a+=d>=10?d:"0"+d;$(this).html(a)}),window.setTimeout(treeio.modules["treeio-projects"].timer,1E3))},init:function(){$(".projects-timeslot")&&this.timer();var a= $("div.ganttChart");a&&this.gantt(a)},gantt:function(a){a.each(function(){if(ganttData){$(this).ganttView({data:ganttData,behavior:{onClick:function(){},onResize:function(a){Dajaxice.treeio.projects.gantt(callback_function,{task:a.id,start:a.start.toString("yyyy-M-d"),end:a.end.toString("yyyy-M-d")})},onDrag:function(a){Dajaxice.treeio.projects.gantt(callback_function,{task:a.id,start:a.start.toString("yyyy-M-d"),end:a.end.toString("yyyy-M-d")})}}});var a=$("#module-treeio-projects");$(this).ganttView("setSlideWidth", $("td.module-content",a).width()-60);treeio.prepare_popups($(this));$(window).resize(function(){$("div.ganttChart",a).each(function(){var a=$("#module-treeio-projects");$(this).ganttView("setSlideWidth",$("td.module-content",a).width()-60)})})}})}},"treeio-reports":{init:function(){}}}; treeio.nuvius={profile:null,access_popup:false,reload_on_profile:true,fetch_profile:function(){$("#loading-status").css("display","block");$("#loading-status-text").html("Loading...");$.ajax({url:nuvius_profile_url,dataType:"jsonp",success:treeio.nuvius.load_profile,error:treeio.show_error})},check_profile:function(a){a?a.key_valid&&(a.username?$("#nuvius-username").html(a.username):$("#nuvius-username").html("Anonymous User"),treeio.nuvius.reload_on_profile&&treeio.do_ajax()):treeio.nuvius.profile&& (a=nuvius_profile_check_url,a+="?nuvius_id="+treeio.nuvius.profile.id+"&profile_key="+treeio.nuvius.profile.key,$.ajax({url:a,dataType:"json",success:treeio.nuvius.check_profile,error:treeio.show_error}))},load_profile:function(a){$("#loading-status").css("display","none");if(a.profile)!a.profile.access_granted&&treeio.nuvius.access_popup?($.colorbox({href:a.profile.access_url,width:"80%",height:"80%",iframe:true,overlayClose:false,onClosed:treeio.nuvius.fetch_profile}),treeio.nuvius.access_popup= false):(treeio.nuvius.profile=a.profile,treeio.nuvius.check_profile())},fetch_access:function(){treeio.nuvius.access_popup=true;treeio.nuvius.fetch_profile()},close_iframe:function(){$.colorbox.close()}}; $(function(){$(window).hashchange(treeio.do_ajax);$(window).hashchange();treeio.prepare_dropdown_menus();treeio.prepare_toolbar();treeio.convert_links();treeio.prepare_ajax_links();$(".menu-item a").each(function(){$(this).click(function(){$(this).hasClass("active")&&$(this).attr("href")==window.location.hash&&$(window).hashchange()})});$("#perspective_switch").each(function(){(url=$(this).attr("action"))||(url=location.hash.substring(1));url=treeio.prepare_url(url);var a={beforeSubmit:function(){$("#loading-status").css("display", "block")},url:url,dataType:"json",success:treeio.process_ajax};$(this).ajaxForm(a);$(this).children("select").change(function(){$("#perspective_switch").submit()})});$("form#search_form").each(function(){(url=$(this).attr("action"))||(url=location.hash.substring(1));$(this).attr("action",url);$(this).ajaxForm({beforeSubmit:function(a,c){var b=c.attr("action");b+="!"+c.formSerialize();window.location.hash="#"+b;return false}})});$(".module-block").data("title",document.title);$(".module-block").each(function(){doc= $(this);$("form").length&&(treeio.prepare_forms(doc),treeio.prepare_comments(doc),$("textarea").length&&treeio.put_mce(doc),treeio.put_datepicker(doc),treeio.prepare_forms(doc));treeio.prepare_tags();treeio.prepare_slider_sidebar(doc);treeio.prepare_list_actions(doc);treeio.prepare_attachments(doc);treeio.prepare_invites(doc);treeio.prepare_popups(doc);treeio.showhidejs(doc);module_name=$(this).attr("id").substring(7);treeio.prepare_module_stuff(module_name);window.setTimeout("$('#loading-splash').fadeOut();", 5E3)})});

// flexbox
(function(a){a.flexbox=function(N,I){var K=false,p=[],J=[],f=0,l="\u25CA",Q=false,x=I.paging&&I.paging.pageSize?I.paging.pageSize:0,B=0,E=a(N).css("position","relative").css("z-index",0);var P=a('<input type="hidden"/>').attr("id",E.attr("id")+"_hidden").attr("name",E.attr("id")).val(I.initialValue).appendTo(E);var z=a("<input/>").attr("id",E.attr("id")+"_input").attr("autocomplete","off").addClass(I.inputClass).css("width",I.width+"px").appendTo(E).click(function(o){if(I.watermark!==""&&this.value===I.watermark){this.value=""}else{this.select()}}).focus(function(o){a(this).removeClass("watermark")}).blur(function(o){setTimeout(function(){if(!z.data("active")){b()}},200)}).keydown(L);if(I.initialValue!==""){z.val(I.initialValue).removeClass("watermark")}else{z.val(I.watermark).addClass("watermark")}var g=0;if(I.showArrow&&I.showResults){var F=function(){if(q.is(":visible")){b()}else{z.focus();if(I.watermark!==""&&z.val()===I.watermark){z.val("")}else{z.select()}if(K){clearTimeout(K)}K=setTimeout(function(){G(1,true,I.arrowQuery)},I.queryDelay)}};var i=a("<span></span>").attr("id",E.attr("id")+"_arrow").addClass(I.arrowClass).addClass("out").hover(function(){a(this).removeClass("out").addClass("over")},function(){a(this).removeClass("over").addClass("out")}).mousedown(function(){a(this).removeClass("over").addClass("active")}).mouseup(function(){a(this).removeClass("active").addClass("over")}).click(F).appendTo(E);g=i.width();z.css("width",(I.width-g)+"px")}if(!I.allowInput){I.selectFirstMatch=false;z.click(F)}var O=z.outerHeight()-z.height()-2;var s=z.outerWidth()-2;var j=z.outerHeight();if(O===0){s+=4;j+=4}else{if(O!==4){s+=O;j+=O}}var q=a("<div></div>").attr("id",E.attr("id")+"_ctr").css("width",s+g).css("top",j).css("left",0).addClass(I.containerClass).appendTo(E).mousedown(function(o){z.data("active",true)}).hide();var c=a("<div></div>").addClass(I.contentClass).appendTo(q).scroll(function(){Q=true});var u=a("<div></div>").appendTo(q);E.css("height",z.outerHeight());function L(X){var V=0;if(typeof(X.ctrlKey)!=="undefined"){if(X.ctrlKey){V|=1}if(X.shiftKey){V|=2}}else{if(X.modifiers&Event.CONTROL_MASK){V|=1}if(X.modifiers&Event.SHIFT_MASK){V|=2}}if(/16$|17$/.test(X.keyCode)){return}var W=X.keyCode===9,U=X.keyCode===27;var T=X.keyCode===9&&V>0;var o=X.keyCode===8;if(W){if(k()){w()}}if((/27$|38$|33$|34$/.test(X.keyCode)&&q.is(":visible"))||(/13$|40$/.test(X.keyCode))||!I.allowInput){if(X.preventDefault){X.preventDefault()}if(X.stopPropagation){X.stopPropagation()}X.cancelBubble=true;X.returnValue=false;switch(X.keyCode){case 38:M();break;case 40:if(q.is(":visible")){t()}else{v(true)}break;case 13:if(k()){w()}else{v(true)}break;case 27:b();break;case 34:if(I.paging){a("#"+E.attr("id")+"n").click()}else{R()}break;case 33:if(I.paging){a("#"+E.attr("id")+"p").click()}else{H()}break;default:if(!I.allowInput){return}}}else{if(!U&&!W&&!T){v(false,o)}}}function v(o,U){if(K){clearTimeout(K)}var T=U?I.queryDelay*5:I.queryDelay;K=setTimeout(function(){G(1,o,"")},T)}function G(W,T,V){if(T){V=""}var U=V&&V.length>0?V:a.trim(z.val());if(U.length>=I.minChars||T){if(c.outerHeight()>0){c.css("height",c.outerHeight())}c.html("").attr("scrollTop",0);var o=n(U,W);if(o){A(o.data,U);e(W,o.t)}else{var X={q:U,p:W,s:x,contentType:"application/json; charset=utf-8"};var Y=function(af,ac){if(ac===true){U=ac}var aa=parseInt(af[I.totalProperty]);if(isNaN(aa)&&I.paging){if(I.maxCacheBytes<=0){alert('The "maxCacheBytes" configuration option must be greater\nthan zero when implementing client-side paging.')}aa=af[I.resultsProperty].length;var Z=aa/x;if(aa%x>0){Z=parseInt(++Z)}for(var ae=1;ae<=Z;ae++){var ad={};ad[I.totalProperty]=aa;ad[I.resultsProperty]=af[I.resultsProperty].splice(0,x);if(ae===1){ab=A(ad,U)}S(U,ae,x,aa,ad,ab)}}else{var ab=A(af,U);S(U,W,x,aa,af,ab)}e(W,aa)};if(typeof(I.source)==="object"){if(I.allowInput){Y(C(I.source,X))}else{Y(I.source)}}else{if(I.method.toUpperCase()=="POST"){a.post(I.source,X,Y,"json")}else{a.getJSON(I.source,X,Y)}}}}else{b()}}function C(W,X){var T={};T[I.resultsProperty]=[];T[I.totalProperty]=0;var o=0;for(var V=0;V<W[I.resultsProperty].length;V++){if(W[I.resultsProperty][V].name.toLowerCase().indexOf(X.q.toLowerCase())===0){T[I.resultsProperty][o++]=W[I.resultsProperty][V];T[I.totalProperty]+=1}}if(I.paging){var Y=(X.p-1)*X.s;var U=(Y+X.s)>T[I.totalProperty]?T[I.totalProperty]-Y:X.s;T[I.resultsProperty]=T[I.resultsProperty].splice(Y,U)}return T}function e(U,T){u.html("").removeClass(I.paging.cssClass);if(I.showResults&&I.paging&&T>x){var o=T/x;if(T%x>0){o=parseInt(++o)}h(o,U,T)}}function r(U,T,o){if(/^13$|^39$|^37$/.test(U.keyCode)){if(U.preventDefault){U.preventDefault()}if(U.stopPropagation){U.stopPropagation()}U.cancelBubble=true;U.returnValue=false;switch(U.keyCode){case 13:if(/^\d+$/.test(T)&&T>0&&T<=o){G(T,true)}else{alert("Please enter a page number between 1 and "+o)}break;case 39:a("#"+E.attr("id")+"n").click();break;case 37:a("#"+E.attr("id")+"p").click();break}}}function y(o){G(parseInt(a(this).attr("page")),true,z.attr("pq"));return false}function h(aj,af,X){var U="&lt;&lt;",ac="&lt;",ad="&gt;",W="&gt;&gt;",T="...";u.addClass(I.paging.cssClass);var aa=a("<a/>").attr("href","#").addClass("page").click(y),ai=a("<span></span>").addClass("page"),V=E.attr("id");if(af>1){aa.clone(true).attr("id",V+"f").attr("page",1).html(U).appendTo(u);aa.clone(true).attr("id",V+"p").attr("page",af-1).html(ac).appendTo(u)}else{ai.clone(true).html(U).appendTo(u);ai.clone(true).html(ac).appendTo(u)}if(I.paging.style==="links"){var o=I.paging.maxPageLinks;if(aj<=o){for(var ag=1;ag<=aj;ag++){if(ag===af){ai.clone(true).html(af).appendTo(u)}else{aa.clone(true).attr("page",ag).html(ag).appendTo(u)}}}else{if((af+parseInt(o/2))>aj){startPage=aj-o+1}else{startPage=af-parseInt(o/2)}if(startPage>1){aa.clone(true).attr("page",startPage-1).html(T).appendTo(u)}else{startPage=1}for(var ag=startPage;ag<startPage+o;ag++){if(ag===af){ai.clone(true).html(ag).appendTo(u)}else{aa.clone(true).attr("page",ag).html(ag).appendTo(u)}}if(aj>(startPage+o)){aa.clone(true).attr("page",ag).html(T).appendTo(u)}}}else{if(I.paging.style==="input"){var ae=a("<input/>").addClass("box").click(function(ak){this.select()}).keypress(function(ak){return r(ak,this.value,aj)}).val(af).appendTo(u)}}if(af<aj){aa.clone(true).attr("id",V+"n").attr("page",+af+1).html(ad).appendTo(u);aa.clone(true).attr("id",V+"l").attr("page",aj).html(W).appendTo(u)}else{ai.clone(true).html(ad).appendTo(u);ai.clone(true).html(W).appendTo(u)}var Z=(af-1)*x+1;var ab=(Z>(X-x))?X:Z+x-1;if(I.paging.showSummary){var ah={start:Z,end:ab,total:X,page:af,pages:aj};var Y=I.paging.summaryTemplate.applyTemplate(ah);a("<br/>").appendTo(u);a("<span></span>").addClass(I.paging.summaryClass).html(Y).appendTo(u)}}function n(U,V){var T=U+l+V;if(J[T]){for(var o=0;o<p.length;o++){if(p[o]===T){p.unshift(p.splice(o,1)[0]);return J[T]}}}return false}function S(Y,Z,W,U,X,T){if(I.maxCacheBytes>0){while(p.length&&(f+T>I.maxCacheBytes)){var V=p.pop();f-=V.size}var o=Y+l+Z;J[o]={q:Y,p:Z,s:W,t:U,size:T,data:X};p.push(o);f+=T}}function A(ab,T){var ad=0,o=0;if(!ab){return}if(parseInt(ab[I.totalProperty])===0&&I.noResultsText&&I.noResultsText.length>0){c.addClass(I.noResultsClass).html(I.noResultsText);q.show();return}else{c.removeClass(I.noResultsClass)}for(var X=0;X<ab[I.resultsProperty].length;X++){var V=ab[I.resultsProperty][X],ag=I.resultTemplate.applyTemplate(V),W=T===ag,U=false,af=false,Y=V[I.displayValue];if(!W&&I.highlightMatches&&T!==""){var aa=T,ac=Y.toLowerCase().indexOf(T.toLowerCase()),Z='<span class="'+I.matchClass+'">'+Y.substr(ac,T.length)+"</span>";if(ag.match("<(.|\n)*?>")){af=true;aa="(>)([^<]*?)("+T+")((.|\n)*?)(<)";Z='$1$2<span class="'+I.matchClass+'">$3</span>$4$6'}ag=ag.replace(new RegExp(aa,I.highlightMatchesRegExModifier),Z)}if(I.autoCompleteFirstMatch&&!af&&X===0){if(T.length>0&&Y.toLowerCase().indexOf(T.toLowerCase())===0){z.attr("pq",T);z.val(Y);U=m(T.length,z.val().length)}}if(!I.showResults){return}$row=a("<div></div>").attr("id",V[I.displayValue]).attr("val",V[I.hiddenValue]).addClass("row").html(ag).appendTo(c);if(W||(++o==1&&I.selectFirstMatch)||U){$row.addClass(I.selectClass)}ad+=ag.length}if(ad===0){b();return}q.parent().css("z-index",11000);q.show();c.children("div").mouseover(function(){c.children("div").removeClass(I.selectClass);a(this).addClass(I.selectClass)}).mouseup(function(ah){ah.preventDefault();ah.stopPropagation();w()});if(I.maxVisibleRows>0){var ae=$row.outerHeight()*I.maxVisibleRows;c.css("max-height",ae)}return ad}function m(U,T){var o=z[0];if(o.createTextRange){var V=o.createTextRange();V.moveStart("character",U);V.moveEnd("character",T-o.value.length);V.select()}else{if(o.setSelectionRange){o.setSelectionRange(U,T)}}o.focus();return true}String.prototype.applyTemplate=function(T){try{if(T===""){return this}return this.replace(/{([^{}]*)}/g,function(V,U){var Y;if(U.indexOf(".")!==-1){var X=U.split(".");var Z=T;for(var W=0;W<X.length;W++){Z=Z[X[W]]}Y=Z}else{Y=T[U]}if(typeof Y==="string"||typeof Y==="number"){return Y}else{throw (V)}})}catch(o){alert("Invalid JSON property "+o+" found when trying to apply resultTemplate or paging.summaryTemplate.\nPlease check your spelling and try again.")}};function b(){z.data("active",false);E.css("z-index",0);q.hide()}function k(){if(!q.is(":visible")){return false}var o=c.children("div."+I.selectClass);if(!o.length){o=false}return o}function w(){$curr=k();if($curr){z.val($curr.attr("id")).focus();P.val($curr.attr("val"));b();if(I.onSelect){z.attr("hiddenValue",P.val());I.onSelect.apply(z[0])}}}function D(){try{document.getBoxObjectFor(document.body);return true}catch(o){return false}}function d(){try{document.body.getBoundingClientRect();return true}catch(o){return false}}function R(){$curr=k();if($curr&&$curr.next().length>0){$curr.removeClass(I.selectClass);for(var o=0;o<I.maxVisibleRows;o++){if($curr.next().length>0){$curr=$curr.next()}}$curr.addClass(I.selectClass);var T=c.attr("scrollTop");c.attr("scrollTop",T+c.height())}else{if(!$curr){c.children("div:first-child").addClass(I.selectClass)}}}function H(){$curr=k();if($curr&&$curr.prev().length>0){$curr.removeClass(I.selectClass);for(var o=0;o<I.maxVisibleRows;o++){if($curr.prev().length>0){$curr=$curr.prev()}}$curr.addClass(I.selectClass);var T=c.attr("scrollTop");c.attr("scrollTop",T-c.height())}else{if(!$curr){c.children("div:last-child").addClass(I.selectClass)}}}function t(){$curr=k();if($curr&&$curr.next().length>0){$curr.removeClass(I.selectClass).next().addClass(I.selectClass);var X=c.attr("scrollTop"),W=$curr[0],V,T,o;if(D()){V=document.getBoxObjectFor(c[0]).y+c.attr("offsetHeight");T=document.getBoxObjectFor(W).y+$curr.attr("offsetHeight");o=document.getBoxObjectFor(W).height}else{if(d()){V=c[0].getBoundingClientRect().bottom;var U=W.getBoundingClientRect();T=U.bottom;o=T-U.top}}if(T>=V){c.attr("scrollTop",X+o)}}else{if(!$curr){c.children("div:first-child").addClass(I.selectClass)}}}function M(){$curr=k();if($curr&&$curr.prev().length>0){$curr.removeClass(I.selectClass).prev().addClass(I.selectClass);var Y=c.attr("scrollTop"),X=$curr[0],T=$curr.parent()[0],V,W,o;if(D()){o=document.getBoxObjectFor(X).height;V=document.getBoxObjectFor(c[0]).y-(o*2);W=document.getBoxObjectFor(X).y-document.getBoxObjectFor(c[0]).y}else{if(d()){V=T.getBoundingClientRect().top;var U=X.getBoundingClientRect();W=U.top;o=U.bottom-W}}if(W<=V){c.attr("scrollTop",Y-o)}}else{if(!$curr){c.children("div:last-child").addClass(I.selectClass)}}}};a.fn.flexbox=function(d,b){if(!d){return}try{var e=a.fn.flexbox.defaults;var f=a.extend({},e,b);for(var g in f){if(e[g]===undefined){throw ("Invalid option specified: "+g+"\nPlease check your spelling and try again.")}}f.source=d;if(b){f.paging=(b.paging||b.paging==null)?a.extend({},e.paging,b.paging):false;for(var g in f.paging){if(e.paging[g]===undefined){throw ("Invalid option specified: "+g+"\nPlease check your spelling and try again.")}}if(b.displayValue&&!b.hiddenValue){f.hiddenValue=b.displayValue}}this.each(function(){new a.flexbox(this,f)});return this}catch(c){if(typeof c==="object"){alert(c.message)}else{alert(c)}}};a.fn.flexbox.defaults={method:"GET",queryDelay:100,allowInput:true,containerClass:"ffb",contentClass:"content",selectClass:"ffb-sel",inputClass:"ffb-input",arrowClass:"ffb-arrow",matchClass:"ffb-match",noResultsText:"No matching results",noResultsClass:"ffb-no-results",showResults:true,selectFirstMatch:true,autoCompleteFirstMatch:false,highlightMatches:true,highlightMatchesRegExModifier:"i",minChars:1,showArrow:true,arrowQuery:"",onSelect:false,maxCacheBytes:32768,resultTemplate:"{name}",displayValue:"name",hiddenValue:"id",initialValue:"",watermark:"",width:200,resultsProperty:"results",totalProperty:"total",maxVisibleRows:0,paging:{style:"input",cssClass:"paging",pageSize:10,maxPageLinks:5,showSummary:true,summaryClass:"summary",summaryTemplate:"Displaying {start}-{end} of {total} results"}};a.fn.setValue=function(b){var c="#"+this.attr("id");a(c+"_hidden,"+c+"_input").val(b).removeClass("watermark")}})(jQuery);

// chat
$.fx.speeds._default=500;$(function(){$("#open-chat").click(function(){$("#chat-frame").css("display")=="none"?($("#chat-frame").fadeIn(300),$("#chat-icon").attr("src","/static/icons/chat.gif")):$("#chat-frame").fadeOut(300);return false});$("#chat-close").click(function(){$("#chat-frame").fadeOut(300)})}); var chat={stringify:function(a){var b=typeof a;if(b!="object"||a===null)return b=="string"&&(a='"'+a+'"'),String(a);else{var c,d,f=[],e=a&&a.constructor==Array;for(c in a)d=a[c],b=typeof d,b=="string"?d='"'+d+'"':b=="object"&&d!==null&&(d=JSON.stringify(d)),f.push((e?"":'"'+c+'":')+String(d));return(e?"[":"{")+String(f)+(e?"]":"}")}},linsearch:function(a,b){k=false;for(var c=0;c<=a.length-1;c++)if(a[c]==b){k=true;break}return k},check_userslist:function(a,b){k=true;for(var c=0;c<=b.length-1;c++)if(chat.linsearch(a, b[c])==false){k=false;break}for(c=0;c<=a.length-1;c++)if(chat.linsearch(b,a[c])==false){k=false;break}return k},check_conferenceslist:function(a,b){for(var c=0;c<=b.length-1;c++)if(chat.linsearch(a,b[c])==false)chat.ui.on_close_conference(b[c])},parse_json_conference:function(a){chat.events.on_conferences_list(a.conferences);chat.events.on_users_list(a.users);chat.events.on_messages(a.new_data);if(a.notifications)a.notifications.length=a.notifications.length||[],a.notifications.length>0&&treeio.process_notifications(a.notifications)}, get_location:function(){return window.location.hash==""?"#":""+window.location.hash},sendJSON:function(a){a.location=chat.get_location();data=chat.stringify(a);$.ajax({type:"POST",url:chat.option.url,typedata:"json",data:{json:data},timeout:chat.option.timeout,success:function(a){chat.parse_json_conference(a)}})},connect:function(){chat.sendJSON({cmd:"Connect"});chat.events.on_connect()},disconnect:function(){sendJSON({cmd:"Disconnect"});chat.events.on_disconnect()},send:function(a,b){json={cmd:"Message", data:{id:a,text:b}};chat.sendJSON(json)},exit_from_conference:function(a){json={cmd:"Exit",data:{id:a}};chat.sendJSON(json)},get_new_messages:function(){json={cmd:"Get",location:chat.get_location()};data=chat.stringify(json);$.ajax({type:"POST",url:chat.option.url,typedata:"json",data:{json:data},timeout:chat.option.timeout,success:function(a){chat.parse_json_conference(a)},complete:function(){setTimeout(chat.get_new_messages,chat.option.interval)}})},delete_conference:function(a){json={cmd:"Delete", data:{id:a}};chat.sendJSON(json)},remove_users_in_conference:function(a,b){json={cmd:"Remove",data:{id:a,users:b}};chat.sendJSON(json)},add_users_in_conference:function(a,b){json={cmd:"Add",data:{id:a,users:b}};chat.sendJSON(json)},create_conference:function(a,b){json={cmd:"Create",data:{title:a,users:b}};chat.sendJSON(json)}};chat.events={on_connect:function(){chat.get_new_messages()},on_disconnect:function(){},on_messages:function(){},on_users_list:function(){},on_conferences_list:function(){}}; chat.option={interval:25E3,url:"/chat",timeout:6E4}; chat.ui={add_nick_in_input:function(a){$("#chat-input-msg").val($("#chat-input-msg").val()+a+": ");$("#chat-input-msg").focus()},get_id_active_conference:function(){activeTab=$("#chat-tabs").tabs("option","selected");id_conference=$($(".ui-tabs-panel").get()[activeTab]).attr("id");return""+id_conference},send_msg:function(){chat.send(chat.ui.get_id_active_conference(),$("#chat-input-msg").val());$("#chat-input-msg").val("")},get_json_userlist:function(){data={results:[]};$.each($(".chat-users p"), function(){$(this).text()!="+"&&data.results.push({id:$(this).attr("user"),name:$(this).text()})});return data},on_close_conference:function(a){$("li a[href=#"+a+"]").prev("img").attr("src","/static/icons/forest.png");delete chat.conferences_dic[a]}};chat.conferences_dic={};chat.userslist={results:[],users:[]}; chat.events.on_users_list=function(a){a=a||[];users_list=function(){list=[];if(a)for(var b=0;b<a.length;b++)list.push(a[b].name);return list}();$("#chat-title").text("Chat ("+a.length+")");if(a.length>0)if(chat.check_userslist(chat.userslist.users,users_list)==false){$(".chat-users").html("");for(var b=0;b<a.length;b++)$("<div/>").append($("<p/>",{text:a[b].profile,user:a[b].name}).bind("dblclick",function(){chat.create_conference($(this).text().split(" ",1),[$(this).attr("user")])})).append($("<span/>").addClass("chat-users-actions").append($("<a/>", {text:"+",user:a[b].name}).addClass("chat-invite-user").bind("click",function(){chat.add_users_in_conference(chat.ui.get_id_active_conference(),[$(this).attr("user")]);$("a.chat-invite-user").hide();$("div.chat-fb-div").hide()})).append(' <a href="'+a[b].location+'">#</a>')).append($("<br/>")).appendTo(".chat-users");a.length==0&&$(".chat-users").html("<p>No users online</p>");chat.userslist.results=chat.ui.get_json_userlist().results;$(".chat-fb").html("");$(".chat-fb").flexbox(chat.ui.get_json_userlist(), {width:100,maxVisibleRows:10,onSelect:function(){chat.add_users_in_conference(chat.ui.get_id_active_conference(),[$(this).attr("hiddenvalue")])}})}else for(b=0;b<a.length;b++)$("a[user='"+a[b].name+"'] + a").attr("href",a[b].location);else $(".chat-users").html(""),$(".chat-users").append($("<p/>",{text:"No users online"}));chat.userslist.users=users_list}; chat.events.on_conferences_list=function(a){function b(a){list=[];a=a||[];if(a.length>0)for(var b=0;b<a.length;b++)list.push(a[b].username);return list}function c(){$("<p/>").text("Between you,").appendTo("#"+conference.id+" .chat-with");for(var a=0;a<conference.users.length;a++)user=conference.users[a],$("<p/>").text(user.profile.split(" ",1)[0]).appendTo("#"+conference.id+" .chat-with");$("<p/>").append($("<a/>",{text:"Invite more people"}).attr("class","chat-invite").bind("click",function(){$("#"+ chat.ui.get_id_active_conference()+" .chat-fb-div").toggle();$("a.chat-invite-user").toggle();$("#"+chat.ui.get_id_active_conference()+" .chat-fb #_input").focus()})).appendTo("#"+conference.id+" .chat-with");conference.users.length==2&&$("a[href='#"+conference.id+"']").text(conference.users[0].profile.split(" ",1)[0]+" and "+conference.users[1].profile.split(" ",1)[0]);conference.users.length>2&&$("a[href='#"+conference.id+"']").text(conference.users[0].profile.split(" ",1)[0]+", "+conference.users[1].profile.split(" ", 1)[0]+", ...")}a=a||[];my_list_conferences=[];list_conferences=function(a){list=[];a=a||[];if(a.length>0)for(var b=0;b<a.length;b++)list.push(a[b].id);return list}(a);for(var d in chat.conferences_dic)my_list_conferences.push(d);chat.check_conferenceslist(list_conferences,my_list_conferences);if(a.length>0)for(d=0;d<a.length;d++)conference=a[d],id=conference.id,list_users=b(conference.users),chat.conferences_dic[id]?chat.check_userslist(chat.conferences_dic[conference.id].users,list_users)==false&& ($("#"+conference.id+" .chat-with").html(""),c()):($("#chat-tabs").tabs("add","#"+conference.id,conference.title),chat.conferences_dic[id]={},chat.conferences_dic[id].active=true,chat.conferences_dic[id].users=[],$("<div/>").attr("class","chat-with small").appendTo("#"+conference.id),$("<div/>").attr("class","chat-fb-div").append($("<div/>").attr("class","chat-fb").flexbox(chat.userslist,{width:100,maxVisibleRows:10,onSelect:function(){chat.add_users_in_conference(chat.ui.get_id_active_conference(), [$(this).attr("hiddenvalue")])}})).append($("<div/>").attr("class","ui-icon ui-icon-close vertical").bind("click",function(){$(this).parent().hide();$("a.chat-invite-user").hide()})).appendTo("#"+conference.id),$("<div/>").attr("class","chat-body").appendTo("#"+conference.id),c()),chat.conferences_dic[conference.id].users=b(conference.users)}; chat.events.on_messages=function(a){a=a||[];if(a.length>0){for(var b=0;b<a.length;b++){new_msg=a[b];for(var c in new_msg){msg=new_msg[c].messages;for(var d=0;d<msg.length;d++)text=msg[d].text,date=msg[d].date,time=msg[d].time,user=msg[d].user,profile=msg[d].profile,$("<div/>").attr("class","message").append($("<div/>",{text:"["+time+"]"}).attr("class","time")).append($("<div/>",{user:user,text:"<"+profile+"> "}).attr("class","nick").bind("click",function(){chat.ui.add_nick_in_input($(this).text().slice(1, -2))})).append($("<div/>",{text:" "+text}).attr("class","text")).appendTo("#"+c+" .chat-body");msg.length>0&&$("li a[href=#"+c+"]").prev("img").fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100);$("#"+c+" .chat-body").animate({scrollTop:$("#"+c+" .chat-body").attr("scrollHeight")},1E3)}}$("#chat-frame").css("display")=="none"&&$("#chat-icon").attr("src","/static/icons/chat-active.gif").fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100)}}; $(function(){$("#chat-tabs").tabs({tabTemplate:"<li><img src='/static/icons/forest-active.png' class='margin-bottom' style='float: left;'><a href='#{href}'>#{label}</a><span class='ui-icon ui-icon-close'>Remove Tab</span></li>"});$("#chat-tabs li span.ui-icon-close").live("click",function(){delete chat.conferences_dic[chat.ui.get_id_active_conference()];chat.exit_from_conference(chat.ui.get_id_active_conference());var a=$("li",$("#chat-tabs")).index($(this).parent());$("#chat-tabs").tabs("remove", a)});$("#chat-input-msg").keypress(function(a){if(a.which=="13")return chat.ui.send_msg(),false});$("#chat-btn-send").click(chat.ui.send_msg);chat.connect();$(".chat-fb").flexbox(chat.ui.get_json_userlist(),{width:100,maxVisibleRows:10,onSelect:function(){chat.add_users_in_conference(chat.ui.get_id_active_conference(),[$(this).attr("hiddenvalue")])}})}); $(function(){var a=$("#tab_title"),b=$("#chat-dialog").dialog({autoOpen:false,modal:true,buttons:{Invite:function(){users=[];$.each($(".chat-dialog-users input:checked"),function(){users.push($(this).attr("name"))});users.length>0&&chat.add_users_in_conference(chat.ui.get_id_active_conference(),users);$(this).dialog("close")},Cancel:function(){$(this).dialog("close")}},open:function(){$(".chat-dialog-users").html("");$.each($(".chat-users p"),function(){$("<input>",{name:$(this).attr("user"),type:"CHECKBOX"}).appendTo($(".chat-dialog-users")); $(".chat-dialog-users").append($(this).text()).append($("<br/>"))});a.focus()},close:function(){c[0].reset()}}),c=$("form",b).submit(function(){b.dialog("close");return false})});

// date
Date.CultureInfo={name:"en-US",englishName:"English (United States)",nativeName:"English (United States)",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],firstLetterDayNames:["S","M","T","W","T","F","S"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],abbreviatedMonthNames:["Jan", "Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],amDesignator:"AM",pmDesignator:"PM",firstDayOfWeek:0,twoDigitYearMax:2029,dateElementOrder:"mdy",formatPatterns:{shortDate:"M/d/yyyy",longDate:"dddd, MMMM dd, yyyy",shortTime:"h:mm tt",longTime:"h:mm:ss tt",fullDateTime:"dddd, MMMM dd, yyyy h:mm:ss tt",sortableDateTime:"yyyy-MM-ddTHH:mm:ss",universalSortableDateTime:"yyyy-MM-dd HH:mm:ssZ",rfc1123:"ddd, dd MMM yyyy HH:mm:ss GMT",monthDay:"MMMM dd",yearMonth:"MMMM, yyyy"},regexPatterns:{jan:/^jan(uary)?/i, feb:/^feb(ruary)?/i,mar:/^mar(ch)?/i,apr:/^apr(il)?/i,may:/^may/i,jun:/^jun(e)?/i,jul:/^jul(y)?/i,aug:/^aug(ust)?/i,sep:/^sep(t(ember)?)?/i,oct:/^oct(ober)?/i,nov:/^nov(ember)?/i,dec:/^dec(ember)?/i,sun:/^su(n(day)?)?/i,mon:/^mo(n(day)?)?/i,tue:/^tu(e(s(day)?)?)?/i,wed:/^we(d(nesday)?)?/i,thu:/^th(u(r(s(day)?)?)?)?/i,fri:/^fr(i(day)?)?/i,sat:/^sa(t(urday)?)?/i,future:/^next/i,past:/^last|past|prev(ious)?/i,add:/^(\+|aft(er)?|from|hence)/i,subtract:/^(\-|bef(ore)?|ago)/i,yesterday:/^yes(terday)?/i, today:/^t(od(ay)?)?/i,tomorrow:/^tom(orrow)?/i,now:/^n(ow)?/i,millisecond:/^ms|milli(second)?s?/i,second:/^sec(ond)?s?/i,minute:/^mn|min(ute)?s?/i,hour:/^h(our)?s?/i,week:/^w(eek)?s?/i,month:/^m(onth)?s?/i,day:/^d(ay)?s?/i,year:/^y(ear)?s?/i,shortMeridian:/^(a|p)/i,longMeridian:/^(a\.?m?\.?|p\.?m?\.?)/i,timezone:/^((e(s|d)t|c(s|d)t|m(s|d)t|p(s|d)t)|((gmt)?\s*(\+|\-)\s*\d\d\d\d?)|gmt|utc)/i,ordinalSuffix:/^\s*(st|nd|rd|th)/i,timeContext:/^\s*(\:|a(?!u|p)|p)/i},timezones:[{name:"UTC",offset:"-000"}, {name:"GMT",offset:"-000"},{name:"EST",offset:"-0500"},{name:"EDT",offset:"-0400"},{name:"CST",offset:"-0600"},{name:"CDT",offset:"-0500"},{name:"MST",offset:"-0700"},{name:"MDT",offset:"-0600"},{name:"PST",offset:"-0800"},{name:"PDT",offset:"-0700"}]}; (function(){var e=Date,d=e.prototype,i=e.CultureInfo,c=function(a,j){j||(j=2);return("000"+a).slice(j*-1)};d.clearTime=function(){this.setHours(0);this.setMinutes(0);this.setSeconds(0);this.setMilliseconds(0);return this};d.setTimeToNow=function(){var a=new Date;this.setHours(a.getHours());this.setMinutes(a.getMinutes());this.setSeconds(a.getSeconds());this.setMilliseconds(a.getMilliseconds());return this};e.today=function(){return(new Date).clearTime()};e.compare=function(a,j){if(isNaN(a)||isNaN(j))throw Error(a+ " - "+j);else if(a instanceof Date&&j instanceof Date)return a<j?-1:a>j?1:0;else throw new TypeError(a+" - "+j);};e.equals=function(a,j){return a.compareTo(j)===0};e.getDayNumberFromName=function(a){for(var j=i.dayNames,f=i.abbreviatedDayNames,b=i.shortestDayNames,a=a.toLowerCase(),c=0;c<j.length;c++)if(j[c].toLowerCase()==a||f[c].toLowerCase()==a||b[c].toLowerCase()==a)return c;return-1};e.getMonthNumberFromName=function(a){for(var j=i.monthNames,f=i.abbreviatedMonthNames,a=a.toLowerCase(),c=0;c< j.length;c++)if(j[c].toLowerCase()==a||f[c].toLowerCase()==a)return c;return-1};e.isLeapYear=function(a){return a%4===0&&a%100!==0||a%400===0};e.getDaysInMonth=function(a,c){return[31,e.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][c]};e.getTimezoneAbbreviation=function(a){for(var c=i.timezones,f=0;f<c.length;f++)if(c[f].offset===a)return c[f].name;return null};e.getTimezoneOffset=function(a){for(var c=i.timezones,f=0;f<c.length;f++)if(c[f].name===a.toUpperCase())return c[f].offset;return null}; d.clone=function(){return new Date(this.getTime())};d.compareTo=function(a){return Date.compare(this,a)};d.equals=function(a){return Date.equals(this,a||new Date)};d.between=function(a,c){return this.getTime()>=a.getTime()&&this.getTime()<=c.getTime()};d.isAfter=function(a){return this.compareTo(a||new Date)===1};d.isBefore=function(a){return this.compareTo(a||new Date)===-1};d.isToday=function(){return this.isSameDay(new Date)};d.isSameDay=function(a){return this.clone().clearTime().equals(a.clone().clearTime())}; d.addMilliseconds=function(a){this.setMilliseconds(this.getMilliseconds()+a);return this};d.addSeconds=function(a){return this.addMilliseconds(a*1E3)};d.addMinutes=function(a){return this.addMilliseconds(a*6E4)};d.addHours=function(a){return this.addMilliseconds(a*36E5)};d.addDays=function(a){this.setDate(this.getDate()+a);return this};d.addWeeks=function(a){return this.addDays(a*7)};d.addMonths=function(a){var c=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+a);this.setDate(Math.min(c, e.getDaysInMonth(this.getFullYear(),this.getMonth())));return this};d.addYears=function(a){return this.addMonths(a*12)};d.add=function(a){if(typeof a=="number")return this._orient=a,this;a.milliseconds&&this.addMilliseconds(a.milliseconds);a.seconds&&this.addSeconds(a.seconds);a.minutes&&this.addMinutes(a.minutes);a.hours&&this.addHours(a.hours);a.weeks&&this.addWeeks(a.weeks);a.months&&this.addMonths(a.months);a.years&&this.addYears(a.years);a.days&&this.addDays(a.days);return this};var b,g,k;d.getWeek= function(){var a,c,f,h,e;b=!b?this.getFullYear():b;g=!g?this.getMonth()+1:g;k=!k?this.getDate():k;g<=2?(a=b-1,c=(a/4|0)-(a/100|0)+(a/400|0),f=c-(((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0)),h=0,e=k-1+31*(g-1)):(a=b,c=(a/4|0)-(a/100|0)+(a/400|0),f=c-(((a-1)/4|0)-((a-1)/100|0)+((a-1)/400|0)),h=f+1,e=k+(153*(g-3)+2)/5+58+f);a=(a+c)%7;h=e+3-(e+a-h)%7|0;b=g=k=null;return h<0?53-((a-f)/5|0):h>364+f?1:(h/7|0)+1};d.getISOWeek=function(){b=this.getUTCFullYear();g=this.getUTCMonth()+1;k=this.getUTCDate();return c(this.getWeek())}; d.setWeek=function(a){return this.moveToDayOfWeek(1).addWeeks(a-this.getWeek())};e._validate=function(a,c,f,b){if(typeof a=="undefined")return!1;else if(typeof a!="number")throw new TypeError(a+" is not a Number.");else if(a<c||a>f)throw new RangeError(a+" is not a valid value for "+b+".");return!0};e.validateMillisecond=function(a){return e._validate(a,0,999,"millisecond")};e.validateSecond=function(a){return e._validate(a,0,59,"second")};e.validateMinute=function(a){return e._validate(a,0,59,"minute")}; e.validateHour=function(a){return e._validate(a,0,23,"hour")};e.validateDay=function(a,c,f){return e._validate(a,1,e.getDaysInMonth(c,f),"day")};e.validateMonth=function(a){return e._validate(a,0,11,"month")};e.validateYear=function(a){return e._validate(a,0,9999,"year")};d.set=function(a){e.validateMillisecond(a.millisecond)&&this.addMilliseconds(a.millisecond-this.getMilliseconds());e.validateSecond(a.second)&&this.addSeconds(a.second-this.getSeconds());e.validateMinute(a.minute)&&this.addMinutes(a.minute- this.getMinutes());e.validateHour(a.hour)&&this.addHours(a.hour-this.getHours());e.validateMonth(a.month)&&this.addMonths(a.month-this.getMonth());e.validateYear(a.year)&&this.addYears(a.year-this.getFullYear());e.validateDay(a.day,this.getFullYear(),this.getMonth())&&this.addDays(a.day-this.getDate());a.timezone&&this.setTimezone(a.timezone);a.timezoneOffset&&this.setTimezoneOffset(a.timezoneOffset);a.week&&e._validate(a.week,0,53,"week")&&this.setWeek(a.week);return this};d.moveToFirstDayOfMonth= function(){return this.set({day:1})};d.moveToLastDayOfMonth=function(){return this.set({day:e.getDaysInMonth(this.getFullYear(),this.getMonth())})};d.moveToNthOccurrence=function(a,c){var f=0;if(c>0)f=c-1;else if(c===-1)return this.moveToLastDayOfMonth(),this.getDay()!==a&&this.moveToDayOfWeek(a,-1),this;return this.moveToFirstDayOfMonth().addDays(-1).moveToDayOfWeek(a,1).addWeeks(f)};d.moveToDayOfWeek=function(a,c){var f=(a-this.getDay()+7*(c||1))%7;return this.addDays(f===0?f+7*(c||1):f)};d.moveToMonth= function(a,c){var f=(a-this.getMonth()+12*(c||1))%12;return this.addMonths(f===0?f+12*(c||1):f)};d.getOrdinalNumber=function(){return Math.ceil((this.clone().clearTime()-new Date(this.getFullYear(),0,1))/864E5)+1};d.getTimezone=function(){return e.getTimezoneAbbreviation(this.getUTCOffset())};d.setTimezoneOffset=function(a){var c=this.getTimezoneOffset();return this.addMinutes(Number(a)*-6/10-c)};d.setTimezone=function(a){return this.setTimezoneOffset(e.getTimezoneOffset(a))};d.hasDaylightSavingTime= function(){return Date.today().set({month:0,day:1}).getTimezoneOffset()!==Date.today().set({month:6,day:1}).getTimezoneOffset()};d.isDaylightSavingTime=function(){return this.hasDaylightSavingTime()&&(new Date).getTimezoneOffset()===Date.today().set({month:6,day:1}).getTimezoneOffset()};d.getUTCOffset=function(){var a=this.getTimezoneOffset()*-10/6;return a<0?(a=(a-1E4).toString(),a.charAt(0)+a.substr(2)):(a=(a+1E4).toString(),"+"+a.substr(1))};d.getElapsed=function(a){return(a||new Date)-this};if(!d.toISOString)d.toISOString= function(){function a(a){return a<10?"0"+a:a}return'"'+this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+'Z"'};d._toString=d.toString;d.toString=function(a){var b=this;if(a&&a.length==1){var f=i.formatPatterns;b.t=b.toString;switch(a){case "d":return b.t(f.shortDate);case "D":return b.t(f.longDate);case "F":return b.t(f.fullDateTime);case "m":return b.t(f.monthDay);case "r":return b.t(f.rfc1123); case "s":return b.t(f.sortableDateTime);case "t":return b.t(f.shortTime);case "T":return b.t(f.longTime);case "u":return b.t(f.universalSortableDateTime);case "y":return b.t(f.yearMonth)}}var g=function(a){switch(a*1){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}};return a?a.replace(/(\\)?(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|S)/g,function(a){if(a.charAt(0)==="\\")return a.replace("\\","");b.h=b.getHours;switch(a){case "hh":return c(b.h()< 13?b.h()===0?12:b.h():b.h()-12);case "h":return b.h()<13?b.h()===0?12:b.h():b.h()-12;case "HH":return c(b.h());case "H":return b.h();case "mm":return c(b.getMinutes());case "m":return b.getMinutes();case "ss":return c(b.getSeconds());case "s":return b.getSeconds();case "yyyy":return c(b.getFullYear(),4);case "yy":return c(b.getFullYear());case "dddd":return i.dayNames[b.getDay()];case "ddd":return i.abbreviatedDayNames[b.getDay()];case "dd":return c(b.getDate());case "d":return b.getDate();case "MMMM":return i.monthNames[b.getMonth()]; case "MMM":return i.abbreviatedMonthNames[b.getMonth()];case "MM":return c(b.getMonth()+1);case "M":return b.getMonth()+1;case "t":return b.h()<12?i.amDesignator.substring(0,1):i.pmDesignator.substring(0,1);case "tt":return b.h()<12?i.amDesignator:i.pmDesignator;case "S":return g(b.getDate());default:return a}}):this._toString()}})(); (function(){var e=Date,d=e.prototype,i=e.CultureInfo,c=Number.prototype;d._orient=1;d._nth=null;d._is=!1;d._same=!1;d._isSecond=!1;c._dateElement="day";d.next=function(){this._orient=1;return this};e.next=function(){return e.today().next()};d.last=d.prev=d.previous=function(){this._orient=-1;return this};e.last=e.prev=e.previous=function(){return e.today().last()};d.is=function(){this._is=!0;return this};d.same=function(){this._same=!0;this._isSecond=!1;return this};d.today=function(){return this.same().day()}; d.weekday=function(){if(this._is)return this._is=!1,!this.is().sat()&&!this.is().sun();return!1};d.at=function(a){return typeof a==="string"?e.parse(this.toString("d")+" "+a):this.set(a)};c.fromNow=c.after=function(a){var f={};f[this._dateElement]=this;return(!a?new Date:a.clone()).add(f)};c.ago=c.before=function(a){var f={};f[this._dateElement]=this*-1;return(!a?new Date:a.clone()).add(f)};var b="sunday monday tuesday wednesday thursday friday saturday".split(/\s/),g="january february march april may june july august september october november december".split(/\s/), k="Millisecond Second Minute Hour Day Week Month Year".split(/\s/),a="Milliseconds Seconds Minutes Hours Date Week Month FullYear".split(/\s/),j="final first second third fourth fifth".split(/\s/);d.toObject=function(){for(var f={},b=0;b<k.length;b++)f[k[b].toLowerCase()]=this["get"+a[b]]();return f};e.fromObject=function(a){a.week=null;return Date.today().set(a)};for(var f=function(a){return function(){if(this._is)return this._is=!1,this.getDay()==a;if(this._nth!==null){this._isSecond&&this.addSeconds(this._orient* -1);this._isSecond=!1;var f=this._nth;this._nth=null;var b=this.clone().moveToLastDayOfMonth();this.moveToNthOccurrence(a,f);if(this>b)throw new RangeError(e.getDayName(a)+" does not occur "+f+" times in the month of "+e.getMonthName(b.getMonth())+" "+b.getFullYear()+".");return this}return this.moveToDayOfWeek(a,this._orient)}},h=function(a){return function(){var f=e.today(),b=a-f.getDay();a===0&&i.firstDayOfWeek===1&&f.getDay()!==0&&(b+=7);return f.addDays(b)}},l=0;l<b.length;l++)e[b[l].toUpperCase()]= e[b[l].toUpperCase().substring(0,3)]=l,e[b[l]]=e[b[l].substring(0,3)]=h(l),d[b[l]]=d[b[l].substring(0,3)]=f(l);b=function(a){return function(){if(this._is)return this._is=!1,this.getMonth()===a;return this.moveToMonth(a,this._orient)}};f=function(a){return function(){return e.today().set({month:a,day:1})}};for(h=0;h<g.length;h++)e[g[h].toUpperCase()]=e[g[h].toUpperCase().substring(0,3)]=h,e[g[h]]=e[g[h].substring(0,3)]=f(h),d[g[h]]=d[g[h].substring(0,3)]=b(h);b=function(a){return function(f){if(this._isSecond)return this._isSecond= !1,this;if(this._same){this._same=this._is=!1;for(var b=this.toObject(),f=(f||new Date).toObject(),c="",g=a.toLowerCase(),e=k.length-1;e>-1;e--){c=k[e].toLowerCase();if(b[c]!=f[c])return!1;if(g==c)break}return!0}a.substring(a.length-1)!="s"&&(a+="s");return this["add"+a](this._orient)}};f=function(a){return function(){this._dateElement=a;return this}};for(h=0;h<k.length;h++)g=k[h].toLowerCase(),d[g]=d[g+"s"]=b(k[h]),c[g]=c[g+"s"]=f(g);d._ss=b("Second");c=function(a){return function(f){if(this._same)return this._ss(f); if(f||f===0)return this.moveToNthOccurrence(f,a);this._nth=a;if(a===2&&(f===void 0||f===null))return this._isSecond=!0,this.addSeconds(this._orient);return this}};for(g=0;g<j.length;g++)d[j[g]]=g===0?c(-1):c(g)})(); (function(){Date.Parsing={Exception:function(b){this.message="Parse error at '"+b.substring(0,10)+" ...'"}};for(var e=Date.Parsing,d=e.Operators={rtoken:function(b){return function(c){var a=c.match(b);if(a)return[a[0],c.substring(a[0].length)];else throw new e.Exception(c);}},token:function(){return function(b){return d.rtoken(RegExp("^s*"+b+"s*"))(b)}},stoken:function(b){return d.rtoken(RegExp("^"+b))},until:function(b){return function(c){for(var a=[],e=null;c.length;){try{e=b.call(this,c)}catch(f){a.push(e[0]); c=e[1];continue}break}return[a,c]}},many:function(b){return function(c){for(var a=[],e=null;c.length;){try{e=b.call(this,c)}catch(f){break}a.push(e[0]);c=e[1]}return[a,c]}},optional:function(b){return function(c){var a=null;try{a=b.call(this,c)}catch(e){return[null,c]}return[a[0],a[1]]}},not:function(b){return function(c){try{b.call(this,c)}catch(a){return[null,c]}throw new e.Exception(c);}},ignore:function(b){return b?function(c){var a=null,a=b.call(this,c);return[null,a[1]]}:null},product:function(){for(var b= arguments[0],c=Array.prototype.slice.call(arguments,1),a=[],e=0;e<b.length;e++)a.push(d.each(b[e],c));return a},cache:function(b){var c={},a=null;return function(d){try{a=c[d]=c[d]||b.call(this,d)}catch(f){a=c[d]=f}if(a instanceof e.Exception)throw a;else return a}},any:function(){var b=arguments;return function(c){for(var a=null,d=0;d<b.length;d++)if(b[d]!=null){try{a=b[d].call(this,c)}catch(f){a=null}if(a)return a}throw new e.Exception(c);}},each:function(){var b=arguments;return function(c){for(var a= [],d=null,f=0;f<b.length;f++)if(b[f]!=null){try{d=b[f].call(this,c)}catch(h){throw new e.Exception(c);}a.push(d[0]);c=d[1]}return[a,c]}},all:function(){var b=b;return b.each(b.optional(arguments))},sequence:function(b,c,a){c=c||d.rtoken(/^\s*/);a=a||null;if(b.length==1)return b[0];return function(d){for(var f=null,h=null,l=[],m=0;m<b.length;m++){try{f=b[m].call(this,d)}catch(n){break}l.push(f[0]);try{h=c.call(this,f[1])}catch(i){h=null;break}d=h[1]}if(!f)throw new e.Exception(d);if(h)throw new e.Exception(h[1]); if(a)try{f=a.call(this,f[1])}catch(o){throw new e.Exception(f[1]);}return[l,f?f[1]:d]}},between:function(b,c,a){var a=a||b,e=d.each(d.ignore(b),c,d.ignore(a));return function(a){a=e.call(this,a);return[[a[0][0],r[0][2]],a[1]]}},list:function(b,c,a){c=c||d.rtoken(/^\s*/);a=a||null;return b instanceof Array?d.each(d.product(b.slice(0,-1),d.ignore(c)),b.slice(-1),d.ignore(a)):d.each(d.many(d.each(b,d.ignore(c))),px,d.ignore(a))},set:function(b,c,a){c=c||d.rtoken(/^\s*/);a=a||null;return function(j){for(var f= null,h=f=null,l=null,m=[[],j],n=!1,i=0;i<b.length;i++){f=h=null;n=b.length==1;try{f=b[i].call(this,j)}catch(o){continue}l=[[f[0]],f[1]];if(f[1].length>0&&!n)try{h=c.call(this,f[1])}catch(p){n=!0}else n=!0;!n&&h[1].length===0&&(n=!0);if(!n){f=[];for(n=0;n<b.length;n++)i!=n&&f.push(b[n]);f=d.set(f,c).call(this,h[1]);f[0].length>0&&(l[0]=l[0].concat(f[0]),l[1]=f[1])}l[1].length<m[1].length&&(m=l);if(m[1].length===0)break}if(m[0].length===0)return m;if(a){try{h=a.call(this,m[1])}catch(q){throw new e.Exception(m[1]); }m[1]=h[1]}return m}},forward:function(b,c){return function(a){return b[c].call(this,a)}},replace:function(b,c){return function(a){a=b.call(this,a);return[c,a[1]]}},process:function(b,c){return function(a){a=b.call(this,a);return[c.call(this,a[0]),a[1]]}},min:function(b,c){return function(a){var d=c.call(this,a);if(d[0].length<b)throw new e.Exception(a);return d}}},i=function(b){return function(){var c=null,a=[];arguments.length>1?c=Array.prototype.slice.call(arguments):arguments[0]instanceof Array&& (c=arguments[0]);if(c)for(var e=c.shift();0<e.length;)return c.unshift(e[0]),a.push(b.apply(null,c)),c.shift(),a;else return b.apply(null,arguments)}},c="optional not ignore cache".split(/\s/),b=0;b<c.length;b++)d[c[b]]=i(d[c[b]]);i=function(b){return function(){return arguments[0]instanceof Array?b.apply(null,arguments[0]):b.apply(null,arguments)}};c="each any all".split(/\s/);for(b=0;b<c.length;b++)d[c[b]]=i(d[c[b]])})(); (function(){var e=Date,d=e.CultureInfo,i=function(a){for(var b=[],c=0;c<a.length;c++)a[c]instanceof Array?b=b.concat(i(a[c])):a[c]&&b.push(a[c]);return b};e.Grammar={};e.Translator={hour:function(a){return function(){this.hour=Number(a)}},minute:function(a){return function(){this.minute=Number(a)}},second:function(a){return function(){this.second=Number(a)}},meridian:function(a){return function(){this.meridian=a.slice(0,1).toLowerCase()}},timezone:function(a){return function(){var b=a.replace(/[^\d\+\-]/g, "");b.length?this.timezoneOffset=Number(b):this.timezone=a.toLowerCase()}},day:function(a){var b=a[0];return function(){this.day=Number(b.match(/\d+/)[0])}},month:function(a){return function(){this.month=a.length==3?"jan feb mar apr may jun jul aug sep oct nov dec".indexOf(a)/4:Number(a)-1}},year:function(a){return function(){var b=Number(a);this.year=a.length>2?b:b+(b+2E3<d.twoDigitYearMax?2E3:1900)}},rday:function(a){return function(){switch(a){case "yesterday":this.days=-1;break;case "tomorrow":this.days= 1;break;case "today":this.days=0;break;case "now":this.days=0,this.now=!0}}},finishExact:function(a){for(var a=a instanceof Array?a:[a],b=0;b<a.length;b++)a[b]&&a[b].call(this);a=new Date;if((this.hour||this.minute)&&!this.month&&!this.year&&!this.day)this.day=a.getDate();if(!this.year)this.year=a.getFullYear();if(!this.month&&this.month!==0)this.month=a.getMonth();if(!this.day)this.day=1;if(!this.hour)this.hour=0;if(!this.minute)this.minute=0;if(!this.second)this.second=0;if(this.meridian&&this.hour)if(this.meridian== "p"&&this.hour<12)this.hour+=12;else if(this.meridian=="a"&&this.hour==12)this.hour=0;if(this.day>e.getDaysInMonth(this.year,this.month))throw new RangeError(this.day+" is not a valid value for days.");a=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second);this.timezone?a.set({timezone:this.timezone}):this.timezoneOffset&&a.set({timezoneOffset:this.timezoneOffset});return a},finish:function(a){a=a instanceof Array?i(a):[a];if(a.length===0)return null;for(var b=0;b<a.length;b++)typeof a[b]== "function"&&a[b].call(this);a=e.today();if(this.now&&!this.unit&&!this.operator)return new Date;else this.now&&(a=new Date);var b=!!(this.days&&this.days!==null||this.orient||this.operator),c,d,g;g=this.orient=="past"||this.operator=="subtract"?-1:1;!this.now&&"hour minute second".indexOf(this.unit)!=-1&&a.setTimeToNow();if((this.month||this.month===0)&&"year day hour minute second".indexOf(this.unit)!=-1)this.value=this.month+1,this.month=null,b=!0;if(!b&&this.weekday&&!this.day&&!this.days){c=Date[this.weekday](); this.day=c.getDate();if(!this.month)this.month=c.getMonth();this.year=c.getFullYear()}if(b&&this.weekday&&this.unit!="month")this.unit="day",c=e.getDayNumberFromName(this.weekday)-a.getDay(),d=7,this.days=c?(c+g*d)%d:g*d;if(this.month&&this.unit=="day"&&this.operator)this.value=this.month+1,this.month=null;if(this.value!=null&&this.month!=null&&this.year!=null)this.day=this.value*1;if(this.month&&!this.day&&this.value&&(a.set({day:this.value*1}),!b))this.day=this.value*1;if(!this.month&&this.value&& this.unit=="month"&&!this.now)this.month=this.value,b=!0;if(b&&(this.month||this.month===0)&&this.unit!="year")this.unit="month",c=this.month-a.getMonth(),d=12,this.months=c?(c+g*d)%d:g*d,this.month=null;if(!this.unit)this.unit="day";if(!this.value&&this.operator&&this.operator!==null&&this[this.unit+"s"]&&this[this.unit+"s"]!==null)this[this.unit+"s"]=this[this.unit+"s"]+(this.operator=="add"?1:-1)+(this.value||0)*g;else if(this[this.unit+"s"]==null||this.operator!=null){if(!this.value)this.value= 1;this[this.unit+"s"]=this.value*g}if(this.meridian&&this.hour)if(this.meridian=="p"&&this.hour<12)this.hour+=12;else if(this.meridian=="a"&&this.hour==12)this.hour=0;if(this.weekday&&!this.day&&!this.days&&(c=Date[this.weekday](),this.day=c.getDate(),c.getMonth()!==a.getMonth()))this.month=c.getMonth();if((this.month||this.month===0)&&!this.day)this.day=1;if(!this.orient&&!this.operator&&this.unit=="week"&&this.value&&!this.day&&!this.month)return Date.today().setWeek(this.value);if(b&&this.timezone&& this.day&&this.days)this.day=this.days;return b?a.add(this):a.set(this)}};var c=e.Parsing.Operators,b=e.Grammar,g=e.Translator,k;b.datePartDelimiter=c.rtoken(/^([\s\-\.\,\/\x27]+)/);b.timePartDelimiter=c.stoken(":");b.whiteSpace=c.rtoken(/^\s*/);b.generalDelimiter=c.rtoken(/^(([\s\,]|at|@|on)+)/);var a={};b.ctoken=function(b){var e=a[b];if(!e){for(var e=d.regexPatterns,g=b.split(/\s+/),i=[],j=0;j<g.length;j++)i.push(c.replace(c.rtoken(e[g[j]]),g[j]));e=a[b]=c.any.apply(null,i)}return e};b.ctoken2= function(a){return c.rtoken(d.regexPatterns[a])};b.h=c.cache(c.process(c.rtoken(/^(0[0-9]|1[0-2]|[1-9])/),g.hour));b.hh=c.cache(c.process(c.rtoken(/^(0[0-9]|1[0-2])/),g.hour));b.H=c.cache(c.process(c.rtoken(/^([0-1][0-9]|2[0-3]|[0-9])/),g.hour));b.HH=c.cache(c.process(c.rtoken(/^([0-1][0-9]|2[0-3])/),g.hour));b.m=c.cache(c.process(c.rtoken(/^([0-5][0-9]|[0-9])/),g.minute));b.mm=c.cache(c.process(c.rtoken(/^[0-5][0-9]/),g.minute));b.s=c.cache(c.process(c.rtoken(/^([0-5][0-9]|[0-9])/),g.second));b.ss= c.cache(c.process(c.rtoken(/^[0-5][0-9]/),g.second));b.hms=c.cache(c.sequence([b.H,b.m,b.s],b.timePartDelimiter));b.t=c.cache(c.process(b.ctoken2("shortMeridian"),g.meridian));b.tt=c.cache(c.process(b.ctoken2("longMeridian"),g.meridian));b.z=c.cache(c.process(c.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),g.timezone));b.zz=c.cache(c.process(c.rtoken(/^((\+|\-)\s*\d\d\d\d)|((\+|\-)\d\d\:?\d\d)/),g.timezone));b.zzz=c.cache(c.process(b.ctoken2("timezone"),g.timezone));b.timeSuffix=c.each(c.ignore(b.whiteSpace), c.set([b.tt,b.zzz]));b.time=c.each(c.optional(c.ignore(c.stoken("T"))),b.hms,b.timeSuffix);b.d=c.cache(c.process(c.each(c.rtoken(/^([0-2]\d|3[0-1]|\d)/),c.optional(b.ctoken2("ordinalSuffix"))),g.day));b.dd=c.cache(c.process(c.each(c.rtoken(/^([0-2]\d|3[0-1])/),c.optional(b.ctoken2("ordinalSuffix"))),g.day));b.ddd=b.dddd=c.cache(c.process(b.ctoken("sun mon tue wed thu fri sat"),function(a){return function(){this.weekday=a}}));b.M=c.cache(c.process(c.rtoken(/^(1[0-2]|0\d|\d)/),g.month));b.MM=c.cache(c.process(c.rtoken(/^(1[0-2]|0\d)/), g.month));b.MMM=b.MMMM=c.cache(c.process(b.ctoken("jan feb mar apr may jun jul aug sep oct nov dec"),g.month));b.y=c.cache(c.process(c.rtoken(/^(\d\d?)/),g.year));b.yy=c.cache(c.process(c.rtoken(/^(\d\d)/),g.year));b.yyy=c.cache(c.process(c.rtoken(/^(\d\d?\d?\d?)/),g.year));b.yyyy=c.cache(c.process(c.rtoken(/^(\d\d\d\d)/),g.year));k=function(){return c.each(c.any.apply(null,arguments),c.not(b.ctoken2("timeContext")))};b.day=k(b.d,b.dd);b.month=k(b.M,b.MMM);b.year=k(b.yyyy,b.yy);b.orientation=c.process(b.ctoken("past future"), function(a){return function(){this.orient=a}});b.operator=c.process(b.ctoken("add subtract"),function(a){return function(){this.operator=a}});b.rday=c.process(b.ctoken("yesterday tomorrow today now"),g.rday);b.unit=c.process(b.ctoken("second minute hour day week month year"),function(a){return function(){this.unit=a}});b.value=c.process(c.rtoken(/^\d\d?(st|nd|rd|th)?/),function(a){return function(){this.value=a.replace(/\D/g,"")}});b.expression=c.set([b.rday,b.operator,b.value,b.unit,b.orientation, b.ddd,b.MMM]);k=function(){return c.set(arguments,b.datePartDelimiter)};b.mdy=k(b.ddd,b.month,b.day,b.year);b.ymd=k(b.ddd,b.year,b.month,b.day);b.dmy=k(b.ddd,b.day,b.month,b.year);b.date=function(a){return(b[d.dateElementOrder]||b.mdy).call(this,a)};b.format=c.process(c.many(c.any(c.process(c.rtoken(/^(dd?d?d?|MM?M?M?|yy?y?y?|hh?|HH?|mm?|ss?|tt?|zz?z?)/),function(a){if(b[a])return b[a];else throw e.Parsing.Exception(a);}),c.process(c.rtoken(/^[^dMyhHmstz]+/),function(a){return c.ignore(c.stoken(a))}))), function(a){return c.process(c.each.apply(null,a),g.finishExact)});var j={};b.formats=function(a){if(a instanceof Array){for(var e=[],d=0;d<a.length;d++)e.push(j[a[d]]=j[a[d]]||b.format(a[d])[0]);return c.any.apply(null,e)}else return j[a]=j[a]||b.format(a)[0]};b._formats=b.formats(['"yyyy-MM-ddTHH:mm:ssZ"',"yyyy-MM-ddTHH:mm:ssZ","yyyy-MM-ddTHH:mm:ssz","yyyy-MM-ddTHH:mm:ss","yyyy-MM-ddTHH:mmZ","yyyy-MM-ddTHH:mmz","yyyy-MM-ddTHH:mm","ddd, MMM dd, yyyy H:mm:ss tt","ddd MMM d yyyy HH:mm:ss zzz","MMddyyyy", "ddMMyyyy","Mddyyyy","ddMyyyy","Mdyyyy","dMyyyy","yyyy","Mdyy","dMyy","d"]);b._start=c.process(c.set([b.date,b.time,b.expression],b.generalDelimiter,b.whiteSpace),g.finish);b.start=function(a){try{var c=b._formats.call({},a);if(c[1].length===0)return c}catch(d){}return b._start.call({},a)};e._parse=e.parse;e.parse=function(a){var b=null;if(!a)return null;if(a instanceof Date)return a;try{b=e.Grammar.start.call({},a.replace(/^\s*(\S*(\s+\S+)*)\s*$/,"$1"))}catch(c){return null}return b[1].length=== 0?b[0]:null};e.getParseFunction=function(a){var b=e.Grammar.formats(a);return function(a){var c=null;try{c=b.call({},a)}catch(d){return null}return c[1].length===0?c[0]:null}};e.parseExact=function(a,b){return e.getParseFunction(b)(a)}})();

// ganttview
(function(a){function u(q){function b(){var b=s.getBoundaryDatesFromData(f.data,Math.floor(f.slideWidth/f.cellWidth+5));f.start=b[0];f.end=b[1];k.each(function(){var e=a(this),c=a("<div>",{"class":"ganttview"});(new v(c,f)).render();e.append(c);c=a("div.ganttview-vtheader",e).outerWidth()+a("div.ganttview-slide-container",e).outerWidth();e.css("width",c+2+"px");(new w(e,f)).apply()})}var k=this,f=a.extend(!0,{showWeekends:!0,cellWidth:21,cellHeight:31,slideWidth:400,vHeaderWidth:100,behavior:{clickable:!0, draggable:!0,resizable:!0}},q);f.data?b():f.dataUrl&&a.getJSON(f.dataUrl,function(a){f.data=a;b()})}function x(a,b){if(a=="setSlideWidth"){var k=$("div.ganttview",this);$("div#ganttChart",this);k.each(function(){var a=$("div.ganttview-vtheader",k).outerWidth();$(k).width(b+1);$("div.ganttview-slide-container",this).width(b-a);u()})}$("#ganttChart").width(b)}a.fn.ganttView=function(){var a=Array.prototype.slice.call(arguments);a.length==1&&typeof a[0]=="object"&&u.call(this,a[0]);a.length==2&&typeof a[0]== "string"&&x.call(this,a[0],a[1])};$(window).resize(function(){$("#ganttChart").ganttView("setSlideWidth",$("div.module-block").width()-$("td.module-sidebar").width()-60)});var v=function(q,b){function k(b,e,c){e={id:e.id,name:e.name};a.extend(e,c);b.data("block-data",e)}var f=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return{render:function(){for(var g=b.data,e=b.cellHeight,c=a("<div>",{"class":"ganttview-vtheader"}),d=0;d<g.length;d++){var i=a("<div>",{"class":"ganttview-vtheader-item"}); i.append(a("<div>",{"class":"ganttview-vtheader-item-name",css:{height:g[d].series.length*e+"px"}}).append(g[d].name));var r=a("<div>",{"class":"ganttview-vtheader-series"}),p=g[d].start,t=g[d].end;typeof p!=="undefined"&&p!==!1&&typeof t!=="undefined"&&t!==!1&&(r.append(a("<div>",{"class":"ganttview-vtheader-series-name"}).append("")),i.append(r));for(p=0;p<g[d].series.length;p++)r.append(a("<div>",{"class":"ganttview-vtheader-series-name"}).append(g[d].series[p].name));i.append(r);c.append(i)}q.append(c); g=a("<div>",{"class":"ganttview-slide-container",css:{width:b.slideWidth+"px"}});d=b.start;e=b.end;c=[];c[d.getFullYear()]=[];for(c[d.getFullYear()][d.getMonth()]=[d];d.compareTo(e)==-1;)d=d.clone().addDays(1),c[d.getFullYear()]||(c[d.getFullYear()]=[]),c[d.getFullYear()][d.getMonth()]||(c[d.getFullYear()][d.getMonth()]=[]),c[d.getFullYear()][d.getMonth()].push(d);var e=dates=c,c=b.cellWidth,d=a("<div>",{"class":"ganttview-hzheader"}),i=a("<div>",{"class":"ganttview-hzheader-months"}),r=a("<div>", {"class":"ganttview-hzheader-days"}),p=0,l;for(l in e)for(var m in e[l]){t=e[l][m].length*c;p+=t;i.append(a("<div>",{"class":"ganttview-hzheader-month",css:{width:t-1+"px"}}).append(f[m]+"/"+l));for(var j in e[l][m])r.append(a("<div>",{"class":"ganttview-hzheader-day"}).append(e[l][m][j].getDate()))}i.css("width",p+"px");r.css("width",p+"px");d.append(i).append(r);g.append(d);l=b.data;e=dates;c=b.cellWidth;d=b.showWeekends;m=a("<div>",{"class":"ganttview-grid"});j=a("<div>",{"class":"ganttview-grid-row"}); for(var h in e)for(var n in e[h])for(var o in e[h][n])i=a("<div>",{"class":"ganttview-grid-row-cell"}),s.isWeekend(e[h][n][o])&&d&&i.addClass("ganttview-weekend"),j.append(i);h=a("div.ganttview-grid-row-cell",j).length*c;j.css("width",h+"px");m.css("width",h+"px");for(h=0;h<l.length;h++){n=l[h].start;o=l[h].end;typeof n!=="undefined"&&n!==!1&&typeof o!=="undefined"&&o!==!1&&m.append(j.clone());for(n=0;n<l[h].series.length;n++)m.append(j.clone())}g.append(m);h=b.data;n=a("<div>",{"class":"ganttview-blocks"}); for(o=0;o<h.length;o++){l=h[o].start;m=h[o].end;typeof l!=="undefined"&&l!==!1&&typeof m!=="undefined"&&m!==!1&&n.append(a("<div>",{"class":"ganttview-block-container"}));for(l=0;l<h[o].series.length;l++)n.append(a("<div>",{"class":"ganttview-block-container"}))}g.append(n);h=b.data;n=b.cellWidth;o=b.start;l=a("div.ganttview-blocks div.ganttview-block-container",g);for(j=m=0;j<h.length;j++){c=h[j].start;e=h[j].end;typeof c!=="undefined"&&c!==!1&&typeof e!=="undefined"&&e!==!1&&(e=s.daysBetween(c, e)+1,i=s.daysBetween(o,c),i=a("<div>",{"class":"ganttview-block",title:h[j].label+", "+e+" days",css:{width:e*n-9+"px","margin-left":i*n+3+"px"}}),k(i,h[j],[""]),h[j].color&&i.css("background-color",h[j].color),i.append(a("<div>",{"class":"ganttview-block-text"}).text(e)),a(l[m]).append(i),m+=1);for(c=0;c<h[j].series.length;c++)d=h[j].series[c],e=s.daysBetween(d.start,d.end)+1,i=s.daysBetween(o,d.start),i=a("<div>",{"class":"ganttview-block",title:d.label+", "+e+" days",css:{width:e*n-9+"px","margin-left":i* n+3+"px"}}),k(i,h[j],d),h[j].series[c].color&&i.css("background-color",h[j].series[c].color),i.append(a("<div>",{"class":"ganttview-block-text"}).text(e)),a(l[m]).append(i),m+=1}q.append(g);g=q.parent();a("div.ganttview-grid-row div.ganttview-grid-row-cell:last-child",g).addClass("last");a("div.ganttview-hzheader-days div.ganttview-hzheader-day:last-child",g).addClass("last");a("div.ganttview-hzheader-months div.ganttview-hzheader-month:last-child",g).addClass("last")}}},w=function(q,b){function k(c, d){a("div.ganttview-block",c).live("click",function(){d&&d(a(this).data("block-data"))})}function f(c,d,b,f){a("div.ganttview-block",c).resizable({grid:d,handles:"e,w",stop:function(){var g=a(this);e(c,g,d,b);f&&f(g.data("block-data"))}})}function g(c,d,b,f){a("div.ganttview-block",c).draggable({axis:"x",grid:[d,d],stop:function(){var g=a(this);e(c,g,d,b);f&&f(g.data("block-data"))}})}function e(c,d,b,e){var c=a("div.ganttview-slide-container",c),f=c.scrollLeft(),c=d.offset().left-c.offset().left- 1+f,f=Math.round(c/b),e=e.clone().addDays(f);d.data("block-data").start=e;f=d.outerWidth();b=Math.round(f/b)-1;d.data("block-data").end=e.clone().addDays(b);a("div.ganttview-block-text",d).text(b+1);d.css("top","").css("left","").css("position","relative").css("margin-left",c+"px")}return{apply:function(){b.behavior.clickable&&k(q,b.behavior.onClick);b.behavior.resizable&&f(q,b.cellWidth,b.start,b.behavior.onResize);b.behavior.draggable&&g(q,b.cellWidth,b.start,b.behavior.onDrag)}}},s={daysBetween:function(a, b){if(!a||!b)return 0;a=Date.parse(a);b=Date.parse(b);if(a.getYear()==1901||b.getYear()==8099)return 0;for(var k=0,f=a.clone();f.compareTo(b)==-1;)k+=1,f.addDays(1);return k},isWeekend:function(a){return a.getDay()%6==0},getBoundaryDatesFromData:function(a,b){var k=new Date;maxEnd=new Date;for(var f=0;f<a.length;f++)for(var g=0;g<a[f].series.length;g++){var e=Date.parse(a[f].series[g].start),c=Date.parse(a[f].series[g].end);f==0&&g==0&&(k=e,maxEnd=c);k.compareTo(e)==1&&(k=e);maxEnd.compareTo(c)== -1&&(maxEnd=c)}s.daysBetween(k,maxEnd)<b&&(maxEnd=k.clone().addDays(b));return[k,maxEnd]}}})(jQuery);

// fileuploader
var qq=qq||{};qq.extend=function(a,b){for(var c in b)a[c]=b[c]};qq.indexOf=function(a,b,c){if(a.indexOf)return a.indexOf(b,c);var c=c||0,d=a.length;for(c<0&&(c+=d);c<d;c++)if(c in a&&a[c]===b)return c;return-1};qq.getUniqueId=function(){var a=0;return function(){return a++}}();qq.attach=function(a,b,c){a.addEventListener?a.addEventListener(b,c,!1):a.attachEvent&&a.attachEvent("on"+b,c)}; qq.detach=function(a,b,c){a.removeEventListener?a.removeEventListener(b,c,!1):a.attachEvent&&a.detachEvent("on"+b,c)};qq.preventDefault=function(a){a.preventDefault?a.preventDefault():a.returnValue=!1};qq.insertBefore=function(a,b){b.parentNode.insertBefore(a,b)};qq.remove=function(a){a.parentNode.removeChild(a)};qq.contains=function(a,b){return a==b?!0:a.contains?a.contains(b):!!(b.compareDocumentPosition(a)&8)}; qq.toElement=function(){var a=document.createElement("div");return function(b){a.innerHTML=b;b=a.firstChild;a.removeChild(b);return b}}();qq.css=function(a,b){if(b.opacity!=null&&typeof a.style.opacity!="string"&&typeof a.filters!="undefined")b.filter="alpha(opacity="+Math.round(100*b.opacity)+")";qq.extend(a.style,b)};qq.hasClass=function(a,b){return RegExp("(^| )"+b+"( |$)").test(a.className)};qq.addClass=function(a,b){qq.hasClass(a,b)||(a.className+=" "+b)}; qq.removeClass=function(a,b){a.className=a.className.replace(RegExp("(^| )"+b+"( |$)")," ").replace(/^\s+|\s+$/g,"")};qq.setText=function(a,b){a.innerText=b;a.textContent=b};qq.children=function(a){for(var b=[],a=a.firstChild;a;)a.nodeType==1&&b.push(a),a=a.nextSibling;return b};qq.getByClass=function(a,b){if(a.querySelectorAll)return a.querySelectorAll("."+b);for(var c=[],d=a.getElementsByTagName("*"),e=d.length,f=0;f<e;f++)qq.hasClass(d[f],b)&&c.push(d[f]);return c}; qq.obj2url=function(a,b,c){var d=[],e="&",f=function(a,c){var e=b?/\[\]$/.test(b)?b:b+"["+c+"]":c;e!="undefined"&&c!="undefined"&&d.push(typeof a==="object"?qq.obj2url(a,e,!0):Object.prototype.toString.call(a)==="[object Function]"?encodeURIComponent(e)+"="+encodeURIComponent(a()):encodeURIComponent(e)+"="+encodeURIComponent(a))};if(!c&&b)e=/\?/.test(b)?/\?$/.test(b)?"":"&":"?",d.push(b),d.push(qq.obj2url(a));else if(Object.prototype.toString.call(a)==="[object Array]"&&typeof a!="undefined")for(var g= 0,c=a.length;g<c;++g)f(a[g],g);else if(typeof a!="undefined"&&a!==null&&typeof a==="object")for(g in a)f(a[g],g);else d.push(encodeURIComponent(b)+"="+encodeURIComponent(a));return d.join(e).replace(/^&/,"").replace(/%20/g,"+")};qq=qq||{}; qq.FileUploaderBasic=function(a){this._options={debug:!1,action:"/server/upload",params:{},button:null,multiple:!0,maxConnections:3,allowedExtensions:[],sizeLimit:0,minSizeLimit:0,onSubmit:function(){},onProgress:function(){},onComplete:function(){},onAllComplete:function(){},onCancel:function(){},messages:{typeError:"{file} has invalid extension. Only {extensions} are allowed.",sizeError:"{file} is too large, maximum file size is {sizeLimit}.",minSizeError:"{file} is too small, minimum file size is {minSizeLimit}.", emptyError:"{file} is empty, please select files again without it.",onLeave:"The files are being uploaded, if you leave now the upload will be cancelled."},showMessage:function(a){alert(a)}};qq.extend(this._options,a);this._filesInProgress=0;this._handler=this._createUploadHandler();if(this._options.button)this._button=this._createUploadButton(this._options.button);this._preventLeaveInProgress()}; qq.FileUploaderBasic.prototype={setParams:function(a){this._options.params=a},getInProgress:function(){return this._filesInProgress},_createUploadButton:function(a){var b=this;return new qq.UploadButton({element:a,multiple:this._options.multiple&&qq.UploadHandlerXhr.isSupported(),onChange:function(a){b._onInputChange(a)}})},_createUploadHandler:function(){var a=this,b;b=qq.UploadHandlerXhr.isSupported()?"UploadHandlerXhr":"UploadHandlerForm";return new qq[b]({debug:this._options.debug,action:this._options.action, maxConnections:this._options.maxConnections,onProgress:function(b,d,e,f){a._onProgress(b,d,e,f);a._options.onProgress(b,d,e,f)},onComplete:function(b,d,e){a._onComplete(b,d,e);a._options.onComplete(b,d,e)},onAllComplete:function(b){a._options.onAllComplete(b)},onCancel:function(b,d){a._onCancel(b,d);a._options.onCancel(b,d)}})},_preventLeaveInProgress:function(){},_onSubmit:function(){this._filesInProgress++},_onProgress:function(){},_onComplete:function(a,b,c){this._filesInProgress--;c.error&&this._options.showMessage(c.error)}, _onCancel:function(){this._filesInProgress--},_onInputChange:function(a){this._handler instanceof qq.UploadHandlerXhr?this._uploadFileList(a.files):this._validateFile(a)&&this._uploadFile(a);this._button.reset()},_uploadFileList:function(a){for(var b=0;b<a.length;b++)if(!this._validateFile(a[b]))return;for(b=0;b<a.length;b++)this._uploadFile(a[b])},_uploadFile:function(a){var a=this._handler.add(a),b=this._handler.getName(a);this._options.onSubmit(a,b)!==!1&&(this._onSubmit(a,b),this._handler.upload(a, this._options.params))},_validateFile:function(a){var b,c;a.value?b=a.value.replace(/.*(\/|\\)/,""):(b=a.fileName!=null?a.fileName:a.name,c=a.fileSize!=null?a.fileSize:a.size);if(this._isAllowedExtension(b))if(c===0)return this._error("emptyError",b),!1;else if(c&&this._options.sizeLimit&&c>this._options.sizeLimit)return this._error("sizeError",b),!1;else{if(c&&c<this._options.minSizeLimit)return this._error("minSizeError",b),!1}else return this._error("typeError",b),!1;return!0},_error:function(a, b){function c(a,b){d=d.replace(a,b)}var d=this._options.messages[a];c("{file}",this._formatFileName(b));c("{extensions}",this._options.allowedExtensions.join(", "));c("{sizeLimit}",this._formatSize(this._options.sizeLimit));c("{minSizeLimit}",this._formatSize(this._options.minSizeLimit));this._options.showMessage(d)},_formatFileName:function(a){a.length>33&&(a=a.slice(0,19)+"..."+a.slice(-13));return a},_isAllowedExtension:function(a){var a=-1!==a.indexOf(".")?a.replace(/.*[.]/,"").toLowerCase(): "",b=this._options.allowedExtensions;if(!b.length)return!0;for(var c=0;c<b.length;c++)if(b[c].toLowerCase()==a)return!0;return!1},_formatSize:function(a){var b=-1;do a/=1024,b++;while(a>99);return Math.max(a,0.1).toFixed(1)+"kB,MB,GB,TB,PB,EB".split(",")[b]}}; qq.FileUploader=function(a){qq.FileUploaderBasic.apply(this,arguments);qq.extend(this._options,{element:null,listElement:null,template:'<span class="qq-uploader"><span class="qq-upload-button">'+a.text.attach+'</span><ul class="qq-upload-list"></ul></span>',fileTemplate:'<li><span class="qq-upload-file"></span><span class="qq-upload-spinner"></span><span class="qq-upload-size"></span><a class="qq-upload-cancel" href="#">'+a.text.cancel+'</a><span class="qq-upload-failed-text">'+a.text.failed+"</span></li>", classes:{button:"qq-upload-button",list:"qq-upload-list",file:"qq-upload-file",spinner:"qq-upload-spinner",size:"qq-upload-size",cancel:"qq-upload-cancel",success:"qq-upload-success",fail:"qq-upload-fail"}});qq.extend(this._options,a);this._element=this._options.element;this._element.innerHTML=this._options.template;this._listElement=this._options.listElement||this._find(this._element,"list");this._classes=this._options.classes;this._button=this._createUploadButton(this._find(this._element,"button")); this._bindCancelEvent();this._setupDragDrop()};qq.extend(qq.FileUploader.prototype,qq.FileUploaderBasic.prototype); qq.extend(qq.FileUploader.prototype,{_find:function(a,b){var c=qq.getByClass(a,this._options.classes[b])[0];if(!c)throw Error("element not found "+b);return c},_setupDragDrop:function(){},_onSubmit:function(a,b){qq.FileUploaderBasic.prototype._onSubmit.apply(this,arguments);this._addToList(a,b)},_onProgress:function(a,b,c,d){qq.FileUploaderBasic.prototype._onProgress.apply(this,arguments);var e=this._find(this._getItemByFileId(a),"size");e.style.display="inline";var f;f=c!=d?Math.round(c/d*100)+"% from "+ this._formatSize(d):this._formatSize(d);qq.setText(e,f)},_onComplete:function(a,b,c){qq.FileUploaderBasic.prototype._onComplete.apply(this,arguments);var d=this._getItemByFileId(a);qq.remove(this._find(d,"cancel"));qq.remove(this._find(d,"spinner"));c.success?$(d).slideUp(300):qq.innerHTML=""},_addToList:function(a,b){var c=qq.toElement(this._options.fileTemplate);c.qqFileId=a;var d=this._find(c,"file");qq.setText(d,this._formatFileName(b));qq.setText(d,this._formatFileName(b));this._find(c,"size").style.display= "none";this._listElement.appendChild(c)},_getItemByFileId:function(a){for(var b=this._listElement.firstChild;b;){if(b.qqFileId==a)return b;b=b.nextSibling}},_bindCancelEvent:function(){var a=this;qq.attach(this._listElement,"click",function(b){var b=b||window.event,c=b.target||b.srcElement;if(qq.hasClass(c,a._classes.cancel))qq.preventDefault(b),b=c.parentNode,a._handler.cancel(b.qqFileId),qq.remove(b)})}});qq.UploadDropZone=function(){}; qq.UploadButton=function(a){this._options={element:null,multiple:!1,name:"file",onChange:function(){},hoverClass:"qq-upload-button-hover",focusClass:"qq-upload-button-focus"};qq.extend(this._options,a);this._element=this._options.element;qq.css(this._element,{position:"relative",overflow:"hidden",direction:"ltr"});this._input=this._createInput()}; qq.UploadButton.prototype={getInput:function(){return this._input},reset:function(){this._input.parentNode&&qq.remove(this._input);qq.removeClass(this._element,this._options.focusClass);this._input=this._createInput()},_createInput:function(){var a=document.createElement("input");this._options.multiple&&a.setAttribute("multiple","multiple");a.setAttribute("type","file");a.setAttribute("name",this._options.name);qq.css(a,{position:"absolute",right:0,top:"6px",fontFamily:"Arial",fontSize:"2px",margin:0, padding:0,cursor:"pointer",opacity:0});this._element.appendChild(a);var b=this;qq.attach(a,"change",function(){b._options.onChange(a)});qq.attach(a,"mouseover",function(){qq.addClass(b._element,b._options.hoverClass)});qq.attach(a,"mouseout",function(){qq.removeClass(b._element,b._options.hoverClass)});qq.attach(a,"focus",function(){qq.addClass(b._element,b._options.focusClass)});qq.attach(a,"blur",function(){qq.removeClass(b._element,b._options.focusClass)});window.attachEvent&&a.setAttribute("tabIndex", "-1");return a}};qq.UploadHandlerAbstract=function(a){this._options={debug:!1,action:"/upload.php",maxConnections:999,onProgress:function(){},onComplete:function(){},onAllComplete:function(){},onCancel:function(){}};qq.extend(this._options,a);this._queue=[];this._params=[];this._completed_files=[]}; qq.UploadHandlerAbstract.prototype={log:function(a){this._options.debug&&window.console&&console.log("[uploader] "+a)},add:function(){},upload:function(a,b){var c=this._queue.push(a),d={};qq.extend(d,b);this._params[a]=d;c<=this._options.maxConnections&&this._upload(a,this._params[a])},cancel:function(a){this._cancel(a);this._dequeue(a)},cancelAll:function(){for(var a=0;a<this._queue.length;a++)this._cancel(this._queue[a]);this._queue=[]},getName:function(){},getSize:function(){},getQueue:function(){return this._queue}, _upload:function(){},_cancel:function(){},_dequeue:function(a){this._queue.splice(qq.indexOf(this._queue,a),1);a=this._options.maxConnections;this._queue.length>=a&&(a=this._queue[a-1],this._upload(a,this._params[a]));this._queue.length==0&&this._onAllComplete()},_onAllComplete:function(){this._options.onAllComplete(this._completed_files)}};qq.UploadHandlerForm=function(a){qq.UploadHandlerAbstract.apply(this,arguments);this._inputs={}};qq.extend(qq.UploadHandlerForm.prototype,qq.UploadHandlerAbstract.prototype); qq.extend(qq.UploadHandlerForm.prototype,{add:function(a){a.setAttribute("name","qqfile");var b="qq-upload-handler-iframe"+qq.getUniqueId();this._inputs[b]=a;a.parentNode&&qq.remove(a);return b},getName:function(a){return this._inputs[a].value.replace(/.*(\/|\\)/,"")},_cancel:function(a){this._options.onCancel(a,this.getName(a));delete this._inputs[a];if(a=document.getElementById(a))a.setAttribute("src","javascript:false;"),qq.remove(a)},_upload:function(a,b){var c=this._inputs[a];if(!c)throw Error("file with passed id was not added, or already uploaded or cancelled"); var d=this.getName(a),e=this._createIframe(a),f=this._createForm(e,b);f.appendChild(c);var g=this;this._attachLoadEvent(e,function(){g.log("iframe loaded");var b=g._getIframeContentJSON(e);g._options.onComplete(a,d,b);g._dequeue(a);delete g._inputs[a];setTimeout(function(){qq.remove(e)},1)});f.submit();qq.remove(f);return a},_attachLoadEvent:function(a,b){qq.attach(a,"load",function(){a.parentNode&&(!a.contentDocument||!(a.contentDocument.body&&a.contentDocument.body.innerHTML=="false"))&&b()})}, _getIframeContentJSON:function(a){var a=a.contentDocument?a.contentDocument:a.contentWindow.document,b;this.log("converting iframe's innerHTML to JSON");this.log("innerHTML = "+a.body.innerHTML);var c=document.createElement("div");c.innerHTML=a.body.innerHTML;a=c.textContent;try{b=eval("("+a+")")}catch(d){b=$.parseJSON(a)}return b},_createIframe:function(a){var b=qq.toElement('<iframe src="javascript:false;" name="'+a+'" />');b.setAttribute("id",a);b.style.display="none";document.body.appendChild(b); return b},_createForm:function(a,b){var c=null,c=b.csrf_token&&b.csrf_name?qq.toElement('<form method="post" enctype="multipart/form-data">'+('<input type="hidden" name="'+b.csrf_name+'" value="'+b.csrf_token+'" />')+"</form>"):qq.toElement('<form method="post" enctype="multipart/form-data"></form>');delete b.csrf_token;delete b.csrf_name;delete b.csrf_xname;var d=qq.obj2url(b,this._options.action);c.setAttribute("action",d);c.setAttribute("target",a.name);c.style.display="none";document.body.appendChild(c); return c}});qq.UploadHandlerXhr=function(a){qq.UploadHandlerAbstract.apply(this,arguments);this._files=[];this._xhrs=[];this._loaded=[]};qq.UploadHandlerXhr.isSupported=function(){var a=document.createElement("input");a.type="file";return"multiple"in a&&typeof File!="undefined"&&typeof(new XMLHttpRequest).upload!="undefined"};qq.extend(qq.UploadHandlerXhr.prototype,qq.UploadHandlerAbstract.prototype); qq.extend(qq.UploadHandlerXhr.prototype,{add:function(a){if(!(a instanceof File))throw Error("Passed obj is not a File (in qq.UploadHandlerXhr)");return this._files.push(a)-1},getName:function(a){a=this._files[a];return a.fileName!=null?a.fileName:a.name},getSize:function(a){a=this._files[a];return a.fileSize!=null?a.fileSize:a.size},getLoaded:function(a){return this._loaded[a]||0},_upload:function(a,b){var c=this._files[a],d=this.getName(a);this.getSize(a);this._loaded[a]=0;var e=this._xhrs[a]=new XMLHttpRequest, f=this;e.upload.onprogress=function(b){if(b.lengthComputable)f._loaded[a]=b.loaded,f._options.onProgress(a,d,b.loaded,b.total)};e.onreadystatechange=function(){e.readyState==4&&f._onComplete(a,e)};var b=b||{},g=!1,h=!1;if(b.csrf_token&&b.csrf_xname)g=b.csrf_token,h=b.csrf_xname,delete b.csrf_token,delete b.csrf_xname,delete b.csrf_name;b.qqfile=d;var i=qq.obj2url(b,this._options.action);e.open("POST",i,!0);e.setRequestHeader("X-Requested-With","XMLHttpRequest");e.setRequestHeader("X-File-Name",encodeURIComponent(d)); e.setRequestHeader("Content-Type","application/octet-stream");g&&e.setRequestHeader(h,g);e.send(c)},_onComplete:function(a,b){if(this._files[a]){var c=this.getName(a),d=this.getSize(a);this._options.onProgress(a,c,d,d);if(b.status==200||b.status==201){this.log("xhr - server response received");this.log("responseText = "+b.responseText);var e;try{e=eval("("+b.responseText+")")}catch(f){e={}}this._completed_files.push({file:this._files[a],response:e});this._options.onComplete(a,c,e)}else this._completed_files.push({file:this._files[a], response:{}}),this._options.onComplete(a,c,{});this._files[a]=null;this._xhrs[a]=null;this._dequeue(a)}},_cancel:function(a){this._options.onCancel(a,this.getName(a));this._files[a]=null;this._xhrs[a]&&(this._xhrs[a].abort(),this._xhrs[a]=null)}});

// tooltips
(function(a){a.fn.tipsy=function(e){e=a.extend({},a.fn.tipsy.defaults,e);return this.each(function(){var d=a.fn.tipsy.elementOptions(this,e);a(this).hover(function(){a.data(this,"cancel.tipsy",!0);var c=a.data(this,"active.tipsy");c||(c=a('<div class="tipsy"><div class="tipsy-inner"/></div>'),c.css({position:"absolute",zIndex:1E5}),a.data(this,"active.tipsy",c));if(a(this).attr("title")||typeof a(this).attr("original-title")!="string")a(this).attr("original-title",a(this).attr("title")||"").removeAttr("title"); var b;typeof d.title=="string"?b=a(this).attr(d.title=="title"?"original-title":d.title):typeof d.title=="function"&&(b=d.title.call(this));c.find(".tipsy-inner")[d.html?"html":"text"](b||d.fallback);b=a.extend({},a(this).offset(),{width:this.offsetWidth,height:this.offsetHeight});c.get(0).className="tipsy";c.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);var e=c[0].offsetWidth,f=c[0].offsetHeight;switch((typeof d.gravity=="function"?d.gravity.call(this): d.gravity).charAt(0)){case "n":c.css({top:b.top+b.height,left:b.left+b.width/2-e/2}).addClass("tipsy-north");break;case "s":c.css({top:b.top-f,left:b.left+b.width/2-e/2}).addClass("tipsy-south");break;case "e":c.css({top:b.top+b.height/2-f/2,left:b.left-e}).addClass("tipsy-east");break;case "w":c.css({top:b.top+b.height/2-f/2,left:b.left+b.width}).addClass("tipsy-west")}d.fade?c.css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:0.8}):c.css({visibility:"visible"})},function(){a.data(this, "cancel.tipsy",!1);var c=this;setTimeout(function(){if(!a.data(this,"cancel.tipsy")){var b=a.data(c,"active.tipsy");d.fade?b.stop().fadeOut(function(){a(this).remove()}):b.remove()}},100)})})};a.fn.tipsy.elementOptions=function(e,d){return a.metadata?a.extend({},d,a(e).metadata()):d};a.fn.tipsy.defaults={fade:!1,fallback:"",gravity:"n",html:!1,title:"title"};a.fn.tipsy.autoNS=function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"};a.fn.tipsy.autoWE=function(){return a(this).offset().left> a(document).scrollLeft()+a(window).width()/2?"e":"w"}})(jQuery);
